<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>MnemonicShards - Mnemonic Phrase Splitting Tool</title>
    <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();const P0="modulepreload",K0=function(n,e){return new URL(n,e).href},Na={},T0=function(e,r,t){let i=Promise.resolve();if(r&&r.length>0){let u=function(h){return Promise.all(h.map(l=>Promise.resolve(l).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const a=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");i=u(r.map(h=>{if(h=K0(h,t),h in Na)return;Na[h]=!0;const l=h.endsWith(".css"),f=l?'[rel="stylesheet"]':"";if(t)for(let y=a.length-1;y>=0;y--){const w=a[y];if(w.href===h&&(!l||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${f}`))return;const p=document.createElement("link");if(p.rel=l?"stylesheet":P0,l||(p.as="script"),p.crossOrigin="",p.href=h,c&&p.setAttribute("nonce",c),document.head.appendChild(p),l)return new Promise((y,w)=>{p.addEventListener("load",y),p.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};function F(n){try{return document.querySelector(n)}catch{return null}}function ie(n,e=[],r={}){const t=document.createElement(n);return e.length>0&&(t.className=e.join(" ")),Object.entries(r).forEach(([i,s])=>{t.setAttribute(i,s)}),t}function Ye(n,e){const r=typeof n=="string"?F(n):n;r&&(r.style.display=e?"":"none")}function me(n,e,r){const t=typeof n=="string"?F(n):n;t&&t.classList.toggle(e,r)}function Kn(n,e){const r=typeof n=="string"?F(n):n;r&&(r.innerHTML=e)}function Dn(n){Kn(n,"")}function te(n,e,r,t={}){const i=typeof n=="string"?F(n):n;i&&i.addEventListener(e,r,t)}function Oa(n,e){return!e||typeof e!="string"||e.trim().length===0?!1:n.includes(e.trim().toLowerCase())}function R0(n){if(!n||typeof n!="string")return!1;try{const e=JSON.parse(atob(n.trim()));return!!(e.threshold&&e.index&&e.data)}catch{return!1}}function N0(n){if(!R0(n))return null;try{const e=atob(n.trim());return JSON.parse(e)}catch{return null}}function O0(n){const e=[],r=new Set,t=new Set;if(n.some(i=>!i||i.trim().length===0)&&e.push("存在空单词，请填写所有助记词"),n.forEach(i=>{const s=i.trim().toLowerCase();r.has(s)?t.add(s):r.add(s)}),t.size>0){const i=Array.from(t).join(", ");e.push(`检测到重复单词：${i}`)}return{isValid:e.length===0,errors:e,duplicates:Array.from(t)}}function Os(n){const e=[];let r=0,t=0;const i=new Set,s=new Set,a=[];if(n.forEach((c,u)=>{let h=null;typeof c=="object"&&c!==null?h=c:h=N0(c),h&&h.threshold&&h.index!==void 0&&h.data?(r++,a.push(h),h.threshold&&s.add(h.threshold),i.add(h.index)):e.push(`第 ${u+1} 行：无效的分片格式`)}),a.length>0&&a[0].threshold)t=a[0].threshold;else if(s.size>0){const c={};s.forEach(h=>{c[h]=(c[h]||0)+1});let u=0;s.forEach(h=>{c[h]>u&&(u=c[h],t=h)})}else t=3;return r===0?e.push("未检测到有效分片"):r<t&&e.push(`需要至少 ${t} 个分片，当前只有 ${r} 个`),i.size!==r&&e.push("检测到重复的分片索引"),{isValid:e.length===0&&r>=t,validCount:r,threshold:t,errors:e,shareIndices:Array.from(i)}}function L0(n,e){let r;return function(...t){clearTimeout(r),r=setTimeout(()=>n.apply(this,t),e)}}function Q0(n=new Date){return n.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}function La(){return window.innerWidth<=768}async function F0(n){try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(n),!0;{const e=document.createElement("textarea");e.value=n,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select();const r=document.execCommand("copy");return document.body.removeChild(e),r}}catch{return!1}}function Qa(n,e,r="text/plain"){try{const t=new Blob([n],{type:`${r};charset=utf-8`}),i=URL.createObjectURL(t),s=document.createElement("a");return s.href=i,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i),!0}catch{return!1}}const rs=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","badly","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blink","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","both","bottle","bottom","boundary","box","bracket","brain","brand","brave","bread","break","breast","breed","brick","bride","brief","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","charity","charm","chart","chase","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chunk","churn","cigar","cinnamon","circle","citizen","city","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","cloudy","clown","club","clump","cluster","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","doubt","down","dozen","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","explode","export","expose","express","extend","exterior","extra","exotic","exult","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fridge","fringe","frog","front","frost","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","graph","grass","gratitude","grave","gray","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","lease","least","leather","leave","lecture","left","leg","legal","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","side","siege","sight","silence","silk","silly","silver","similar","simple","since","sing","siren","sister","site","situate","six","size","skate","sketch","ski","skill","skin","skip","skull","slab","slam","sleep","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","solar","soldier","solid","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spark","spatial","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unusual","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacate","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violet","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","want","warehouse","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"],ns={NAME:"MnemonicShards",DESCRIPTION:"安全地将助记词分割成多个分片，任意指定数量的分片即可恢复原始助记词",VERSION:"1.0.0"},is={WORD_COUNTS:[12,24],DEFAULT_WORD_COUNT:12},Nr={DELAY:{DEBOUNCE:100,AUTO_HIDE_ALERT:3e3,BLUR_DELAY:200},SUGGESTIONS:{MAX_SUGGESTIONS:5,MOBILE_MAX_HEIGHT:"150px",MOBILE_BOTTOM_OFFSET:"20px"}},j={CONTAINER:".container",MAIN_CONTENT:".main-content",WORDS_GRID:"#wordsGrid",TOTAL_SHARES:"#totalShares",THRESHOLD:"#threshold",GENERATE_BTN:"#generateBtn",RECOVER_BTN:"#recoverBtn",RECOVER_INPUT:"#recoverInput",SHARES_RESULT:"#sharesResult",SHARES_LIST:"#sharesList",RECOVER_RESULT:"#recoverResult",PASTE_RECOVER_RESULT:"#pasteRecoverResult",UPLOAD_RECOVER_RESULT:"#uploadRecoverResult",INPUT_ERROR_ALERT:"#inputErrorAlert",DUPLICATE_ALERT:"#duplicateAlert",GENERAL_ERROR_ALERT:"#generalErrorAlert",SUCCESS_ALERT:"#successAlert",INPUT_STATUS:"#inputStatus",THRESHOLD_DISPLAY:"#thresholdDisplay",ENCRYPTION_SECTION:"#encryptionSection",ENABLE_ENCRYPTION:"#enableEncryption",ENCRYPTION_FIELDS:"#encryptionFields",ENCRYPTION_PASSWORD:"#encryptionPassword",CONFIRM_PASSWORD:"#confirmPassword",PASSWORD_STRENGTH:"#passwordStrength",PASSWORD_MATCH:"#passwordMatch",RECOVERY_PASSWORD_SECTION:"#recoveryPasswordSection",RECOVERY_PASSWORD:"#recoveryPassword",WORD_INPUT:n=>`#word${n}`,SUGGESTIONS:n=>`#suggestions${n}`},We={ACTIVE:"active",VALID_WORD:"valid-word",INVALID_WORD:"invalid-word",DUPLICATE_WORD:"duplicate-word",COPIED:"copied"},ss={EMPTY_WORDS:"请填写所有助记词！",INVALID_WORD:n=>`第 ${n} 个单词不是有效的 BIP39 单词，请从建议列表中选择有效的单词。`,DUPLICATE_WORDS:n=>`检测到重复单词：${n}。助记词中的单词应该是唯一的，请修改重复的单词。`,INVALID_SHARE_FORMAT:"未检测到有效分片，请检查格式",INSUFFICIENT_SHARES:(n,e)=>`需要至少 ${e} 个分片，当前只有 ${n} 个`,NO_VALID_SHARES:"没有找到有效的分片数据",COPY_FAILED:"复制失败，请手动复制",DOWNLOAD_FAILED:"下载失败，请重试",GENERATE_FAILED:n=>`生成分片失败: ${n}`,RECOVER_FAILED:n=>`恢复失败：${n}`},M0={SHARES_GENERATED:"分片生成成功！请安全保存这些分片。",SHARE_DOWNLOADED:n=>`分片 ${n} 已下载`,SHARE_COPIED:"已复制到剪贴板"},G0={SHARE_CONTENT:(n,e)=>({index:n,content:e,timestamp:new Date().toLocaleString()})},je={EN:"en",ZH:"zh"},H0={[je.EN]:"English",[je.ZH]:"中文"},Fa={[je.EN]:{appTitle:"MnemonicShards",appDescription:"Securely split your mnemonic phrase into multiple shards. Any specified number of shards can recover the original mnemonic.",configTitle:"Configuration Options",wordCountLabel:"Mnemonic Word Count",words12:"12 words",words24:"24 words",totalSharesLabel:"Total Shares",thresholdLabel:"Shares Required for Recovery",sharesOption:n=>`${n} shares`,inputTitle:"Enter Mnemonic Phrase",generateBtn:"Generate Shares",recoverTitle:"Recover Mnemonic Phrase",recoverInstructions:`
      <strong>Instructions:</strong><br />
      1. Paste each shard into the text box below, one shard per line<br />
      2. Shard format should be complete Base64 encoded string<br />
      3. Minimum number of shards must be reached for recovery<br />
      4. Extra shards will be automatically ignored
    `,recoverBtn:"Recover Mnemonic",recoverPlaceholder:`Paste shard contents here, one shard per line...

💡 Tip: Paste multiple shards at once, system will handle line breaks automatically

Example format:
eyJ0aHJlc2hvbGQiOjMsInNoYXJlSW5kZXgiOjEsImRhdGEiOiJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiJ9
eyJ0aHJlc2hvbGQiOjMsInNoYXJlSW5kZXgiOjIsImRhdGEiOiJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiJ9
eyJ0aHJlc2hvbGQiOjMsInNoYXJlSW5kZXgiOjMsImRhdGEiOiJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiJ9`,waitingForInput:"Waiting for shard input...",pasteInputTab:"Paste Input",fileUploadTab:"File Upload",uploadInstructions:`
      <strong>Instructions:</strong><br />
      1. Drag and drop shard files here or click to select files<br />
      2. Supported formats: .txt (standard shares) and .gpg (encrypted shares)<br />
      3. You can select multiple files at once<br />
      4. Files will be processed immediately after upload
    `,dragDropHint:"Drag and drop files here or click to select",selectFiles:"Select Files",supportedFormats:"Supported formats: .txt, .gpg",uploadedFiles:"Uploaded Files",clearAllFiles:"Clear All",waitingForUpload:"Waiting for file upload...",encryptionConfirmation:"Enable Decryption?",uploadConfirmationMessage:"Do you want to enable decryption for uploaded files? If you have encrypted files (.gpg), you need to enable decryption to process them.",confirmEncryption:"Yes, enable decryption",skipEncryption:"No, skip decryption",encryptionRequired:"Decryption is required for encrypted files",insufficientSharesAfterDecryption:(n,e)=>`Insufficient shares after decryption. Need at least ${n} shares, but got ${e}.`,sharesDecrypted:(n,e)=>`Successfully decrypted ${n} shares (need ${e})`,encryptionPasswordTitle:"Decryption Password",encryptionPasswordDesc:"Enter password to decrypt your encrypted files (.gpg). All encrypted files will use the same password.",applyDecryption:"Apply Decryption",skipDecryption:"Skip Decryption",sharesTitle:"Generated Shares",securityTip:'<strong>Security Tip:</strong> Store these shards in different secure locations. Any <span id="thresholdDisplay"></span> shares can recover the complete mnemonic.',securityNotice:"<strong>Security Mode:</strong> Using professional-grade Shamir Secret Sharing algorithm, runs completely offline, data never leaves your device. Recommended to use in disconnected environment for maximum security.",errors:{fillAllWords:"Please fill in all mnemonic words!",invalidWord:n=>`Word ${n} is not a valid BIP39 word, please select a valid word from the suggestions.`,invalidWordCleared:n=>`<strong>Invalid mnemonic:</strong> Word ${n} is not a valid BIP39 word and has been automatically cleared. Please select a valid word from the suggestions.`,duplicateWords:n=>`Duplicate words found: ${n.join(", ")}. Each word should be unique.`,invalidShareFormat:"Invalid share format. Please check your input.",insufficientShares:(n,e)=>`Insufficient shares. Need at least ${n} shares, but got ${e}.`,duplicateShares:"Duplicate shares detected. Each share should be unique.",recoveryFailed:"Recovery failed: ",noValidShares:"No valid shard data found",checkShareFormat:"Please check if the shard format is correct, ensure each line contains a complete shard",copyFailed:"Failed to copy to clipboard",downloadFailed:"Download failed, please try again",encryptionFieldsMissing:"Encryption fields are missing",fileTypeNotSupported:"File type not supported: {0}",fileTooLarge:"File too large: {0}",duplicateFile:"Duplicate file: {0}"},success:{sharesGenerated:"Shares generated successfully! Please save these shards securely.",mnemonicRecovered:"Mnemonic recovered successfully!",copySuccess:"Copied to clipboard!",shareDownloaded:n=>`Share ${n} downloaded`,encryptedShareDownloaded:n=>`Encrypted share ${n} downloaded`,recoverySuccess:"Recovery successful!"},warnings:{duplicateWordsDetected:"Duplicate words detected:",uniqueWordsNote:"Words in the mnemonic should be unique, please check and modify duplicate words.",duplicateWords:n=>`Duplicate words detected: ${n.join(", ")}`},info:{recovering:"Recovering...",validShares:(n,e)=>`Detected ${n} valid shares (need ${e}), recovery can start`},fileStatus:{processing:"Processing...",valid:"Valid share",invalid:"Invalid format",encrypted:"Encrypted - awaiting decryption",unknown:"Unknown status"},copy:"Copy",download:"Download",share:n=>`Share ${n}`,wordLabel:n=>`${n}. Word`,wordPlaceholder:n=>`Word ${n}`,position:"Position",shareFilePrefix:"Share",mnemonic:"Mnemonic",shares:"shares",sharesUsed:"Shares used",need:"need",recoveryTime:"Recovery time",fileTemplate:{appName:"MnemonicShards",shareContent:"Share content",generatedTime:"Generated time",securityTips:"Security tips",tip1:"Please keep this file in a secure location",tip2:"Do not share the shard with untrusted people",tip3:"Any specified number of shards can recover the original mnemonic"},encryption:{title:"Encryption Options",enableEncryption:"Enable Encryption",encryptionDescription:"Add an extra layer of security by encrypting each shard with a password",passwordLabel:"Password",confirmPasswordLabel:"Confirm Password",passwordPlaceholder:"Enter encryption password",confirmPasswordPlaceholder:"Confirm encryption password",passwordTip:"Make sure to remember your password, as it will be required to recover the mnemonic",weakPassword:"Password is too weak, please use at least 8 characters with a mix of letters, numbers, and symbols",passwordMismatch:"Passwords do not match",encryptingShares:"Encrypting shares...",encryptingShare:n=>`Encrypting share ${n}...`,encryptedSharesTitle:"Generated Encrypted Shares",encryptionSuccess:"Shares encrypted successfully!",encryptionFailed:"Encryption failed: ",decryptionFailed:"Decryption failed: ",invalidPassword:"Invalid password, please check and try again",encryptionInfo:"Each shard will be encrypted with OpenPGP format, compatible with GPG tools. The same password will be required during recovery.",securityNotice:"Encrypted shards provide additional security if stored in potentially compromised locations.",passwordRequired:"Password is required for decryption",decryptingShares:"Decrypting shares...",encryptedShareNotice:"ENCRYPTED SHARE - This shard is encrypted with OpenPGP format and requires a password for recovery",encryptedShareTip:"This shard is encrypted with OpenPGP format (compatible with GPG). You will need the same password used during generation to recover the mnemonic.",gpgCompatibility:"This encrypted shard can be decrypted using GPG command: gpg --decrypt shard1.gpg",encryptedFileDetected:"Encrypted files detected. Password is required for decryption.",noEncryptedFiles:"No encrypted files to decrypt"},passwordDialog:{title:"Enter Decryption Password",retryTitle:"Incorrect Password",message:"Please enter the password to decrypt the shares.",retryMessage:"The password you entered is incorrect. Please try again.",confirm:"Confirm",cancel:"Cancel"},language:"Language"},[je.ZH]:{appTitle:"MnemonicShards",appDescription:"安全地将助记词分割成多个分片，任意指定数量的分片即可恢复原始助记词",configTitle:"配置选项",wordCountLabel:"助记词数量",words12:"12 个单词",words24:"24 个单词",totalSharesLabel:"分片总数",thresholdLabel:"恢复所需分片数",sharesOption:n=>`${n} 个分片`,inputTitle:"输入助记词",generateBtn:"生成分片",recoverTitle:"恢复助记词",recoverInstructions:`
      <strong>使用说明：</strong><br />
      1. 将每个分片粘贴到下方文本框中，每行一个分片<br />
      2. 分片格式应为完整的 Base64 编码字符串<br />
      3. 至少需要达到设定的最小分片数量才能恢复<br />
      4. 多余的分片会被自动忽略
    `,recoverBtn:"恢复助记词",recoverPlaceholder:`请在此处粘贴分片内容，每行一个分片...

💡 提示：直接粘贴多个分片，系统会自动处理换行

示例格式：
eyJ0aHJlc2hvbGQiOjMsInNoYXJlSW5kZXgiOjEsImRhdGEiOiJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiJ9
eyJ0aHJlc2hvbGQiOjMsInNoYXJlSW5kZXgiOjIsImRhdGEiOiJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiJ9
eyJ0aHJlc2hvbGQiOjMsInNoYXJlSW5kZXgiOjMsImRhdGEiOiJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiJ9`,waitingForInput:"等待输入分片...",pasteInputTab:"粘贴输入",fileUploadTab:"文件上传",uploadInstructions:`
      <strong>使用说明：</strong><br />
      1. 拖拽分片文件到此处或点击选择文件<br />
      2. 支持格式：.txt（标准分片）和 .gpg（加密分片）<br />
      3. 可以一次选择多个文件<br />
      4. 文件上传后会立即处理
    `,dragDropHint:"拖拽文件到此处或点击选择",selectFiles:"选择文件",supportedFormats:"支持格式：.txt, .gpg",uploadedFiles:"已上传文件",clearAllFiles:"清空全部",waitingForUpload:"等待文件上传...",encryptionConfirmation:"启用解密？",uploadConfirmationMessage:"是否为上传的文件启用解密？如果您有加密文件(.gpg)，需要启用解密才能处理它们。",confirmEncryption:"是，启用解密",skipEncryption:"否，跳过解密",encryptionRequired:"加密文件需要解密",insufficientSharesAfterDecryption:(n,e)=>`解密后分片数量不足。至少需要 ${n} 个分片，但只有 ${e} 个。`,sharesDecrypted:(n,e)=>`成功解密 ${n} 个分片（需要 ${e} 个）`,encryptionPasswordTitle:"解密密码",encryptionPasswordDesc:"请输入密码以解密您的加密文件(.gpg)。所有加密文件将使用相同的密码。",applyDecryption:"应用解密",skipDecryption:"跳过解密",sharesTitle:"生成的分片",securityTip:'<strong>安全提示：</strong> 请将这些分片分别保存在不同的安全位置。任意 <span id="thresholdDisplay"></span> 个分片即可恢复完整的助记词。',securityNotice:"<strong>安全模式：</strong> 使用专业级 Shamir 秘密分享算法，完全离线运行，数据不会离开您的设备。建议在断网环境中使用以获得最高安全性。",errors:{fillAllWords:"请填写所有助记词！",invalidWord:n=>`第 ${n} 个单词不是有效的 BIP39 单词，请从建议列表中选择有效的单词。`,invalidWordCleared:n=>`<strong>无效助记词：</strong> 第 ${n} 个输入框中的单词不是有效的 BIP39 单词，已自动清空。请从建议列表中选择有效的单词。`,duplicateWords:n=>`发现重复单词：${n.join(", ")}。每个单词应该是唯一的。`,invalidShareFormat:"无效的分片格式。请检查您的输入。",insufficientShares:(n,e)=>`分片数量不足。至少需要 ${n} 个分片，但只提供了 ${e} 个。`,duplicateShares:"检测到重复的分片。每个分片应该是唯一的。",recoveryFailed:"恢复失败：",noValidShares:"没有找到有效的分片数据",checkShareFormat:"请检查分片格式是否正确，确保每行一个完整的分片",copyFailed:"复制到剪贴板失败",downloadFailed:"下载失败，请重试",encryptionFieldsMissing:"加密字段缺失",fileTypeNotSupported:"不支持的文件类型：{0}",fileTooLarge:"文件过大：{0}",duplicateFile:"重复文件：{0}"},success:{sharesGenerated:"分片生成成功！请安全保存这些分片。",mnemonicRecovered:"助记词恢复成功！",copySuccess:"已复制到剪贴板！",shareDownloaded:n=>`分片 ${n} 已下载`,encryptedShareDownloaded:n=>`加密分片 ${n} 已下载`,recoverySuccess:"恢复成功！"},warnings:{duplicateWordsDetected:"检测到重复单词：",uniqueWordsNote:"助记词中的单词应该是唯一的，请检查并修改重复的单词。",duplicateWords:n=>`检测到重复单词：${n.join(", ")}`},info:{recovering:"正在恢复...",validShares:(n,e)=>`检测到 ${n} 个有效分片（需要 ${e} 个），可以开始恢复`},fileStatus:{processing:"处理中...",valid:"有效分片",invalid:"格式无效",encrypted:"加密文件 - 等待解密",unknown:"未知状态"},copy:"复制",download:"下载",share:n=>`分片 ${n}`,wordLabel:n=>`${n}. 单词`,wordPlaceholder:n=>`第 ${n} 个单词`,position:"位置",shareFilePrefix:"分片",mnemonic:"助记词",shares:"个",sharesUsed:"使用分片数",need:"需要",recoveryTime:"恢复时间",fileTemplate:{appName:"MnemonicShards",shareContent:"分片内容",generatedTime:"生成时间",securityTips:"安全提示",tip1:"请将此文件保存在安全的位置",tip2:"不要将分片分享给不信任的人",tip3:"任意指定数量的分片即可恢复原始助记词"},encryption:{title:"加密选项",enableEncryption:"启用加密",encryptionDescription:"通过密码对每个分片进行加密，增加额外的安全层",passwordLabel:"密码",confirmPasswordLabel:"确认密码",passwordPlaceholder:"请输入加密密码",confirmPasswordPlaceholder:"请确认加密密码",passwordTip:"请务必记住您的密码，恢复助记词时将需要此密码",weakPassword:"密码过于简单，请使用至少8个字符，包含字母、数字和符号的组合",passwordMismatch:"两次输入的密码不匹配",encryptingShares:"正在加密分片...",encryptingShare:n=>`正在加密分片 ${n}...`,encryptedSharesTitle:"生成的加密分片",encryptionSuccess:"分片加密成功！",encryptionFailed:"加密失败：",decryptionFailed:"解密失败：",invalidPassword:"密码无效，请检查后重试",encryptionInfo:"每个分片将使用OpenPGP格式加密，兼容GPG工具。恢复时将需要相同的密码。",securityNotice:"加密分片在存储在可能存在风险的位置时提供额外的安全性。",passwordRequired:"解密需要密码",decryptingShares:"正在解密分片...",encryptedShareNotice:"加密分片 - 此分片使用OpenPGP格式加密，恢复时需要密码",encryptedShareTip:"此分片使用OpenPGP格式加密（兼容GPG）。恢复助记词时需要使用生成时相同的密码。",gpgCompatibility:"此加密分片可使用GPG命令解密：gpg --decrypt 分片1.gpg",encryptedFileDetected:"检测到加密文件，需要输入密码进行解密",noEncryptedFiles:"没有需要解密的文件"},passwordDialog:{title:"输入解密密码",retryTitle:"密码错误",message:"请输入密码以解密分片。",retryMessage:"您输入的密码不正确，请重试。",confirm:"确认",cancel:"取消"},language:"语言"}},z0=je.EN;class bc{constructor(){this.currentLanguage=this.loadLanguageFromStorage()||z0,this.listeners=[]}loadLanguageFromStorage(){try{return localStorage.getItem("mnemonicShards_language")}catch{return null}}saveLanguageToStorage(e){try{localStorage.setItem("mnemonicShards_language",e)}catch{}}getCurrentLanguage(){return this.currentLanguage}setLanguage(e){Object.values(je).includes(e)&&(this.currentLanguage=e,this.saveLanguageToStorage(e),this.updatePageLanguage(),this.updateAllElements(),this.notifyListeners())}t(e,...r){const t=Fa[this.currentLanguage],i=this.getNestedValue(t,e);if(typeof i=="function")return i(...r);if(i===void 0){const s=this.getNestedValue(Fa[je.EN],e);return typeof s=="function"?s(...r):s||e}return i}getNestedValue(e,r){return r.split(".").reduce((t,i)=>t&&t[i]!==void 0?t[i]:void 0,e)}addListener(e){this.listeners.push(e)}removeListener(e){const r=this.listeners.indexOf(e);r>-1&&this.listeners.splice(r,1)}notifyListeners(){this.listeners.forEach(e=>{try{e(this.currentLanguage)}catch{}})}updatePageLanguage(){document.documentElement.setAttribute("lang",this.currentLanguage===je.ZH?"zh-CN":"en")}updateAllElements(){document.querySelectorAll("[data-i18n]").forEach(t=>{const i=t.getAttribute("data-i18n"),s=this.t(i);t.tagName==="INPUT"||t.tagName==="TEXTAREA"?t.type==="submit"||t.type==="button"?t.value=s:t.placeholder=s:t.innerHTML=s}),document.querySelectorAll("[data-i18n-placeholder]").forEach(t=>{const i=t.getAttribute("data-i18n-placeholder"),s=this.t(i);t.placeholder=s})}switchTo(e){this.setLanguage(e)}toggleLanguage(){const e=this.currentLanguage===je.EN?je.ZH:je.EN;this.switchTo(e)}getAvailableLanguages(){return Object.values(je).map(e=>({code:e,name:H0[e],isCurrent:e===this.currentLanguage}))}init(){this.updatePageLanguage(),this.updateAllElements()}}const Me=new bc,V=(n,...e)=>Me.t(n,...e),_0=Object.freeze(Object.defineProperty({__proto__:null,I18nManager:bc,i18n:Me,t:V},Symbol.toStringTag,{value:"Module"}));class V0{constructor(e=12){this.wordCount=e,this.autocompleteTimeouts=new Map,this.suggestionCache=new Map,T0(async()=>{const{i18n:r}=await Promise.resolve().then(()=>_0);return{i18n:r}},void 0,import.meta.url).then(({i18n:r})=>{r.addListener(()=>{this.renderInputs()})})}setWordCount(e){this.wordCount=e,this.renderInputs()}renderInputs(){const e=F(j.WORDS_GRID);if(!e)return;const r=new Map;for(let t=1;t<=this.wordCount;t++){const i=F(j.WORD_INPUT(t));i&&i.value.trim()&&r.set(t,i.value.trim())}Dn(e);for(let t=1;t<=this.wordCount;t++){const i=this.createWordInput(t);if(e.appendChild(i),r.has(t)){const s=F(j.WORD_INPUT(t));s&&(s.value=r.get(t),this.validateAndStyleInput(s,t))}}}createWordInput(e){const r=ie("div",["word-input"]),t=ie("div",["input-wrapper"]),i=ie("input",[],{type:"text",id:`word${e}`,placeholder:"",autocomplete:"off"}),s=ie("label",[],{for:`word${e}`});s.textContent=V("wordLabel",e);const a=ie("div",["autocomplete-suggestions"],{id:`suggestions${e}`});return t.appendChild(i),t.appendChild(s),t.appendChild(a),r.appendChild(t),this.attachInputListeners(i,e),r}attachInputListeners(e,r){const t=L0(()=>{this.handleInputChange(e,r)},Nr.DELAY.DEBOUNCE);te(e,"input",t),te(e,"blur",()=>{setTimeout(()=>{this.validateAndStyleInput(e,r),this.hideSuggestions(r)},Nr.DELAY.BLUR_DELAY)}),te(e,"focus",i=>{i.target.value.trim().length>0&&this.handleInputChange(e,r)})}handleInputChange(e,r){const t=e.value.trim().toLowerCase();if(this.clearAutocompleteTimeout(r),t.length===0){this.hideSuggestions(r),this.checkForDuplicateWords();return}this.showSuggestions(t,r),this.checkForDuplicateWords()}validateAndStyleInput(e,r){const t=e.value.trim();if(t.length===0){me(e,We.VALID_WORD,!1),me(e,We.INVALID_WORD,!1);return}Oa(rs,t)?(me(e,We.INVALID_WORD,!1),me(e,We.VALID_WORD,!0)):(me(e,We.VALID_WORD,!1),me(e,We.INVALID_WORD,!0),e.value="",this.showInvalidWordError(r)),this.checkForDuplicateWords()}showInvalidWordError(e){const r=F(j.INPUT_ERROR_ALERT);r&&(r.textContent=V("errors.invalidWordCleared",e),Ye(r,!0),setTimeout(()=>{Ye(r,!1)},Nr.DELAY.AUTO_HIDE_ALERT))}searchWords(e){if(!e||e.length===0)return[];if(this.suggestionCache.has(e))return this.suggestionCache.get(e);const r=rs.filter(t=>t.toLowerCase().startsWith(e)).slice(0,Nr.SUGGESTIONS.MAX_SUGGESTIONS);return this.suggestionCache.set(e,r),r}showSuggestions(e,r){const t=this.searchWords(e),i=F(j.SUGGESTIONS(r));if(!i||t.length===0){this.hideSuggestions(r);return}Dn(i),i.style.display="block",this.positionSuggestions(i,r),this.renderSuggestionItems(i,t,r)}positionSuggestions(e,r){const t=F(j.WORD_INPUT(r));if(!t)return;if(La())Object.assign(e.style,{position:"fixed",top:"auto",bottom:Nr.SUGGESTIONS.MOBILE_BOTTOM_OFFSET,left:"10px",right:"10px",width:"calc(100% - 20px)",zIndex:"99999",background:"rgba(0, 0, 0, 0.95)",padding:"12px",borderRadius:"12px",textAlign:"center"});else{const s=t.closest(".words-grid").getBoundingClientRect(),o=t.getBoundingClientRect().left-s.left,c=s.width,u=o>c*.6;Object.assign(e.style,{position:"absolute",top:"100%",zIndex:"99999",background:"transparent",padding:"8px 0 0 0",textAlign:u?"right":"left"})}}renderSuggestionItems(e,r,t){const i=ie("div",["suggestions-container"]),s=La();if(s)Object.assign(i.style,{display:"flex",flexWrap:"wrap",gap:"8px",justifyContent:"center",maxHeight:Nr.SUGGESTIONS.MOBILE_MAX_HEIGHT,overflowY:"auto",webkitOverflowScrolling:"touch"});else{const a=F(j.WORD_INPUT(t)),o=a.closest(".words-grid").getBoundingClientRect(),u=a.getBoundingClientRect().left-o.left,h=o.width,l=u>h*.6;Object.assign(i.style,{display:"flex",gap:"6px",justifyContent:l?"flex-end":"flex-start",flexWrap:"nowrap",alignItems:"center"})}r.forEach(a=>{const o=this.createSuggestionItem(a,t,s);i.appendChild(o)}),e.appendChild(i)}createSuggestionItem(e,r,t){const i=ie("div",["suggestion-item"]);i.textContent=e;const s={fontSize:"14px",padding:"8px 14px",background:"#6fa8dc",color:"white",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.2)",userSelect:"none",webkitUserSelect:"none"},a={padding:"6px 12px",fontSize:"0.85rem",whiteSpace:"nowrap",flexShrink:"0",color:"white",fontWeight:"500",borderRadius:"6px",background:"#6fa8dc"};return Object.assign(i.style,t?s:a),te(i,"click",()=>this.selectWord(e,r)),i}selectWord(e,r){const t=F(j.WORD_INPUT(r));t&&(t.value=e,me(t,We.INVALID_WORD,!1),me(t,We.VALID_WORD,!0),this.hideSuggestions(r),this.checkForDuplicateWords(),r<this.wordCount&&F(j.WORD_INPUT(r+1))?.focus())}hideSuggestions(e){const r=F(j.SUGGESTIONS(e));r&&(Ye(r,!1),Dn(r))}checkForDuplicateWords(){const e=[],r=new Set,t=new Map;for(let i=1;i<=this.wordCount;i++){const s=F(j.WORD_INPUT(i));if(!s)continue;const a=s.value.trim().toLowerCase();a&&(e.includes(a)?(r.add(a),t.has(a)||t.set(a,[]),t.get(a).push(i)):e.push(a))}this.updateDuplicateAlert(r,t),this.updateDuplicateStyling(r)}updateDuplicateAlert(e,r){const t=F(j.DUPLICATE_ALERT);if(t)if(t.innerHTML="",e.size>0){const i=document.createElement("strong");i.textContent=V("warnings.duplicateWordsDetected"),t.appendChild(i),t.appendChild(document.createElement("br"));for(const[a,o]of r){const c=document.createElement("strong");c.textContent=a,t.appendChild(c);const u=document.createTextNode(`: ${V("position")} ${o.join(", ")}`);t.appendChild(u),t.appendChild(document.createElement("br"))}const s=document.createElement("small");s.textContent=V("warnings.uniqueWordsNote"),t.appendChild(s),Ye(t,!0)}else Ye(t,!1)}updateDuplicateStyling(e){for(let r=1;r<=this.wordCount;r++){const t=F(j.WORD_INPUT(r));if(!t)continue;const i=t.value.trim().toLowerCase(),s=i&&e.has(i);me(t,We.DUPLICATE_WORD,s)}}clearAutocompleteTimeout(e){this.autocompleteTimeouts.has(e)&&(clearTimeout(this.autocompleteTimeouts.get(e)),this.autocompleteTimeouts.delete(e))}getWords(){const e=[];for(let r=1;r<=this.wordCount;r++){const t=F(j.WORD_INPUT(r));if(t){const i=t.value.trim();i&&e.push(i)}}return e}validateAllInputs(){const e=[];let r=!1,t=!1,i=-1;for(let s=1;s<=this.wordCount;s++){const a=F(j.WORD_INPUT(s));if(!a)continue;const o=a.value.trim();if(!o){r=!0;break}if(!Oa(rs,o)){t=!0,i=s;break}e.push(o)}return{isValid:!r&&!t,words:e,hasEmpty:r,hasInvalidWord:t,invalidWordIndex:i}}destroy(){this.autocompleteTimeouts.forEach(e=>{clearTimeout(e)}),this.autocompleteTimeouts.clear(),this.suggestionCache.clear()}}function Ec(n){return crypto.getRandomValues(new Uint8Array(n))}const mi=new Uint8Array([0,255,200,8,145,16,208,54,90,62,216,67,153,119,254,24,35,32,7,112,161,108,12,127,98,139,64,70,199,75,224,14,235,22,232,173,207,205,57,83,106,39,53,147,212,78,72,195,43,121,84,40,9,120,15,33,144,135,20,42,169,156,214,116,180,124,222,237,177,134,118,164,152,226,150,143,2,50,28,193,51,238,239,129,253,48,92,19,157,41,23,196,17,68,140,128,243,115,66,30,29,181,240,18,209,91,65,162,215,44,233,213,89,203,80,168,220,252,242,86,114,166,101,47,159,155,61,186,125,194,69,130,167,87,182,163,122,117,79,174,63,55,109,71,97,190,171,211,95,176,88,175,202,94,250,133,228,77,138,5,251,96,183,123,184,38,74,103,198,26,248,105,37,179,219,189,102,221,241,210,223,3,141,52,217,146,13,99,85,170,73,236,188,149,60,132,11,245,230,231,229,172,126,110,185,249,218,142,154,201,36,225,10,21,107,58,160,81,244,234,178,151,158,93,34,136,148,206,25,1,113,76,165,227,197,49,187,204,31,45,59,82,111,246,46,137,247,192,104,27,100,4,6,191,131,56]),vc=new Uint8Array([1,229,76,181,251,159,252,18,3,52,212,196,22,186,31,54,5,92,103,87,58,213,33,90,15,228,169,249,78,100,99,238,17,55,224,16,210,172,165,41,51,89,59,48,109,239,244,123,85,235,77,80,183,42,7,141,255,38,215,240,194,126,9,140,26,106,98,11,93,130,27,143,46,190,166,29,231,157,45,138,114,217,241,39,50,188,119,133,150,112,8,105,86,223,153,148,161,144,24,187,250,122,176,167,248,171,40,214,21,142,203,242,19,230,120,97,63,137,70,13,53,49,136,163,65,128,202,23,95,83,131,254,195,155,69,57,225,245,158,25,94,182,207,75,56,4,185,43,226,193,74,221,72,12,208,125,61,88,222,124,216,20,107,135,71,232,121,132,115,60,189,146,201,35,139,151,149,68,220,173,64,101,134,162,164,204,127,236,192,175,145,253,247,79,129,47,91,234,168,28,2,209,152,113,237,37,227,36,6,104,179,147,44,111,62,108,10,184,206,174,116,177,66,180,30,211,73,233,156,200,198,199,34,110,219,32,191,67,81,82,102,178,118,96,218,197,243,246,170,205,154,160,117,84,14,1]);function ci(n,e){if(!Number.isInteger(n)||n<0||n>255)throw new RangeError("Number is out of Uint8 range");if(!Number.isInteger(e)||e<0||e>255)throw new RangeError("Number is out of Uint8 range");return n^e}function W0(n,e){if(!Number.isInteger(n)||n<0||n>255)throw new RangeError("Number is out of Uint8 range");if(!Number.isInteger(e)||e<0||e>255)throw new RangeError("Number is out of Uint8 range");if(e===0)throw new Error("cannot divide by zero");const r=mi[n],t=mi[e],i=(r-t+255)%255,s=vc[i];return n===0?0:s}function Ls(n,e){if(!Number.isInteger(n)||n<0||n>255)throw new RangeError("Number is out of Uint8 range");if(!Number.isInteger(e)||e<0||e>255)throw new RangeError("Number is out of Uint8 range");const r=mi[n],t=mi[e],i=(r+t)%255,s=vc[i];return n===0||e===0?0:s}function j0(n,e,r){if(n.length!==e.length)throw new Error("sample length mistmatch");const t=n.length;let i=0,s=0;for(let a=0;a<t;a++){i=1;for(let o=0;o<t;++o){if(a===o)continue;const c=ci(r,n[o]),u=ci(n[a],n[o]),h=W0(c,u);i=Ls(i,h)}s=ci(s,Ls(e[a],i))}return s}function q0(n,e,r){if(e===0)throw new Error("cannot evaluate secret polynomial at zero");let t=n[r];for(let i=r-1;i>=0;i--){const s=n[i];t=ci(Ls(t,e),s)}return t}function Y0(n,e){const r=new Uint8Array(e+1);return r[0]=n,r.set(Ec(e),1),r}function J0(){const n=new Uint8Array(255);for(let r=0;r<255;r++)n[r]=r+1;const e=Ec(255);for(let r=0;r<255;r++){const t=e[r]%255,i=n[r];n[r]=n[t],n[t]=i}return n}const rt={instanceOf(n,e,r){if(n.constructor!==e)throw new TypeError(r)},inRange(n,e,r,t){if(!(e<r&&n>=e&&n<r))throw new RangeError(t)},greaterThanOrEqualTo(n,e,r){if(n<e)throw new Error(r)},equalTo(n,e,r){if(n!==e)throw new Error(r)}};async function $0(n,e,r){rt.instanceOf(n,Uint8Array,"secret must be a Uint8Array"),rt.greaterThanOrEqualTo(n.byteLength,1,"secret cannot be empty"),rt.instanceOf(e,Number,"shares must be a number"),rt.inRange(e,2,256,"shares must be at least 2 and at most 255"),rt.instanceOf(r,Number,"threshold must be a number"),rt.inRange(r,2,256,"threshold must be at least 2 and at most 255"),rt.greaterThanOrEqualTo(e,r,"shares cannot be less than threshold");const t=[],i=n.byteLength,s=J0();for(let o=0;o<e;o++){const c=new Uint8Array(i+1);c[i]=s[o],t.push(c)}const a=r-1;for(let o=0;o<i;o++){const c=n[o],u=Y0(c,a);for(let h=0;h<e;++h){const l=s[h],f=q0(u,l,a);t[h][o]=f}}return t}async function as(n){rt.instanceOf(n,Array,"shares must be an Array"),rt.inRange(n.length,2,256,"shares must have at least 2 and at most 255 elements");const e=n[0];rt.instanceOf(e,Uint8Array,"each share must be a Uint8Array");for(const u of n)rt.instanceOf(u,Uint8Array,"each share must be a Uint8Array"),rt.greaterThanOrEqualTo(u.byteLength,2,"each share must be at least 2 bytes"),rt.equalTo(u.byteLength,e.byteLength,"all shares must have the same byte length");const r=n.length,t=e.byteLength,i=t-1,s=new Uint8Array(i),a=new Uint8Array(r),o=new Uint8Array(r),c=new Set;for(let u=0;u<r;u++){const l=n[u][t-1];if(c.has(l))throw new Error("shares must contain unique values but a duplicate was found");c.add(l),a[u]=l}for(let u=0;u<i;u++){for(let h=0;h<r;++h)o[h]=n[h][u];s[u]=j0(a,o,0)}return s}/*! OpenPGP.js v6.2.2 - 2025-09-02 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */const Qe=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Z0(n,e){return e.forEach((function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach((function(t){if(t!=="default"&&!(t in n)){var i=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(n,t,i.get?i:{enumerable:!0,get:function(){return r[t]}})}}))})),Object.freeze(n)}const Hr=Symbol("doneWritingPromise"),Sc=Symbol("doneWritingResolve"),xc=Symbol("doneWritingReject"),cn=Symbol("readingIndex");class ht extends Array{constructor(){super(),Object.setPrototypeOf(this,ht.prototype),this[Hr]=new Promise(((e,r)=>{this[Sc]=e,this[xc]=r})),this[Hr].catch((()=>{}))}}function xe(n){return n&&n.getReader&&Array.isArray(n)}function mn(n){if(!xe(n)){const e=n.getWriter(),r=e.releaseLock;return e.releaseLock=()=>{e.closed.catch((function(){})),r.call(e)},e}this.stream=n}function Xe(n){if(xe(n))return"array";if(Qe.ReadableStream&&Qe.ReadableStream.prototype.isPrototypeOf(n))return"web";if(n&&!(Qe.ReadableStream&&n instanceof Qe.ReadableStream)&&typeof n._read=="function"&&typeof n._readableState=="object")throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!(!n||!n.getReader)&&"web-like"}function Mi(n){return Uint8Array.prototype.isPrototypeOf(n)}function Ic(n){if(n.length===1)return n[0];let e=0;for(let i=0;i<n.length;i++){if(!Mi(n[i]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");e+=n[i].length}const r=new Uint8Array(e);let t=0;return n.forEach((function(i){r.set(i,t),t+=i.length})),r}ht.prototype.getReader=function(){return this[cn]===void 0&&(this[cn]=0),{read:async()=>(await this[Hr],this[cn]===this.length?{value:void 0,done:!0}:{value:this[this[cn]++],done:!1})}},ht.prototype.readToEnd=async function(n){await this[Hr];const e=n(this.slice(this[cn]));return this.length=0,e},ht.prototype.clone=function(){const n=new ht;return n[Hr]=this[Hr].then((()=>{n.push(...this)})),n},mn.prototype.write=async function(n){this.stream.push(n)},mn.prototype.close=async function(){this.stream[Sc]()},mn.prototype.abort=async function(n){return this.stream[xc](n),n},mn.prototype.releaseLock=function(){},typeof Qe.process=="object"&&Qe.process.versions;const Ma=new WeakSet,le=Symbol("externalBuffer");function It(n){if(this.stream=n,n[le]&&(this[le]=n[le].slice()),xe(n)){const r=n.getReader();return this._read=r.read.bind(r),this._releaseLock=()=>{},void(this._cancel=()=>{})}if(Xe(n)){const r=n.getReader();return this._read=r.read.bind(r),this._releaseLock=()=>{r.closed.catch((function(){})),r.releaseLock()},void(this._cancel=r.cancel.bind(r))}let e=!1;this._read=async()=>e||Ma.has(n)?{value:void 0,done:!0}:(e=!0,{value:n,done:!1}),this._releaseLock=()=>{if(e)try{Ma.add(n)}catch{}}}function da(n){return Xe(n)?n:new ReadableStream({start(e){e.enqueue(n),e.close()}})}function Cc(n){if(Xe(n))return n;const e=new ht;return(async()=>{const r=st(e);await r.write(n),await r.close()})(),e}function Je(n){return n.some((e=>Xe(e)&&!xe(e)))?(function(e){e=e.map(da);const r=Bc((async function(s){await Promise.all(i.map((a=>Qs(a,s))))}));let t=Promise.resolve();const i=e.map(((s,a)=>fr(s,((o,c)=>(t=t.then((()=>Ir(o,r.writable,{preventClose:a!==e.length-1}))),t)))));return r.readable})(n):n.some((e=>xe(e)))?(function(e){const r=new ht;let t=Promise.resolve();return e.forEach(((i,s)=>(t=t.then((()=>Ir(i,r,{preventClose:s!==e.length-1}))),t))),r})(n):typeof n[0]=="string"?n.join(""):Ic(n)}async function Ir(n,e,{preventClose:r=!1,preventAbort:t=!1,preventCancel:i=!1}={}){if(Xe(n)&&!xe(n)){n=da(n);try{if(n[le]){const o=st(e);for(let c=0;c<n[le].length;c++)await o.ready,await o.write(n[le][c]);o.releaseLock()}await n.pipeTo(e,{preventClose:r,preventAbort:t,preventCancel:i})}catch{}return}const s=jt(n=Cc(n)),a=st(e);try{for(;;){await a.ready;const{done:o,value:c}=await s.read();if(o){r||await a.close();break}await a.write(c)}}catch(o){t||await a.abort(o)}finally{s.releaseLock(),a.releaseLock()}}function kc(n,e){const r=new TransformStream(e);return Ir(n,r.writable),r.readable}function Bc(n){let e,r,t,i=!1,s=!1;return{readable:new ReadableStream({start(a){t=a},pull(){e?e():i=!0},async cancel(a){s=!0,n&&await n(a),r&&r(a)}},{highWaterMark:0}),writable:new WritableStream({write:async function(a){if(s)throw Error("Stream is cancelled");t.enqueue(a),i?i=!1:(await new Promise(((o,c)=>{e=o,r=c})),e=null,r=null)},close:t.close.bind(t),abort:t.error.bind(t)})}}function ve(n,e=()=>{},r=()=>{}){if(xe(n)){const s=new ht;return(async()=>{const a=st(s);try{const o=await Ce(n),c=e(o),u=r();let h;h=c!==void 0&&u!==void 0?Je([c,u]):c!==void 0?c:u,await a.write(h),await a.close()}catch(o){await a.abort(o)}})(),s}if(Xe(n))return kc(n,{async transform(s,a){try{const o=await e(s);o!==void 0&&a.enqueue(o)}catch(o){a.error(o)}},async flush(s){try{const a=await r();a!==void 0&&s.enqueue(a)}catch(a){s.error(a)}}});const t=e(n),i=r();return t!==void 0&&i!==void 0?Je([t,i]):t!==void 0?t:i}function fr(n,e){if(Xe(n)&&!xe(n)){let t;const i=new TransformStream({start(o){t=o}}),s=Ir(n,i.writable),a=Bc((async function(o){t.error(o),await s,await new Promise(setTimeout)}));return e(i.readable,a.writable),a.readable}n=Cc(n);const r=new ht;return e(n,r),r}function Gi(n,e){let r;const t=fr(n,((i,s)=>{const a=jt(i);a.remainder=()=>(a.releaseLock(),Ir(i,s),t),r=e(a)}));return r}function Cr(n){if(xe(n))return n.clone();if(Xe(n)){const e=(function(r){if(xe(r))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(Xe(r)){const t=da(r).tee();return t[0][le]=t[1][le]=r[le],t}return[Re(r),Re(r)]})(n);return Uc(n,e[0]),e[1]}return Re(n)}function Pn(n){return xe(n)?Cr(n):Xe(n)?new ReadableStream({start(e){const r=fr(n,(async(t,i)=>{const s=jt(t),a=st(i);try{for(;;){await a.ready;const{done:o,value:c}=await s.read();if(o){try{e.close()}catch{}return void await a.close()}try{e.enqueue(c)}catch{}await a.write(c)}}catch(o){e.error(o),await a.abort(o)}}));Uc(n,r)}}):Re(n)}function Uc(n,e){Object.entries(Object.getOwnPropertyDescriptors(n.constructor.prototype)).forEach((([r,t])=>{r!=="constructor"&&(t.value?t.value=t.value.bind(e):t.get=t.get.bind(e),Object.defineProperty(n,r,t))}))}function Re(n,e=0,r=1/0){if(xe(n))throw Error("Not implemented");if(Xe(n)){if(e>=0&&r>=0){let t=0;return kc(n,{transform(i,s){t<r?(t+i.length>=e&&s.enqueue(Re(i,Math.max(e-t,0),r-t)),t+=i.length):s.terminate()}})}if(e<0&&(r<0||r===1/0)){let t=[];return ve(n,(i=>{i.length>=-e?t=[i]:t.push(i)}),(()=>Re(Je(t),e,r)))}if(e===0&&r<0){let t;return ve(n,(i=>{const s=t?Je([t,i]):i;if(s.length>=-r)return t=Re(s,r),Re(s,e,r);t=s}))}return console.warn(`stream.slice(input, ${e}, ${r}) not implemented efficiently.`),dr((async()=>Re(await Ce(n),e,r)))}return n[le]&&(n=Je(n[le].concat([n]))),Mi(n)?n.subarray(e,r===1/0?n.length:r):n.slice(e,r)}async function Ce(n,e=Je){return xe(n)?n.readToEnd(e):Xe(n)?jt(n).readToEnd(e):n}async function Qs(n,e){if(Xe(n)){if(n.cancel){const r=await n.cancel(e);return await new Promise(setTimeout),r}if(n.destroy)return n.destroy(e),await new Promise(setTimeout),e}}function dr(n){const e=new ht;return(async()=>{const r=st(e);try{await r.write(await n()),await r.close()}catch(t){await r.abort(t)}})(),e}function jt(n){return new It(n)}function st(n){return new mn(n)}It.prototype.read=async function(){return this[le]&&this[le].length?{done:!1,value:this[le].shift()}:this._read()},It.prototype.releaseLock=function(){this[le]&&(this.stream[le]=this[le]),this._releaseLock()},It.prototype.cancel=function(n){return this._cancel(n)},It.prototype.readLine=async function(){let n,e=[];for(;!n;){let{done:r,value:t}=await this.read();if(t+="",r)return e.length?Je(e):void 0;const i=t.indexOf(`
`)+1;i&&(n=Je(e.concat(t.substr(0,i))),e=[]),i!==t.length&&e.push(t.substr(i))}return this.unshift(...e),n},It.prototype.readByte=async function(){const{done:n,value:e}=await this.read();if(n)return;const r=e[0];return this.unshift(Re(e,1)),r},It.prototype.readBytes=async function(n){const e=[];let r=0;for(;;){const{done:t,value:i}=await this.read();if(t)return e.length?Je(e):void 0;if(e.push(i),r+=i.length,r>=n){const s=Je(e);return this.unshift(Re(s,n)),Re(s,0,n)}}},It.prototype.peekBytes=async function(n){const e=await this.readBytes(n);return this.unshift(e),e},It.prototype.unshift=function(...n){this[le]||(this[le]=[]),n.length===1&&Mi(n[0])&&this[le].length&&n[0].length&&this[le][0].byteOffset>=n[0].length?this[le][0]=new Uint8Array(this[le][0].buffer,this[le][0].byteOffset-n[0].length,this[le][0].byteLength+n[0].length):this[le].unshift(...n.filter((e=>e&&e.length)))},It.prototype.readToEnd=async function(n=Je){const e=[];for(;;){const{done:r,value:t}=await this.read();if(r)break;e.push(t)}return n(e)};const ln=Symbol("byValue");var d={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(n,e){if(typeof e=="number"&&(e=this.read(n,e)),n[e]!==void 0)return n[e];throw Error("Invalid enum value.")},read:function(n,e){if(n[ln]||(n[ln]=[],Object.entries(n).forEach((([r,t])=>{n[ln][t]=r}))),n[ln][e]!==void 0)return n[ln][e];throw Error("Invalid enum value.")}},$={preferredHashAlgorithm:d.hash.sha512,preferredSymmetricAlgorithm:d.symmetric.aes256,preferredCompressionAlgorithm:d.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:d.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:d.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([d.symmetric.aes128,d.symmetric.aes192,d.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,enforceGrammar:!0,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.2.2",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([d.hash.md5,d.hash.ripemd]),rejectMessageHashAlgorithms:new Set([d.hash.md5,d.hash.ripemd,d.hash.sha1]),rejectPublicKeyAlgorithms:new Set([d.publicKey.elgamal,d.publicKey.dsa]),rejectCurves:new Set([d.curve.secp256k1])};const Ga=(()=>{try{return!1}catch{}return!1})(),A={isString:function(n){return typeof n=="string"||n instanceof String},nodeRequire:()=>{},isArray:function(n){return n instanceof Array},isUint8Array:Mi,isStream:Xe,getNobleCurve:async(n,e)=>{if(!$.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");const{nobleCurves:r}=await Promise.resolve().then((function(){return eh}));switch(n){case d.publicKey.ecdh:case d.publicKey.ecdsa:{const t=r.get(e);if(!t)throw Error("Unsupported curve");return t}case d.publicKey.x448:return r.get("x448");case d.publicKey.ed448:return r.get("ed448");default:throw Error("Unsupported curve")}},readNumber:function(n){let e=0;for(let r=0;r<n.length;r++)e+=256**r*n[n.length-1-r];return e},writeNumber:function(n,e){const r=new Uint8Array(e);for(let t=0;t<e;t++)r[t]=n>>8*(e-t-1)&255;return r},readDate:function(n){const e=A.readNumber(n);return new Date(1e3*e)},writeDate:function(n){const e=Math.floor(n.getTime()/1e3);return A.writeNumber(e,4)},normalizeDate:function(n=Date.now()){return n===null||n===1/0?n:new Date(1e3*Math.floor(+n/1e3))},readMPI:function(n){const e=(n[0]<<8|n[1])+7>>>3;return A.readExactSubarray(n,2,2+e)},readExactSubarray:function(n,e,r){if(n.length<r-e)throw Error("Input array too short");return n.subarray(e,r)},leftPad(n,e){if(n.length>e)throw Error("Input array too long");const r=new Uint8Array(e),t=e-n.length;return r.set(n,t),r},uint8ArrayToMPI:function(n){const e=A.uint8ArrayBitLength(n);if(e===0)throw Error("Zero MPI");const r=n.subarray(n.length-Math.ceil(e/8)),t=new Uint8Array([(65280&e)>>8,255&e]);return A.concatUint8Array([t,r])},uint8ArrayBitLength:function(n){let e;for(e=0;e<n.length&&n[e]===0;e++);if(e===n.length)return 0;const r=n.subarray(e);return 8*(r.length-1)+A.nbits(r[0])},hexToUint8Array:function(n){const e=new Uint8Array(n.length>>1);for(let r=0;r<n.length>>1;r++)e[r]=parseInt(n.substr(r<<1,2),16);return e},uint8ArrayToHex:function(n){const e="0123456789abcdef";let r="";return n.forEach((t=>{r+=e[t>>4]+e[15&t]})),r},stringToUint8Array:function(n){return ve(n,(e=>{if(!A.isString(e))throw Error("stringToUint8Array: Data must be in the form of a string");const r=new Uint8Array(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}))},uint8ArrayToString:function(n){const e=[],t=(n=new Uint8Array(n)).length;for(let i=0;i<t;i+=16384)e.push(String.fromCharCode.apply(String,n.subarray(i,i+16384<t?i+16384:t)));return e.join("")},encodeUTF8:function(n){const e=new TextEncoder("utf-8");function r(t,i=!1){return e.encode(t,{stream:!i})}return ve(n,r,(()=>r("",!0)))},decodeUTF8:function(n){const e=new TextDecoder("utf-8");function r(t,i=!1){return e.decode(t,{stream:!i})}return ve(n,r,(()=>r(new Uint8Array,!0)))},concat:Je,concatUint8Array:Ic,equalsUint8Array:function(n,e){if(!A.isUint8Array(n)||!A.isUint8Array(e))throw Error("Data must be in the form of a Uint8Array");if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(n[r]!==e[r])return!1;return!0},findLastIndex:function(n,e){for(let r=n.length;r>=0;r--)if(e(n[r],r,n))return r;return-1},writeChecksum:function(n){let e=0;for(let r=0;r<n.length;r++)e=e+n[r]&65535;return A.writeNumber(e,2)},printDebug:function(n){Ga&&console.log("[OpenPGP.js debug]",n)},printDebugError:function(n){Ga&&console.error("[OpenPGP.js debug]",n)},nbits:function(n){let e=1,r=n>>>16;return r!==0&&(n=r,e+=16),r=n>>8,r!==0&&(n=r,e+=8),r=n>>4,r!==0&&(n=r,e+=4),r=n>>2,r!==0&&(n=r,e+=2),r=n>>1,r!==0&&(n=r,e+=1),e},double:function(n){const e=new Uint8Array(n.length),r=n.length-1;for(let t=0;t<r;t++)e[t]=n[t]<<1^n[t+1]>>7;return e[r]=n[r]<<1^135*(n[0]>>7),e},shiftRight:function(n,e){if(e)for(let r=n.length-1;r>=0;r--)n[r]>>=e,r>0&&(n[r]|=n[r-1]<<8-e);return n},getWebCrypto:function(){const n=Qe!==void 0&&Qe.crypto&&Qe.crypto.subtle||this.getNodeCrypto()?.webcrypto.subtle;if(!n)throw Error("The WebCrypto API is not available");return n},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return typeof navigator<"u"?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(n){return A.isString(n)?/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(n):!1},canonicalizeEOL:function(n){let e=!1;return ve(n,(r=>{let t;e&&(r=A.concatUint8Array([new Uint8Array([13]),r])),r[r.length-1]===13?(e=!0,r=r.subarray(0,-1)):e=!1;const i=[];for(let o=0;t=r.indexOf(10,o)+1,t;o=t)r[t-2]!==13&&i.push(t);if(!i.length)return r;const s=new Uint8Array(r.length+i.length);let a=0;for(let o=0;o<i.length;o++){const c=r.subarray(i[o-1]||0,i[o]);s.set(c,a),a+=c.length,s[a-1]=13,s[a]=10,a++}return s.set(r.subarray(i[i.length-1]||0),a),s}),(()=>e?new Uint8Array([13]):void 0))},nativeEOL:function(n){let e=!1;return ve(n,(r=>{let t;(r=e&&r[0]!==10?A.concatUint8Array([new Uint8Array([13]),r]):new Uint8Array(r))[r.length-1]===13?(e=!0,r=r.subarray(0,-1)):e=!1;let i=0;for(let s=0;s!==r.length;s=t){t=r.indexOf(13,s)+1,t||(t=r.length);const a=t-(r[t]===10?1:0);s&&r.copyWithin(i,s,a),i+=a-s}return r.subarray(0,i)}),(()=>e?new Uint8Array([13]):void 0))},removeTrailingSpaces:function(n){return n.split(`
`).map((e=>{let r=e.length-1;for(;r>=0&&(e[r]===" "||e[r]==="	"||e[r]==="\r");r--);return e.substr(0,r+1)})).join(`
`)},wrapError:function(n,e){if(!e)return n instanceof Error?n:Error(n);if(n instanceof Error){try{n.message+=": "+e.message,n.cause=e}catch{}return n}return Error(n+": "+e.message,{cause:e})},constructAllowedPackets:function(n){const e={};return n.forEach((r=>{if(!r.tag)throw Error("Invalid input: expected a packet class");e[r.tag]=r})),e},anyPromise:function(n){return new Promise((async(e,r)=>{let t;await Promise.all(n.map((async i=>{try{e(await i)}catch(s){t=s}}))),r(t)}))},selectUint8Array:function(n,e,r){const t=Math.max(e.length,r.length),i=new Uint8Array(t);let s=0;for(let a=0;a<i.length;a++)i[a]=e[a]&256-n|r[a]&255+n,s+=n&a<e.length|1-n&a<r.length;return i.subarray(0,s)},selectUint8:function(n,e,r){return e&256-n|r&255+n},isAES:function(n){return n===d.symmetric.aes128||n===d.symmetric.aes192||n===d.symmetric.aes256}},os=A.getNodeBuffer();let bi,Ei;function zt(n){let e=new Uint8Array;return ve(n,(r=>{e=A.concatUint8Array([e,r]);const t=[],i=Math.floor(e.length/45),s=45*i,a=bi(e.subarray(0,s));for(let o=0;o<i;o++)t.push(a.substr(60*o,60)),t.push(`
`);return e=e.subarray(s),t.join("")}),(()=>e.length?bi(e)+`
`:""))}function Dc(n){let e="";return ve(n,(r=>{e+=r;let t=0;const i=[" ","	","\r",`
`];for(let o=0;o<i.length;o++){const c=i[o];for(let u=e.indexOf(c);u!==-1;u=e.indexOf(c,u+1))t++}let s=e.length;for(;s>0&&(s-t)%4!=0;s--)i.includes(e[s])&&t--;const a=Ei(e.substr(0,s));return e=e.substr(s),a}),(()=>Ei(e)))}function qt(n){return Dc(n.replace(/-/g,"+").replace(/_/g,"/"))}function Te(n,e){let r=zt(n).replace(/[\r\n]/g,"");return r=r.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,""),r}function X0(n){const e=n.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!e)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(e[1])?d.armor.multipartSection:/MESSAGE, PART \d+/.test(e[1])?d.armor.multipartLast:/SIGNED MESSAGE/.test(e[1])?d.armor.signed:/MESSAGE/.test(e[1])?d.armor.message:/PUBLIC KEY BLOCK/.test(e[1])?d.armor.publicKey:/PRIVATE KEY BLOCK/.test(e[1])?d.armor.privateKey:/SIGNATURE/.test(e[1])?d.armor.signature:void 0}function pr(n,e){let r="";return e.showVersion&&(r+="Version: "+e.versionString+`
`),e.showComment&&(r+="Comment: "+e.commentString+`
`),n&&(r+="Comment: "+n+`
`),r+=`
`,r}function yr(n){const e=(function(r){let t=13501623;return ve(r,(i=>{const s=el?Math.floor(i.length/4):0,a=new Uint32Array(i.buffer,i.byteOffset,s);for(let o=0;o<s;o++)t^=a[o],t=Pe[0][t>>24&255]^Pe[1][t>>16&255]^Pe[2][t>>8&255]^Pe[3][255&t];for(let o=4*s;o<i.length;o++)t=t>>8^Pe[0][255&t^i[o]]}),(()=>new Uint8Array([t,t>>8,t>>16])))})(n);return zt(e)}os?(bi=n=>os.from(n).toString("base64"),Ei=n=>{const e=os.from(n,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}):(bi=n=>btoa(A.uint8ArrayToString(n)),Ei=n=>A.stringToUint8Array(atob(n)));const Pe=[Array(255),Array(255),Array(255),Array(255)];for(let n=0;n<=255;n++){let e=n<<16;for(let r=0;r<8;r++)e=e<<1^(8388608&e?8801531:0);Pe[0][n]=(16711680&e)>>16|65280&e|(255&e)<<16}for(let n=0;n<=255;n++)Pe[1][n]=Pe[0][n]>>8^Pe[0][255&Pe[0][n]];for(let n=0;n<=255;n++)Pe[2][n]=Pe[1][n]>>8^Pe[0][255&Pe[1][n]];for(let n=0;n<=255;n++)Pe[3][n]=Pe[2][n]>>8^Pe[0][255&Pe[2][n]];const el=(function(){const n=new ArrayBuffer(2);return new DataView(n).setInt16(0,255,!0),new Int16Array(n)[0]===255})();function Ha(n){for(let e=0;e<n.length;e++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(n[e])||A.printDebugError(Error("Improperly formatted armor header: "+n[e])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(n[e])||A.printDebugError(Error("Unknown header: "+n[e]))}function tl(n){let e=n;const r=n.lastIndexOf("=");return r>=0&&r!==n.length-1&&(e=n.slice(0,r)),e}function Pc(n){return new Promise((async(e,r)=>{try{const t=/^-----[^-]+-----$/m,i=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let s;const a=[];let o,c,u=a,h=[];const l=Dc(fr(n,(async(f,p)=>{const y=jt(f);try{for(;;){let g=await y.readLine();if(g===void 0)throw Error("Misformed armored text");if(g=A.removeTrailingSpaces(g.replace(/[\r\n]/g,"")),s)if(o)c||s!==d.armor.signed||(t.test(g)?(h=h.join(`\r
`),c=!0,Ha(u),u=[],o=!1):h.push(g.replace(/^- /,"")));else if(t.test(g)&&r(Error("Mandatory blank line missing between armor headers and armor data")),i.test(g)){if(Ha(u),o=!0,c||s!==d.armor.signed){e({text:h,data:l,headers:a,type:s});break}}else u.push(g);else t.test(g)&&(s=X0(g))}}catch(g){return void r(g)}const w=st(p);try{for(;;){await w.ready;const{done:g,value:m}=await y.read();if(g)throw Error("Misformed armored text");const S=m+"";if(S.indexOf("=")!==-1||S.indexOf("-")!==-1){let E=await y.readToEnd();E.length||(E=""),E=S+E,E=A.removeTrailingSpaces(E.replace(/\r/g,""));const v=E.split(t);if(v.length===1)throw Error("Misformed armored text");const U=tl(v[0].slice(0,-1));await w.write(U);break}await w.write(S)}await w.ready,await w.close()}catch(g){await w.abort(g)}})))}catch(t){r(t)}})).then((async e=>(xe(e.data)&&(e.data=await Ce(e.data)),e)))}function Kc(n,e,r,t,i,s=!1,a=$){let o,c;n===d.armor.signed&&(o=e.text,c=e.hash,e=e.data);const u=s&&Pn(e),h=[];switch(n){case d.armor.multipartSection:h.push("-----BEGIN PGP MESSAGE, PART "+r+"/"+t+`-----
`),h.push(pr(i,a)),h.push(zt(e)),u&&h.push("=",yr(u)),h.push("-----END PGP MESSAGE, PART "+r+"/"+t+`-----
`);break;case d.armor.multipartLast:h.push("-----BEGIN PGP MESSAGE, PART "+r+`-----
`),h.push(pr(i,a)),h.push(zt(e)),u&&h.push("=",yr(u)),h.push("-----END PGP MESSAGE, PART "+r+`-----
`);break;case d.armor.signed:h.push(`-----BEGIN PGP SIGNED MESSAGE-----
`),h.push(c?`Hash: ${c}

`:`
`),h.push(o.replace(/^-/gm,"- -")),h.push(`
-----BEGIN PGP SIGNATURE-----
`),h.push(pr(i,a)),h.push(zt(e)),u&&h.push("=",yr(u)),h.push(`-----END PGP SIGNATURE-----
`);break;case d.armor.message:h.push(`-----BEGIN PGP MESSAGE-----
`),h.push(pr(i,a)),h.push(zt(e)),u&&h.push("=",yr(u)),h.push(`-----END PGP MESSAGE-----
`);break;case d.armor.publicKey:h.push(`-----BEGIN PGP PUBLIC KEY BLOCK-----
`),h.push(pr(i,a)),h.push(zt(e)),u&&h.push("=",yr(u)),h.push(`-----END PGP PUBLIC KEY BLOCK-----
`);break;case d.armor.privateKey:h.push(`-----BEGIN PGP PRIVATE KEY BLOCK-----
`),h.push(pr(i,a)),h.push(zt(e)),u&&h.push("=",yr(u)),h.push(`-----END PGP PRIVATE KEY BLOCK-----
`);break;case d.armor.signature:h.push(`-----BEGIN PGP SIGNATURE-----
`),h.push(pr(i,a)),h.push(zt(e)),u&&h.push("=",yr(u)),h.push(`-----END PGP SIGNATURE-----
`)}return A.concat(h)}const Tt=BigInt(0),li=BigInt(1);function X(n){const e="0123456789ABCDEF";let r="";return n.forEach((t=>{r+=e[t>>4]+e[15&t]})),BigInt("0x0"+r)}function he(n,e){const r=n%e;return r<Tt?r+e:r}function dt(n,e,r){if(r===Tt)throw Error("Modulo cannot be zero");if(r===li)return BigInt(0);if(e<Tt)throw Error("Unsopported negative exponent");let t=e,i=n;i%=r;let s=BigInt(1);for(;t>Tt;){const a=t&li;t>>=li,s=a?s*i%r:s,i=i*i%r}return s}function za(n){return n>=Tt?n:-n}function Hi(n,e){const{gcd:r,x:t}=(function(i,s){let a=BigInt(0),o=BigInt(1),c=BigInt(1),u=BigInt(0),h=za(i),l=za(s);const f=i<Tt,p=s<Tt;for(;l!==Tt;){const y=h/l;let w=a;a=c-y*a,c=w,w=o,o=u-y*o,u=w,w=l,l=h%l,h=w}return{x:f?-c:c,y:p?-u:u,gcd:h}})(n,e);if(r!==li)throw Error("Inverse does not exist");return he(t+e,e)}function Ze(n){const e=n<Tt?BigInt(-1):Tt,r=BigInt(8);let t=1,i=n;for(;(i>>=r)!==e;)t++;return t}function at(n,e="be",r){let t=n.toString(16);t.length%2==1&&(t="0"+t);const i=t.length/2,s=new Uint8Array(r||i),a=r?r-i:0;let o=0;for(;o<i;)s[o+a]=parseInt(t.slice(2*o,2*o+2),16),o++;return e!=="be"&&s.reverse(),s}const rl=A.getNodeCrypto();function yt(n){const e=typeof crypto<"u"?crypto:rl?.webcrypto;if(e?.getRandomValues){const r=new Uint8Array(n);return e.getRandomValues(r)}throw Error("No secure random number generator available.")}function pa(n,e){if(e<n)throw Error("Illegal parameter value: max <= min");const r=e-n;return he(X(yt(Ze(r)+8)),r)+n}BigInt(1);[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map((n=>BigInt(n)));const _a=A.getWebCrypto(),vi=A.getNodeCrypto(),nl=vi&&vi.getHashes();function Jt(n){if(vi&&nl.includes(n))return async function(e){const r=vi.createHash(n);return ve(e,(t=>{r.update(t)}),(()=>new Uint8Array(r.digest())))}}function $t(n,e){const r=async()=>{const{nobleHashes:t}=await Promise.resolve().then((function(){return yh})),i=t.get(n);if(!i)throw Error("Unsupported hash");return i};return async function(t){if(xe(t)&&(t=await Ce(t)),A.isStream(t)){const i=(await r()).create();return ve(t,(s=>{i.update(s)}),(()=>i.digest()))}return _a&&e?new Uint8Array(await _a.digest(e,t)):(await r())(t)}}const il=Jt("md5")||$t("md5"),sl=Jt("sha1")||$t("sha1","SHA-1"),al=Jt("sha224")||$t("sha224"),ol=Jt("sha256")||$t("sha256","SHA-256"),cl=Jt("sha384")||$t("sha384","SHA-384"),ll=Jt("sha512")||$t("sha512","SHA-512"),ul=Jt("ripemd160")||$t("ripemd160"),hl=Jt("sha3-256")||$t("sha3_256"),fl=Jt("sha3-512")||$t("sha3_512");function kr(n,e){switch(n){case d.hash.md5:return il(e);case d.hash.sha1:return sl(e);case d.hash.ripemd:return ul(e);case d.hash.sha256:return ol(e);case d.hash.sha384:return cl(e);case d.hash.sha512:return ll(e);case d.hash.sha224:return al(e);case d.hash.sha3_256:return hl(e);case d.hash.sha3_512:return fl(e);default:throw Error("Unsupported hash function")}}function ke(n){switch(n){case d.hash.md5:return 16;case d.hash.sha1:case d.hash.ripemd:return 20;case d.hash.sha256:return 32;case d.hash.sha384:return 48;case d.hash.sha512:return 64;case d.hash.sha224:return 28;case d.hash.sha3_256:return 32;case d.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}const kt=[];function Tc(n,e){const r=n.length;if(r>e-11)throw Error("Message too long");const t=(function(s){const a=new Uint8Array(s);let o=0;for(;o<s;){const c=yt(s-o);for(let u=0;u<c.length;u++)c[u]!==0&&(a[o++]=c[u])}return a})(e-r-3),i=new Uint8Array(e);return i[1]=2,i.set(t,2),i.set(n,e-r),i}function Rc(n,e){let r=2,t=1;for(let o=r;o<n.length;o++)t&=n[o]!==0,r+=t;const i=r-2,s=n.subarray(r+1),a=n[0]===0&n[1]===2&i>=8&!t;if(e)return A.selectUint8Array(a,s,e);if(a)return s;throw Error("Decryption error")}function Nc(n,e,r){let t;if(e.length!==ke(n))throw Error("Invalid hash length");const i=new Uint8Array(kt[n].length);for(t=0;t<kt[n].length;t++)i[t]=kt[n][t];const s=i.length+e.length;if(r<s+11)throw Error("Intended encoded message length too short");const a=new Uint8Array(r-s-3).fill(255),o=new Uint8Array(r);return o[1]=1,o.set(a,2),o.set(i,r-s),o.set(e,r-e.length),o}kt[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],kt[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],kt[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],kt[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],kt[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],kt[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],kt[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];const Si=A.getWebCrypto(),Zr=A.getNodeCrypto(),xi=BigInt(1);async function dl(n,e,r,t,i,s,a,o,c){if(ke(n)>=r.length)throw Error("Digest size cannot exceed key modulus size");if(e&&!A.isStream(e)){if(A.getWebCrypto())try{return await(async function(u,h,l,f,p,y,w,g){const m=await Fs(l,f,p,y,w,g),S={name:"RSASSA-PKCS1-v1_5",hash:{name:u}},E=await Si.importKey("jwk",m,S,!1,["sign"]);return new Uint8Array(await Si.sign("RSASSA-PKCS1-v1_5",E,h))})(d.read(d.webHash,n),e,r,t,i,s,a,o)}catch(u){A.printDebugError(u)}else if(A.getNodeCrypto())return(async function(u,h,l,f,p,y,w,g){const m=Zr.createSign(d.read(d.hash,u));m.write(h),m.end();const S=await Fs(l,f,p,y,w,g);return new Uint8Array(m.sign({key:S,format:"jwk",type:"pkcs1"}))})(n,e,r,t,i,s,a,o)}return(async function(u,h,l,f){h=X(h);const p=X(Nc(u,f,Ze(h)));return l=X(l),at(dt(p,l,h),"be",Ze(h))})(n,r,i,c)}async function pl(n,e,r,t,i,s){if(e&&!A.isStream(e)){if(A.getWebCrypto())try{return await(async function(a,o,c,u,h){const l=Ms(u,h),f=await Si.importKey("jwk",l,{name:"RSASSA-PKCS1-v1_5",hash:{name:a}},!1,["verify"]);return Si.verify("RSASSA-PKCS1-v1_5",f,c,o)})(d.read(d.webHash,n),e,r,t,i)}catch(a){A.printDebugError(a)}else if(A.getNodeCrypto())return(async function(a,o,c,u,h){const l=Ms(u,h),f={key:l,format:"jwk",type:"pkcs1"},p=Zr.createVerify(d.read(d.hash,a));p.write(o),p.end();try{return p.verify(f,c)}catch{return!1}})(n,e,r,t,i)}return(async function(a,o,c,u,h){if(c=X(c),o=X(o),u=X(u),o>=c)throw Error("Signature size cannot exceed modulus size");const l=at(dt(o,u,c),"be",Ze(c)),f=Nc(a,h,Ze(c));return A.equalsUint8Array(l,f)})(n,r,t,i,s)}async function yl(n,e,r){return A.getNodeCrypto()?(async function(t,i,s){const a=Ms(i,s),o={key:a,format:"jwk",type:"pkcs1",padding:Zr.constants.RSA_PKCS1_PADDING};return new Uint8Array(Zr.publicEncrypt(o,t))})(n,e,r):(async function(t,i,s){if(i=X(i),t=X(Tc(t,Ze(i))),s=X(s),t>=i)throw Error("Message size cannot exceed modulus size");return at(dt(t,s,i),"be",Ze(i))})(n,e,r)}async function gl(n,e,r,t,i,s,a,o){if(A.getNodeCrypto()&&!o)try{return await(async function(c,u,h,l,f,p,y){const w=await Fs(u,h,l,f,p,y),g={key:w,format:"jwk",type:"pkcs1",padding:Zr.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(Zr.privateDecrypt(g,c))}catch{throw Error("Decryption error")}})(n,e,r,t,i,s,a)}catch(c){A.printDebugError(c)}return(async function(c,u,h,l,f,p,y,w){if(c=X(c),u=X(u),h=X(h),l=X(l),f=X(f),p=X(p),y=X(y),c>=u)throw Error("Data too large.");const g=he(l,p-xi),m=he(l,f-xi),S=pa(BigInt(2),u),E=dt(Hi(S,u),h,u);c=he(c*E,u);const v=dt(c,m,f),U=dt(c,g,p);let D=he(y*(U-v),p)*f+v;return D=he(D*S,u),Rc(at(D,"be",Ze(u)),w)})(n,e,r,t,i,s,a,o)}async function Fs(n,e,r,t,i,s){const a=X(t),o=X(i),c=X(r);let u=he(c,o-xi),h=he(c,a-xi);return h=at(h),u=at(u),{kty:"RSA",n:Te(n),e:Te(e),d:Te(r),p:Te(i),q:Te(t),dp:Te(u),dq:Te(h),qi:Te(s),ext:!0}}function Ms(n,e){return{kty:"RSA",n:Te(n),e:Te(e),ext:!0}}const Va=BigInt(1),Al={"2a8648ce3d030107":d.curve.nistP256,"2b81040022":d.curve.nistP384,"2b81040023":d.curve.nistP521,"2b8104000a":d.curve.secp256k1,"2b06010401da470f01":d.curve.ed25519Legacy,"2b060104019755010501":d.curve.curve25519Legacy,"2b2403030208010107":d.curve.brainpoolP256r1,"2b240303020801010b":d.curve.brainpoolP384r1,"2b240303020801010d":d.curve.brainpoolP512r1};class Yr{constructor(e){if(e instanceof Yr)this.oid=e.oid;else if(A.isArray(e)||A.isUint8Array(e)){if((e=new Uint8Array(e))[0]===6){if(e[1]!==e.length-2)throw Error("Length mismatch in DER encoded oid");e=e.subarray(2)}this.oid=e}else this.oid=""}read(e){if(e.length>=1){const r=e[0];if(e.length>=1+r)return this.oid=e.subarray(1,1+r),1+this.oid.length}throw Error("Invalid oid")}write(){return A.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return A.uint8ArrayToHex(this.oid)}getName(){const e=Al[this.toHex()];if(!e)throw Error("Unknown curve object identifier.");return e}}function wl(n){let e,r=0;const t=n[0];return t<192?([r]=n,e=1):t<255?(r=(n[0]-192<<8)+n[1]+192,e=2):t===255&&(r=A.readNumber(n.subarray(1,5)),e=5),{len:r,offset:e}}function ya(n){return n<192?new Uint8Array([n]):n>191&&n<8384?new Uint8Array([192+(n-192>>8),n-192&255]):A.concatUint8Array([new Uint8Array([255]),A.writeNumber(n,4)])}function ml(n){if(n<0||n>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+n])}function Oc(n){return new Uint8Array([192|n])}function Wa(n,e){return A.concatUint8Array([Oc(n),ya(e)])}function ui(n){return[d.packet.literalData,d.packet.compressedData,d.packet.symmetricallyEncryptedData,d.packet.symEncryptedIntegrityProtectedData,d.packet.aeadEncryptedData].includes(n)}async function bl(n,e,r){let t,i;try{const s=await n.peekBytes(2);if(!s||s.length<2||!(128&s[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const a=await n.readByte();let o,c,u=-1,h=-1;h=0,64&a&&(h=1),h?u=63&a:(u=(63&a)>>2,c=3&a);const l=ui(u);let f,p=null;if(e&&l){if(e==="array"){const y=new ht;t=st(y),p=y}else{const y=new TransformStream;t=st(y.writable),p=y.readable}i=r({tag:u,packet:p})}else p=[];do{if(h){const y=await n.readByte();if(f=!1,y<192)o=y;else if(y>=192&&y<224)o=(y-192<<8)+await n.readByte()+192;else if(y>223&&y<255){if(o=1<<(31&y),f=!0,!l)throw new TypeError("This packet type does not support partial lengths.")}else o=await n.readByte()<<24|await n.readByte()<<16|await n.readByte()<<8|await n.readByte()}else switch(c){case 0:o=await n.readByte();break;case 1:o=await n.readByte()<<8|await n.readByte();break;case 2:o=await n.readByte()<<24|await n.readByte()<<16|await n.readByte()<<8|await n.readByte();break;default:o=1/0}if(o>0){let y=0;for(;;){t&&await t.ready;const{done:w,value:g}=await n.read();if(w){if(o===1/0)break;throw Error("Unexpected end of packet")}const m=o===1/0?g:g.subarray(0,o-y);if(t?await t.write(m):p.push(m),y+=g.length,y>=o){n.unshift(g.subarray(o-y+g.length));break}}}}while(f);t?(await t.ready,await t.close()):(p=A.concatUint8Array(p),await r({tag:u,packet:p}))}catch(s){if(t)return await t.abort(s),!0;throw s}finally{t&&await i}}class oe extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,oe),this.name="UnsupportedError"}}class hi extends oe{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,oe),this.name="UnknownPacketError"}}class cs extends oe{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,oe),this.name="MalformedPacketError"}}class ja{constructor(e,r){this.tag=e,this.rawContent=r}write(){return this.rawContent}}async function El(n){switch(n){case d.publicKey.ed25519:try{const e=A.getWebCrypto(),r=await e.generateKey("Ed25519",!0,["sign","verify"]).catch((s=>{if(s.name==="OperationError"){const a=Error("Unexpected key generation issue");throw a.name="NotSupportedError",a}throw s})),t=await e.exportKey("jwk",r.privateKey),i=await e.exportKey("jwk",r.publicKey);return{A:new Uint8Array(qt(i.x)),seed:qt(t.d)}}catch(e){if(e.name!=="NotSupportedError")throw e;const{default:r}=await Promise.resolve().then((function(){return an})),t=yt(ga(n)),{publicKey:i}=r.sign.keyPair.fromSeed(t);return{A:i,seed:t}}case d.publicKey.ed448:{const e=await A.getNobleCurve(d.publicKey.ed448),{secretKey:r,publicKey:t}=e.keygen();return{A:t,seed:r}}default:throw Error("Unsupported EdDSA algorithm")}}async function Lc(n,e,r,t,i,s){if(ke(e)<ke(Aa(n)))throw Error("Hash algorithm too weak for EdDSA.");switch(n){case d.publicKey.ed25519:try{const a=A.getWebCrypto(),o=vl(n,t,i),c=await a.importKey("jwk",o,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(await a.sign("Ed25519",c,s))}}catch(a){if(a.name!=="NotSupportedError")throw a;const{default:o}=await Promise.resolve().then((function(){return an})),c=A.concatUint8Array([i,t]);return{RS:o.sign.detached(s,c)}}case d.publicKey.ed448:return{RS:(await A.getNobleCurve(d.publicKey.ed448)).sign(s,i)};default:throw Error("Unsupported EdDSA algorithm")}}async function Qc(n,e,{RS:r},t,i,s){if(ke(e)<ke(Aa(n)))throw Error("Hash algorithm too weak for EdDSA.");switch(n){case d.publicKey.ed25519:try{const a=A.getWebCrypto(),o=Fc(n,i),c=await a.importKey("jwk",o,"Ed25519",!1,["verify"]);return await a.verify("Ed25519",c,r,s)}catch(a){if(a.name!=="NotSupportedError")throw a;const{default:o}=await Promise.resolve().then((function(){return an}));return o.sign.detached.verify(s,r,i)}case d.publicKey.ed448:return(await A.getNobleCurve(d.publicKey.ed448)).verify(r,s,i);default:throw Error("Unsupported EdDSA algorithm")}}function ga(n){switch(n){case d.publicKey.ed25519:return 32;case d.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function Aa(n){switch(n){case d.publicKey.ed25519:return d.hash.sha256;case d.publicKey.ed448:return d.hash.sha512;default:throw Error("Unknown EdDSA algo")}}const Fc=(n,e)=>{if(n===d.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:Te(e),ext:!0};throw Error("Unsupported EdDSA algorithm")},vl=(n,e,r)=>{if(n===d.publicKey.ed25519){const t=Fc(n,e);return t.d=Te(r),t}throw Error("Unsupported EdDSA algorithm")};/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function Mc(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function ye(n,...e){if(!Mc(n))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw Error("Uint8Array expected of length "+e+", got length="+n.length)}function Ii(n,e=!0){if(n.destroyed)throw Error("Hash instance has been destroyed");if(e&&n.finished)throw Error("Hash#digest() has already been called")}function Gc(n,e){ye(n);const r=e.outputLen;if(n.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function wa(n){return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}function ue(n){return new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4))}function Fe(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function zi(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}const Sl=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Tn(n){if(typeof n=="string")n=(function(e){if(typeof e!="string")throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))})(n);else{if(!Mc(n))throw Error("Uint8Array expected, got "+typeof n);n=$e(n)}return n}function Hc(n,e){return n.buffer===e.buffer&&n.byteOffset<e.byteOffset+e.byteLength&&e.byteOffset<n.byteOffset+n.byteLength}function Gs(n,e){if(Hc(n,e)&&n.byteOffset<e.byteOffset)throw Error("complex overlap of input and output is not supported")}function zc(n,e){if(n.length!==e.length)return!1;let r=0;for(let t=0;t<n.length;t++)r|=n[t]^e[t];return r===0}const Gn=(n,e)=>{function r(t,...i){if(ye(t),!Sl)throw Error("Non little-endian hardware is not yet supported");if(n.nonceLength!==void 0){const u=i[0];if(!u)throw Error("nonce / iv required");n.varSizeNonce?ye(u):ye(u,n.nonceLength)}const s=n.tagLength;s&&i[1]!==void 0&&ye(i[1]);const a=e(t,...i),o=(u,h)=>{if(h!==void 0){if(u!==2)throw Error("cipher output not supported");ye(h)}};let c=!1;return{encrypt(u,h){if(c)throw Error("cannot encrypt() twice with same key + nonce");return c=!0,ye(u),o(a.encrypt.length,h),a.encrypt(u,h)},decrypt(u,h){if(ye(u),s&&u.length<s)throw Error("invalid ciphertext length: smaller than tagLength="+s);return o(a.decrypt.length,h),a.decrypt(u,h)}}}return Object.assign(r,n),r};function Rn(n,e,r=!0){if(e===void 0)return new Uint8Array(n);if(e.length!==n)throw Error("invalid output length, expected "+n+", got: "+e.length);if(r&&!ft(e))throw Error("invalid output, must be aligned");return e}function Hs(n,e,r,t){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,r,t);const i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s);n.setUint32(e+0,a,t),n.setUint32(e+4,o,t)}function ft(n){return n.byteOffset%4==0}function $e(n){return Uint8Array.from(n)}const _t=16,ma=new Uint8Array(16),Ut=ue(ma),ct=n=>(n>>>0&255)<<24|(n>>>8&255)<<16|(n>>>16&255)<<8|n>>>24&255;class _c{constructor(e,r){this.blockLen=_t,this.outputLen=_t,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,ye(e=Tn(e),16);const t=zi(e);let i=t.getUint32(0,!1),s=t.getUint32(4,!1),a=t.getUint32(8,!1),o=t.getUint32(12,!1);const c=[];for(let S=0;S<128;S++)c.push({s0:ct(i),s1:ct(s),s2:ct(a),s3:ct(o)}),{s0:i,s1:s,s2:a,s3:o}={s3:(l=a)<<31|(f=o)>>>1,s2:(h=s)<<31|l>>>1,s1:(u=i)<<31|h>>>1,s0:u>>>1^225<<24&-(1&f)};var u,h,l,f;const p=(y=r||1024)>65536?8:y>1024?4:2;var y;if(![1,2,4,8].includes(p))throw Error("ghash: invalid window size, expected 2, 4 or 8");this.W=p;const w=128/p,g=this.windowSize=2**p,m=[];for(let S=0;S<w;S++)for(let E=0;E<g;E++){let v=0,U=0,T=0,D=0;for(let I=0;I<p;I++){if(!(E>>>p-I-1&1))continue;const{s0:b,s1:k,s2:x,s3:C}=c[p*S+I];v^=b,U^=k,T^=x,D^=C}m.push({s0:v,s1:U,s2:T,s3:D})}this.t=m}_updateBlock(e,r,t,i){e^=this.s0,r^=this.s1,t^=this.s2,i^=this.s3;const{W:s,t:a,windowSize:o}=this;let c=0,u=0,h=0,l=0;const f=(1<<s)-1;let p=0;for(const y of[e,r,t,i])for(let w=0;w<4;w++){const g=y>>>8*w&255;for(let m=8/s-1;m>=0;m--){const S=g>>>s*m&f,{s0:E,s1:v,s2:U,s3:T}=a[p*o+S];c^=E,u^=v,h^=U,l^=T,p+=1}}this.s0=c,this.s1=u,this.s2=h,this.s3=l}update(e){Ii(this),ye(e=Tn(e));const r=ue(e),t=Math.floor(e.length/_t),i=e.length%_t;for(let s=0;s<t;s++)this._updateBlock(r[4*s+0],r[4*s+1],r[4*s+2],r[4*s+3]);return i&&(ma.set(e.subarray(t*_t)),this._updateBlock(Ut[0],Ut[1],Ut[2],Ut[3]),Fe(Ut)),this}destroy(){const{t:e}=this;for(const r of e)r.s0=0,r.s1=0,r.s2=0,r.s3=0}digestInto(e){Ii(this),Gc(e,this),this.finished=!0;const{s0:r,s1:t,s2:i,s3:s}=this,a=ue(e);return a[0]=r,a[1]=t,a[2]=i,a[3]=s,e}digest(){const e=new Uint8Array(_t);return this.digestInto(e),this.destroy(),e}}class xl extends _c{constructor(e,r){ye(e=Tn(e));const t=(function(i){i.reverse();const s=1&i[15];let a=0;for(let o=0;o<i.length;o++){const c=i[o];i[o]=c>>>1|a,a=(1&c)<<7}return i[0]^=225&-s,i})($e(e));super(t,r),Fe(t)}update(e){e=Tn(e),Ii(this);const r=ue(e),t=e.length%_t,i=Math.floor(e.length/_t);for(let s=0;s<i;s++)this._updateBlock(ct(r[4*s+3]),ct(r[4*s+2]),ct(r[4*s+1]),ct(r[4*s+0]));return t&&(ma.set(e.subarray(i*_t)),this._updateBlock(ct(Ut[3]),ct(Ut[2]),ct(Ut[1]),ct(Ut[0])),Fe(Ut)),this}digestInto(e){Ii(this),Gc(e,this),this.finished=!0;const{s0:r,s1:t,s2:i,s3:s}=this,a=ue(e);return a[0]=r,a[1]=t,a[2]=i,a[3]=s,e.reverse()}}function Vc(n){const e=(t,i)=>n(i,t.length).update(Tn(t)).digest(),r=n(new Uint8Array(16),0);return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=(t,i)=>n(t,i),e}const qa=Vc(((n,e)=>new _c(n,e)));Vc(((n,e)=>new xl(n,e)));const nt=16,qn=new Uint8Array(nt);function ba(n){return n<<1^283&-(n>>7)}function zr(n,e){let r=0;for(;e>0;e>>=1)r^=n&-(1&e),n=ba(n);return r}const zs=(()=>{const n=new Uint8Array(256);for(let r=0,t=1;r<256;r++,t^=ba(t))n[r]=t;const e=new Uint8Array(256);e[0]=99;for(let r=0;r<255;r++){let t=n[255-r];t|=t<<8,e[n[r]]=255&(t^t>>4^t>>5^t>>6^t>>7^99)}return Fe(n),e})(),Il=zs.map(((n,e)=>zs.indexOf(e))),ls=n=>n<<8|n>>>24,Ya=n=>n<<24&4278190080|n<<8&16711680|n>>>8&65280|n>>>24&255;function Wc(n,e){if(n.length!==256)throw Error("Wrong sbox length");const r=new Uint32Array(256).map(((u,h)=>e(n[h]))),t=r.map(ls),i=t.map(ls),s=i.map(ls),a=new Uint32Array(65536),o=new Uint32Array(65536),c=new Uint16Array(65536);for(let u=0;u<256;u++)for(let h=0;h<256;h++){const l=256*u+h;a[l]=r[u]^t[h],o[l]=i[u]^s[h],c[l]=n[u]<<8|n[h]}return{sbox:n,sbox2:c,T0:r,T1:t,T2:i,T3:s,T01:a,T23:o}}const Ea=Wc(zs,(n=>zr(n,3)<<24|n<<16|n<<8|zr(n,2))),jc=Wc(Il,(n=>zr(n,11)<<24|zr(n,13)<<16|zr(n,9)<<8|zr(n,14))),Cl=(()=>{const n=new Uint8Array(16);for(let e=0,r=1;e<16;e++,r=ba(r))n[e]=r;return n})();function Kr(n){ye(n);const e=n.length;if(![16,24,32].includes(e))throw Error("aes: invalid key size, should be 16, 24 or 32, got "+e);const{sbox2:r}=Ea,t=[];ft(n)||t.push(n=$e(n));const i=ue(n),s=i.length,a=u=>Pt(r,u,u,u,u),o=new Uint32Array(e+28);o.set(i);for(let u=s;u<o.length;u++){let h=o[u-1];u%s==0?h=a((c=h)<<24|c>>>8)^Cl[u/s-1]:s>6&&u%s==4&&(h=a(h)),o[u]=o[u-s]^h}var c;return Fe(...t),o}function va(n){const e=Kr(n),r=e.slice(),t=e.length,{sbox2:i}=Ea,{T0:s,T1:a,T2:o,T3:c}=jc;for(let u=0;u<t;u+=4)for(let h=0;h<4;h++)r[u+h]=e[t-u-4+h];Fe(e);for(let u=4;u<t-4;u++){const h=r[u],l=Pt(i,h,h,h,h);r[u]=s[255&l]^a[l>>>8&255]^o[l>>>16&255]^c[l>>>24]}return r}function cr(n,e,r,t,i,s){return n[r<<8&65280|t>>>8&255]^e[i>>>8&65280|s>>>24&255]}function Pt(n,e,r,t,i){return n[255&e|65280&r]|n[t>>>16&255|i>>>16&65280]<<16}function vt(n,e,r,t,i){const{sbox2:s,T01:a,T23:o}=Ea;let c=0;e^=n[c++],r^=n[c++],t^=n[c++],i^=n[c++];const u=n.length/4-2;for(let h=0;h<u;h++){const l=n[c++]^cr(a,o,e,r,t,i),f=n[c++]^cr(a,o,r,t,i,e),p=n[c++]^cr(a,o,t,i,e,r),y=n[c++]^cr(a,o,i,e,r,t);e=l,r=f,t=p,i=y}return{s0:n[c++]^Pt(s,e,r,t,i),s1:n[c++]^Pt(s,r,t,i,e),s2:n[c++]^Pt(s,t,i,e,r),s3:n[c++]^Pt(s,i,e,r,t)}}function _i(n,e,r,t,i){const{sbox2:s,T01:a,T23:o}=jc;let c=0;e^=n[c++],r^=n[c++],t^=n[c++],i^=n[c++];const u=n.length/4-2;for(let h=0;h<u;h++){const l=n[c++]^cr(a,o,e,i,t,r),f=n[c++]^cr(a,o,r,e,i,t),p=n[c++]^cr(a,o,t,r,e,i),y=n[c++]^cr(a,o,i,t,r,e);e=l,r=f,t=p,i=y}return{s0:n[c++]^Pt(s,e,i,t,r),s1:n[c++]^Pt(s,r,e,i,t),s2:n[c++]^Pt(s,t,r,e,i),s3:n[c++]^Pt(s,i,t,r,e)}}function qc(n,e,r,t){ye(e,nt),ye(r);const i=r.length;Gs(r,t=Rn(i,t));const s=e,a=ue(s);let{s0:o,s1:c,s2:u,s3:h}=vt(n,a[0],a[1],a[2],a[3]);const l=ue(r),f=ue(t);for(let y=0;y+4<=l.length;y+=4){f[y+0]=l[y+0]^o,f[y+1]=l[y+1]^c,f[y+2]=l[y+2]^u,f[y+3]=l[y+3]^h;let w=1;for(let g=s.length-1;g>=0;g--)w=w+(255&s[g])|0,s[g]=255&w,w>>>=8;({s0:o,s1:c,s2:u,s3:h}=vt(n,a[0],a[1],a[2],a[3]))}const p=nt*Math.floor(l.length/4);if(p<i){const y=new Uint32Array([o,c,u,h]),w=wa(y);for(let g=p,m=0;g<i;g++,m++)t[g]=r[g]^w[m];Fe(y)}return t}function bn(n,e,r,t,i){ye(r,nt),ye(t),i=Rn(t.length,i);const s=r,a=ue(s),o=zi(s),c=ue(t),u=ue(i),h=e?0:12,l=t.length;let f=o.getUint32(h,e),{s0:p,s1:y,s2:w,s3:g}=vt(n,a[0],a[1],a[2],a[3]);for(let S=0;S+4<=c.length;S+=4)u[S+0]=c[S+0]^p,u[S+1]=c[S+1]^y,u[S+2]=c[S+2]^w,u[S+3]=c[S+3]^g,f=f+1>>>0,o.setUint32(h,f,e),{s0:p,s1:y,s2:w,s3:g}=vt(n,a[0],a[1],a[2],a[3]);const m=nt*Math.floor(c.length/4);if(m<l){const S=new Uint32Array([p,y,w,g]),E=wa(S);for(let v=m,U=0;v<l;v++,U++)i[v]=t[v]^E[U];Fe(S)}return i}const kl=Gn({blockSize:16,nonceLength:16},(function(n,e){function r(t,i){if(ye(t),i!==void 0&&(ye(i),!ft(i)))throw Error("unaligned destination");const s=Kr(n),a=$e(e),o=[s,a];ft(t)||o.push(t=$e(t));const c=qc(s,a,t,i);return Fe(...o),c}return{encrypt:(t,i)=>r(t,i),decrypt:(t,i)=>r(t,i)}})),_s=Gn({blockSize:16,nonceLength:16},(function(n,e,r={}){const t=!r.disablePadding;return{encrypt(i,s){const a=Kr(n),{b:o,o:c,out:u}=(function(S,E,v){ye(S);let U=S.length;const T=U%nt;if(!E&&T!==0)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");ft(S)||(S=$e(S));const D=ue(S);if(E){let I=nt-T;I||(I=nt),U+=I}return Gs(S,v=Rn(U,v)),{b:D,o:ue(v),out:v}})(i,t,s);let h=e;const l=[a];ft(h)||l.push(h=$e(h));const f=ue(h);let p=f[0],y=f[1],w=f[2],g=f[3],m=0;for(;m+4<=o.length;)p^=o[m+0],y^=o[m+1],w^=o[m+2],g^=o[m+3],{s0:p,s1:y,s2:w,s3:g}=vt(a,p,y,w,g),c[m++]=p,c[m++]=y,c[m++]=w,c[m++]=g;if(t){const S=(function(E){const v=new Uint8Array(16),U=ue(v);v.set(E);const T=nt-E.length;for(let D=nt-T;D<nt;D++)v[D]=T;return U})(i.subarray(4*m));p^=S[0],y^=S[1],w^=S[2],g^=S[3],{s0:p,s1:y,s2:w,s3:g}=vt(a,p,y,w,g),c[m++]=p,c[m++]=y,c[m++]=w,c[m++]=g}return Fe(...l),u},decrypt(i,s){(function(g){if(ye(g),g.length%nt!=0)throw Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size 16")})(i);const a=va(n);let o=e;const c=[a];ft(o)||c.push(o=$e(o));const u=ue(o);s=Rn(i.length,s),ft(i)||c.push(i=$e(i)),Gs(i,s);const h=ue(i),l=ue(s);let f=u[0],p=u[1],y=u[2],w=u[3];for(let g=0;g+4<=h.length;){const m=f,S=p,E=y,v=w;f=h[g+0],p=h[g+1],y=h[g+2],w=h[g+3];const{s0:U,s1:T,s2:D,s3:I}=_i(a,f,p,y,w);l[g++]=U^m,l[g++]=T^S,l[g++]=D^E,l[g++]=I^v}return Fe(...c),(function(g,m){if(!m)return g;const S=g.length;if(!S)throw Error("aes/pcks5: empty ciphertext not allowed");const E=g[S-1];if(E<=0||E>16)throw Error("aes/pcks5: wrong padding");const v=g.subarray(0,-E);for(let U=0;U<E;U++)if(g[S-U-1]!==E)throw Error("aes/pcks5: wrong padding");return v})(s,t)}}})),Yc=Gn({blockSize:16,nonceLength:16},(function(n,e){function r(t,i,s){ye(t);const a=t.length;if(Hc(t,s=Rn(a,s)))throw Error("overlapping src and dst not supported.");const o=Kr(n);let c=e;const u=[o];ft(c)||u.push(c=$e(c)),ft(t)||u.push(t=$e(t));const h=ue(t),l=ue(s),f=i?l:h,p=ue(c);let y=p[0],w=p[1],g=p[2],m=p[3];for(let E=0;E+4<=h.length;){const{s0:v,s1:U,s2:T,s3:D}=vt(o,y,w,g,m);l[E+0]=h[E+0]^v,l[E+1]=h[E+1]^U,l[E+2]=h[E+2]^T,l[E+3]=h[E+3]^D,y=f[E++],w=f[E++],g=f[E++],m=f[E++]}const S=nt*Math.floor(h.length/4);if(S<a){({s0:y,s1:w,s2:g,s3:m}=vt(o,y,w,g,m));const E=wa(new Uint32Array([y,w,g,m]));for(let v=S,U=0;v<a;v++,U++)s[v]=t[v]^E[U];Fe(E)}return Fe(...u),s}return{encrypt:(t,i)=>r(t,!0,i),decrypt:(t,i)=>r(t,!1,i)}}));function Bl(n,e,r,t,i){const s=i?i.length:0,a=n.create(r,t.length+s);i&&a.update(i);const o=(function(u,h,l){const f=new Uint8Array(16),p=zi(f);return Hs(p,0,BigInt(h),l),Hs(p,8,BigInt(u),l),f})(8*t.length,8*s,e);a.update(t),a.update(o);const c=a.digest();return Fe(o),c}const Yn=Gn({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},(function(n,e,r){if(e.length<8)throw Error("aes/gcm: invalid nonce length");function t(s,a,o){const c=Bl(qa,!1,s,o,r);for(let u=0;u<a.length;u++)c[u]^=a[u];return c}function i(){const s=Kr(n),a=qn.slice(),o=qn.slice();if(bn(s,!1,o,o,a),e.length===12)o.set(e);else{const c=qn.slice();Hs(zi(c),8,BigInt(8*e.length),!1);const u=qa.create(a).update(e).update(c);u.digestInto(o),u.destroy()}return{xk:s,authKey:a,counter:o,tagMask:bn(s,!1,o,qn)}}return{encrypt(s){const{xk:a,authKey:o,counter:c,tagMask:u}=i(),h=new Uint8Array(s.length+16),l=[a,o,c,u];ft(s)||l.push(s=$e(s)),bn(a,!1,c,s,h.subarray(0,s.length));const f=t(o,u,h.subarray(0,h.length-16));return l.push(f),h.set(f,s.length),Fe(...l),h},decrypt(s){const{xk:a,authKey:o,counter:c,tagMask:u}=i(),h=[a,o,u,c];ft(s)||h.push(s=$e(s));const l=s.subarray(0,-16),f=s.subarray(-16),p=t(o,u,l);if(h.push(p),!zc(p,f))throw Error("aes/gcm: invalid ghash tag");const y=bn(a,!1,c,l);return Fe(...h),y}}}));function Jc(n){return n instanceof Uint32Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint32Array"}function $c(n,e){if(ye(e,16),!Jc(n))throw Error("_encryptBlock accepts result of expandKeyLE");const r=ue(e);let{s0:t,s1:i,s2:s,s3:a}=vt(n,r[0],r[1],r[2],r[3]);return r[0]=t,r[1]=i,r[2]=s,r[3]=a,e}function Zc(n,e){if(ye(e,16),!Jc(n))throw Error("_decryptBlock accepts result of expandKeyLE");const r=ue(e);let{s0:t,s1:i,s2:s,s3:a}=_i(n,r[0],r[1],r[2],r[3]);return r[0]=t,r[1]=i,r[2]=s,r[3]=a,e}const Ja={encrypt(n,e){if(e.length>=2**32)throw Error("plaintext should be less than 4gb");const r=Kr(n);if(e.length===16)$c(r,e);else{const t=ue(e);let i=t[0],s=t[1];for(let a=0,o=1;a<6;a++)for(let c=2;c<t.length;c+=2,o++){const{s0:u,s1:h,s2:l,s3:f}=vt(r,i,s,t[c],t[c+1]);i=u,s=h^Ya(o),t[c]=l,t[c+1]=f}t[0]=i,t[1]=s}r.fill(0)},decrypt(n,e){if(e.length-8>=2**32)throw Error("ciphertext should be less than 4gb");const r=va(n),t=e.length/8-1;if(t===1)Zc(r,e);else{const i=ue(e);let s=i[0],a=i[1];for(let o=0,c=6*t;o<6;o++)for(let u=2*t;u>=1;u-=2,c--){a^=Ya(c);const{s0:h,s1:l,s2:f,s3:p}=_i(r,s,a,i[u],i[u+1]);s=h,a=l,i[u]=f,i[u+1]=p}i[0]=s,i[1]=a}r.fill(0)}},$a=new Uint8Array(8).fill(166),Xc=Gn({blockSize:8},(n=>({encrypt(e){if(!e.length||e.length%8!=0)throw Error("invalid plaintext length");if(e.length===8)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");const r=(function(...t){let i=0;for(let a=0;a<t.length;a++){const o=t[a];ye(o),i+=o.length}const s=new Uint8Array(i);for(let a=0,o=0;a<t.length;a++){const c=t[a];s.set(c,o),o+=c.length}return s})($a,e);return Ja.encrypt(n,r),r},decrypt(e){if(e.length%8!=0||e.length<24)throw Error("invalid ciphertext length");const r=$e(e);if(Ja.decrypt(n,r),!zc(r.subarray(0,8),$a))throw Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8)}}))),Za={expandKeyLE:Kr,expandKeyDecLE:va,encrypt:vt,decrypt:_i,encryptBlock:$c,decryptBlock:Zc,ctrCounter:qc,ctr32:bn};async function e1(n){switch(n){case d.symmetric.aes128:case d.symmetric.aes192:case d.symmetric.aes256:throw Error("Not a legacy cipher");case d.symmetric.cast5:case d.symmetric.blowfish:case d.symmetric.twofish:case d.symmetric.tripledes:{const{legacyCiphers:e}=await Promise.resolve().then((function(){return Sh})),r=d.read(d.symmetric,n),t=e.get(r);if(!t)throw Error("Unsupported cipher algorithm");return t}default:throw Error("Unsupported cipher algorithm")}}function Ul(n){switch(n){case d.symmetric.aes128:case d.symmetric.aes192:case d.symmetric.aes256:case d.symmetric.twofish:return 16;case d.symmetric.blowfish:case d.symmetric.cast5:case d.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}function Dl(n){switch(n){case d.symmetric.aes128:case d.symmetric.blowfish:case d.symmetric.cast5:return 16;case d.symmetric.aes192:case d.symmetric.tripledes:return 24;case d.symmetric.aes256:case d.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}function ge(n){return{keySize:Dl(n),blockSize:Ul(n)}}const Jr=A.getWebCrypto();async function Vs(n,e,r){const{keySize:t}=ge(n);if(!A.isAES(n)||e.length!==t)throw Error("Unexpected algorithm or key size");try{const i=await Jr.importKey("raw",e,{name:"AES-KW"},!1,["wrapKey"]),s=await Jr.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),a=await Jr.wrapKey("raw",s,i,{name:"AES-KW"});return new Uint8Array(a)}catch(i){if(i.name!=="NotSupportedError"&&(e.length!==24||i.name!=="OperationError"))throw i;A.printDebugError("Browser did not support operation: "+i.message)}return Xc(e).encrypt(r)}async function Ws(n,e,r){const{keySize:t}=ge(n);if(!A.isAES(n)||e.length!==t)throw Error("Unexpected algorithm or key size");let i;try{i=await Jr.importKey("raw",e,{name:"AES-KW"},!1,["unwrapKey"])}catch(s){if(s.name!=="NotSupportedError"&&(e.length!==24||s.name!=="OperationError"))throw s;return A.printDebugError("Browser did not support operation: "+s.message),Xc(e).decrypt(r)}try{const s=await Jr.unwrapKey("raw",r,i,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(await Jr.exportKey("raw",s))}catch(s){throw s.name==="OperationError"?Error("Key Data Integrity failed"):s}}async function Br(n,e,r,t,i){const s=A.getWebCrypto(),a=d.read(d.webHash,n);if(!a)throw Error("Hash algo not supported with HKDF");const o=await s.importKey("raw",e,"HKDF",!1,["deriveBits"]),c=await s.deriveBits({name:"HKDF",hash:a,salt:r,info:t},o,8*i);return new Uint8Array(c)}const Ci={x25519:A.encodeUTF8("OpenPGP X25519"),x448:A.encodeUTF8("OpenPGP X448")};async function Pl(n){switch(n){case d.publicKey.x25519:try{const e=A.getWebCrypto(),r=await e.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch((s=>{if(s.name==="OperationError"){const a=Error("Unexpected key generation issue");throw a.name="NotSupportedError",a}throw s})),t=await e.exportKey("jwk",r.privateKey),i=await e.exportKey("jwk",r.publicKey);if(t.x!==i.x){const s=Error("Unexpected mismatching public point");throw s.name="NotSupportedError",s}return{A:new Uint8Array(qt(i.x)),k:qt(t.d)}}catch(e){if(e.name!=="NotSupportedError")throw e;const{default:r}=await Promise.resolve().then((function(){return an})),{secretKey:t,publicKey:i}=r.box.keyPair();return{A:i,k:t}}case d.publicKey.x448:{const e=await A.getNobleCurve(d.publicKey.x448),{secretKey:r,publicKey:t}=e.keygen();return{A:t,k:r}}default:throw Error("Unsupported ECDH algorithm")}}async function Kl(n,e,r){const{ephemeralPublicKey:t,sharedSecret:i}=await t1(n,r),s=A.concatUint8Array([t,r,i]);switch(n){case d.publicKey.x25519:{const a=d.symmetric.aes128,{keySize:o}=ge(a),c=await Br(d.hash.sha256,s,new Uint8Array,Ci.x25519,o);return{ephemeralPublicKey:t,wrappedKey:await Vs(a,c,e)}}case d.publicKey.x448:{const a=d.symmetric.aes256,{keySize:o}=ge(d.symmetric.aes256),c=await Br(d.hash.sha512,s,new Uint8Array,Ci.x448,o);return{ephemeralPublicKey:t,wrappedKey:await Vs(a,c,e)}}default:throw Error("Unsupported ECDH algorithm")}}async function Tl(n,e,r,t,i){const s=await r1(n,e,t,i),a=A.concatUint8Array([e,t,s]);switch(n){case d.publicKey.x25519:{const o=d.symmetric.aes128,{keySize:c}=ge(o);return Ws(o,await Br(d.hash.sha256,a,new Uint8Array,Ci.x25519,c),r)}case d.publicKey.x448:{const o=d.symmetric.aes256,{keySize:c}=ge(d.symmetric.aes256);return Ws(o,await Br(d.hash.sha512,a,new Uint8Array,Ci.x448,c),r)}default:throw Error("Unsupported ECDH algorithm")}}function Sa(n){switch(n){case d.publicKey.x25519:return 32;case d.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}async function t1(n,e){switch(n){case d.publicKey.x25519:try{const r=A.getWebCrypto(),t=await r.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch((c=>{if(c.name==="OperationError"){const u=Error("Unexpected key generation issue");throw u.name="NotSupportedError",u}throw c})),i=await r.exportKey("jwk",t.publicKey);if((await r.exportKey("jwk",t.privateKey)).x!==i.x){const c=Error("Unexpected mismatching public point");throw c.name="NotSupportedError",c}const s=js(n,e),a=await r.importKey("jwk",s,"X25519",!1,[]),o=await r.deriveBits({name:"X25519",public:a},t.privateKey,8*Sa(n));return{sharedSecret:new Uint8Array(o),ephemeralPublicKey:new Uint8Array(qt(i.x))}}catch(r){if(r.name!=="NotSupportedError")throw r;const{default:t}=await Promise.resolve().then((function(){return an})),{secretKey:i,publicKey:s}=t.box.keyPair(),a=t.scalarMult(i,e);return ki(a),{ephemeralPublicKey:s,sharedSecret:a}}case d.publicKey.x448:{const r=await A.getNobleCurve(d.publicKey.x448),{secretKey:t,publicKey:i}=r.keygen(),s=r.getSharedSecret(t,e);return ki(s),{ephemeralPublicKey:i,sharedSecret:s}}default:throw Error("Unsupported ECDH algorithm")}}async function r1(n,e,r,t){switch(n){case d.publicKey.x25519:try{const i=A.getWebCrypto(),s=(function(h,l,f){if(h===d.publicKey.x25519){const p=js(h,l);return p.d=Te(f),p}throw Error("Unsupported ECDH algorithm")})(n,r,t),a=js(n,e),o=await i.importKey("jwk",s,"X25519",!1,["deriveKey","deriveBits"]),c=await i.importKey("jwk",a,"X25519",!1,[]),u=await i.deriveBits({name:"X25519",public:c},o,8*Sa(n));return new Uint8Array(u)}catch(i){if(i.name!=="NotSupportedError")throw i;const{default:s}=await Promise.resolve().then((function(){return an})),a=s.scalarMult(t,e);return ki(a),a}case d.publicKey.x448:{const i=(await A.getNobleCurve(d.publicKey.x448)).getSharedSecret(t,e);return ki(i),i}default:throw Error("Unsupported ECDH algorithm")}}function ki(n){let e=0;for(let r=0;r<n.length;r++)e|=n[r];if(e===0)throw Error("Unexpected low order point")}function js(n,e){if(n===d.publicKey.x25519)return{kty:"OKP",crv:"X25519",x:Te(e),ext:!0};throw Error("Unsupported ECDH algorithm")}const us=A.getWebCrypto(),Bi=A.getNodeCrypto(),Rt={[d.curve.nistP256]:"P-256",[d.curve.nistP384]:"P-384",[d.curve.nistP521]:"P-521"},Qt=Bi?Bi.getCurves():[],Bt=Bi?{[d.curve.secp256k1]:Qt.includes("secp256k1")?"secp256k1":void 0,[d.curve.nistP256]:Qt.includes("prime256v1")?"prime256v1":void 0,[d.curve.nistP384]:Qt.includes("secp384r1")?"secp384r1":void 0,[d.curve.nistP521]:Qt.includes("secp521r1")?"secp521r1":void 0,[d.curve.ed25519Legacy]:Qt.includes("ED25519")?"ED25519":void 0,[d.curve.curve25519Legacy]:Qt.includes("X25519")?"X25519":void 0,[d.curve.brainpoolP256r1]:Qt.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[d.curve.brainpoolP384r1]:Qt.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[d.curve.brainpoolP512r1]:Qt.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},n1={[d.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:d.publicKey.ecdsa,hash:d.hash.sha256,cipher:d.symmetric.aes128,node:Bt[d.curve.nistP256],web:Rt[d.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[d.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:d.publicKey.ecdsa,hash:d.hash.sha384,cipher:d.symmetric.aes192,node:Bt[d.curve.nistP384],web:Rt[d.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[d.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:d.publicKey.ecdsa,hash:d.hash.sha512,cipher:d.symmetric.aes256,node:Bt[d.curve.nistP521],web:Rt[d.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[d.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:d.publicKey.ecdsa,hash:d.hash.sha256,cipher:d.symmetric.aes128,node:Bt[d.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[d.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:d.publicKey.eddsaLegacy,hash:d.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[d.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:d.publicKey.ecdh,hash:d.hash.sha256,cipher:d.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[d.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:d.publicKey.ecdsa,hash:d.hash.sha256,cipher:d.symmetric.aes128,node:Bt[d.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[d.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:d.publicKey.ecdsa,hash:d.hash.sha384,cipher:d.symmetric.aes192,node:Bt[d.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[d.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:d.publicKey.ecdsa,hash:d.hash.sha512,cipher:d.symmetric.aes256,node:Bt[d.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}};class Yt{constructor(e){try{this.name=e instanceof Yr?e.getName():d.write(d.curve,e)}catch{throw new oe("Unknown curve")}const r=n1[this.name];this.keyType=r.keyType,this.oid=r.oid,this.hash=r.hash,this.cipher=r.cipher,this.node=r.node,this.web=r.web,this.payloadSize=r.payloadSize,this.sharedSize=r.sharedSize,this.wireFormatLeadingByte=r.wireFormatLeadingByte,this.web&&A.getWebCrypto()?this.type="web":this.node&&A.getNodeCrypto()?this.type="node":this.name===d.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===d.curve.ed25519Legacy&&(this.type="ed25519Legacy")}async genKeyPair(){switch(this.type){case"web":try{return await(async function(e,r){const t=await us.generateKey({name:"ECDSA",namedCurve:Rt[e]},!0,["sign","verify"]),i=await us.exportKey("jwk",t.privateKey);return{publicKey:i1(await us.exportKey("jwk",t.publicKey),r),privateKey:qt(i.d)}})(this.name,this.wireFormatLeadingByte)}catch(e){return A.printDebugError("Browser did not support generating ec key "+e.message),Xa(this.name)}case"node":return(async function(e){const r=Bi.createECDH(Bt[e]);return await r.generateKeys(),{publicKey:new Uint8Array(r.getPublicKey()),privateKey:new Uint8Array(r.getPrivateKey())}})(this.name);case"curve25519Legacy":{const{k:e,A:r}=await Pl(d.publicKey.x25519),t=e.slice().reverse();return t[0]=127&t[0]|64,t[31]&=248,{publicKey:A.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),r]),privateKey:t}}case"ed25519Legacy":{const{seed:e,A:r}=await El(d.publicKey.ed25519);return{publicKey:A.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),r]),privateKey:e}}default:return Xa(this.name)}}}function Rl(n){return n1[n.getName()].hash}function Ur(n,e){const{payloadSize:r,wireFormatLeadingByte:t,name:i}=n,s=i===d.curve.curve25519Legacy||i===d.curve.ed25519Legacy?r:2*r;if(e[0]!==t||e.length!==s+1)throw Error("Invalid point encoding")}async function Xa(n){const e=await A.getNobleCurve(d.publicKey.ecdsa,n),{secretKey:r}=e.keygen();return{publicKey:e.getPublicKey(r,!1),privateKey:r}}function i1(n,e){const r=qt(n.x),t=qt(n.y),i=new Uint8Array(r.length+t.length+1);return i[0]=e,i.set(r,1),i.set(t,r.length+1),i}function Vi(n,e,r){const t=n,i=r.slice(1,t+1),s=r.slice(t+1,2*t+1);return{kty:"EC",crv:e,x:Te(i),y:Te(s),ext:!0}}function s1(n,e,r,t){const i=Vi(n,e,r);return i.d=Te(t),i}const Ui=A.getWebCrypto(),a1=A.getNodeCrypto();async function Nl(n,e,r,t,i,s){const a=new Yt(n);if(Ur(a,t),r&&!A.isStream(r)){const c={publicKey:t,privateKey:i};switch(a.type){case"web":try{return await(async function(u,h,l,f){const p=u.payloadSize,y=s1(u.payloadSize,Rt[u.name],f.publicKey,f.privateKey),w=await Ui.importKey("jwk",y,{name:"ECDSA",namedCurve:Rt[u.name],hash:{name:d.read(d.webHash,u.hash)}},!1,["sign"]),g=new Uint8Array(await Ui.sign({name:"ECDSA",namedCurve:Rt[u.name],hash:{name:d.read(d.webHash,h)}},w,l));return{r:g.slice(0,p),s:g.slice(p,p<<1)}})(a,e,r,c)}catch(u){if(a.name!=="nistP521"&&(u.name==="DataError"||u.name==="OperationError"))throw u;A.printDebugError("Browser did not support signing: "+u.message)}break;case"node":return(async function(u,h,l,f){const p=A.nodeRequire("eckey-utils"),y=A.getNodeBuffer(),{privateKey:w}=p.generateDer({curveName:Bt[u.name],privateKey:y.from(f)}),g=a1.createSign(d.read(d.hash,h));g.write(l),g.end();const m=new Uint8Array(g.sign({key:w,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),S=u.payloadSize;return{r:m.subarray(0,S),s:m.subarray(S,S<<1)}})(a,e,r,i)}}const o=(await A.getNobleCurve(d.publicKey.ecdsa,a.name)).sign(s,i,{lowS:!1});return{r:at(o.r,"be",a.payloadSize),s:at(o.s,"be",a.payloadSize)}}async function Ol(n,e,r,t,i,s){const a=new Yt(n);Ur(a,i);const o=async()=>s[0]===0&&eo(a,r,s.subarray(1),i);if(t&&!A.isStream(t))switch(a.type){case"web":try{return await(async function(u,h,{r:l,s:f},p,y){const w=Vi(u.payloadSize,Rt[u.name],y),g=await Ui.importKey("jwk",w,{name:"ECDSA",namedCurve:Rt[u.name],hash:{name:d.read(d.webHash,u.hash)}},!1,["verify"]),m=A.concatUint8Array([l,f]).buffer;return Ui.verify({name:"ECDSA",namedCurve:Rt[u.name],hash:{name:d.read(d.webHash,h)}},g,m,p)})(a,e,r,t,i)||o()}catch(c){if(a.name!=="nistP521"&&(c.name==="DataError"||c.name==="OperationError"))throw c;A.printDebugError("Browser did not support verifying: "+c.message)}break;case"node":return await(async function(u,h,{r:l,s:f},p,y){const w=A.nodeRequire("eckey-utils"),g=A.getNodeBuffer(),{publicKey:m}=w.generateDer({curveName:Bt[u.name],publicKey:g.from(y)}),S=a1.createVerify(d.read(d.hash,h));S.write(p),S.end();const E=A.concatUint8Array([l,f]);try{return S.verify({key:m,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},E)}catch{return!1}})(a,e,r,t,i)||o()}return await eo(a,r,s,i)||o()}async function eo(n,e,r,t){return(await A.getNobleCurve(d.publicKey.ecdsa,n.name)).verify(A.concatUint8Array([e.r,e.s]),r,t,{lowS:!1})}async function Ll(n,e,r,t,i,s){if(Ur(new Yt(n),t),ke(e)<ke(d.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const{RS:a}=await Lc(d.publicKey.ed25519,e,0,t.subarray(1),i,s);return{r:a.subarray(0,32),s:a.subarray(32)}}async function Ql(n,e,{r,s:t},i,s,a){if(Ur(new Yt(n),s),ke(e)<ke(d.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const o=A.concatUint8Array([r,t]);return Qc(d.publicKey.ed25519,e,{RS:o},0,s.subarray(1),a)}function Fl(n){const e=n.length;if(e>0){const r=n[e-1];if(r>=1){const t=n.subarray(e-r),i=new Uint8Array(r).fill(r);if(A.equalsUint8Array(t,i))return n.subarray(0,e-r)}}throw Error("Invalid padding")}function o1(n,e,r,t){return A.concatUint8Array([e.write(),new Uint8Array([n]),r.write(),A.stringToUint8Array("Anonymous Sender    "),t])}async function c1(n,e,r,t,i=!1,s=!1){let a;if(i){for(a=0;a<e.length&&e[a]===0;a++);e=e.subarray(a)}if(s){for(a=e.length-1;a>=0&&e[a]===0;a--);e=e.subarray(0,a+1)}return(await kr(n,A.concatUint8Array([new Uint8Array([0,0,0,1]),e,t]))).subarray(0,r)}async function Ml(n,e){switch(n.type){case"curve25519Legacy":{const{sharedSecret:r,ephemeralPublicKey:t}=await t1(d.publicKey.x25519,e.subarray(1));return{publicKey:A.concatUint8Array([new Uint8Array([n.wireFormatLeadingByte]),t]),sharedKey:r}}case"web":if(n.web&&A.getWebCrypto())try{return await(async function(r,t){const i=A.getWebCrypto(),s=Vi(r.payloadSize,r.web,t);let a=i.generateKey({name:"ECDH",namedCurve:r.web},!0,["deriveKey","deriveBits"]),o=i.importKey("jwk",s,{name:"ECDH",namedCurve:r.web},!1,[]);[a,o]=await Promise.all([a,o]);let c=i.deriveBits({name:"ECDH",namedCurve:r.web,public:o},a.privateKey,r.sharedSize),u=i.exportKey("jwk",a.publicKey);[c,u]=await Promise.all([c,u]);const h=new Uint8Array(c);return{publicKey:new Uint8Array(i1(u,r.wireFormatLeadingByte)),sharedKey:h}})(n,e)}catch(r){return A.printDebugError(r),ro(n,e)}break;case"node":return(async function(r,t){const i=A.getNodeCrypto(),s=i.createECDH(r.node);s.generateKeys();const a=new Uint8Array(s.computeSecret(t));return{publicKey:new Uint8Array(s.getPublicKey()),sharedKey:a}})(n,e);default:return ro(n,e)}}async function Gl(n,e,r,t,i){const s=(function(f){const p=8-f.length%8,y=new Uint8Array(f.length+p).fill(p);return y.set(f),y})(r),a=new Yt(n);Ur(a,t);const{publicKey:o,sharedKey:c}=await Ml(a,t),u=o1(d.publicKey.ecdh,n,e,i),{keySize:h}=ge(e.cipher),l=await c1(e.hash,c,h,u);return{publicKey:o,wrappedKey:await Vs(e.cipher,l,s)}}async function Hl(n,e,r,t){if(t.length!==n.payloadSize){const i=new Uint8Array(n.payloadSize);i.set(t,n.payloadSize-t.length),t=i}switch(n.type){case"curve25519Legacy":{const i=t.slice().reverse();return{secretKey:i,sharedKey:await r1(d.publicKey.x25519,e.subarray(1),r.subarray(1),i)}}case"web":if(n.web&&A.getWebCrypto())try{return await(async function(i,s,a,o){const c=A.getWebCrypto(),u=s1(i.payloadSize,i.web,a,o);let h=c.importKey("jwk",u,{name:"ECDH",namedCurve:i.web},!0,["deriveKey","deriveBits"]);const l=Vi(i.payloadSize,i.web,s);let f=c.importKey("jwk",l,{name:"ECDH",namedCurve:i.web},!0,[]);[h,f]=await Promise.all([h,f]);let p=c.deriveBits({name:"ECDH",namedCurve:i.web,public:f},h,i.sharedSize),y=c.exportKey("jwk",h);[p,y]=await Promise.all([p,y]);const w=new Uint8Array(p);return{secretKey:qt(y.d),sharedKey:w}})(n,e,r,t)}catch(i){return A.printDebugError(i),to(n,e,t)}break;case"node":return(async function(i,s,a){const o=A.getNodeCrypto(),c=o.createECDH(i.node);c.setPrivateKey(a);const u=new Uint8Array(c.computeSecret(s));return{secretKey:new Uint8Array(c.getPrivateKey()),sharedKey:u}})(n,e,t);default:return to(n,e,t)}}async function zl(n,e,r,t,i,s,a){const o=new Yt(n);Ur(o,i),Ur(o,r);const{sharedKey:c}=await Hl(o,r,i,s),u=o1(d.publicKey.ecdh,n,e,a),{keySize:h}=ge(e.cipher);let l;for(let f=0;f<3;f++)try{const p=await c1(e.hash,c,h,u,f===1,f===2);return Fl(await Ws(e.cipher,p,t))}catch(p){l=p}throw l}async function to(n,e,r){return{secretKey:r,sharedKey:(await A.getNobleCurve(d.publicKey.ecdh,n.name)).getSharedSecret(r,e).subarray(1)}}async function ro(n,e){const r=await A.getNobleCurve(d.publicKey.ecdh,n.name),{publicKey:t,privateKey:i}=await n.genKeyPair();return{publicKey:t,sharedKey:r.getSharedSecret(i,e).subarray(1)}}const hs=BigInt(0),_l=BigInt(1);class l1{constructor(e){e&&(this.data=e)}read(e){if(e.length>=1){const r=e[0];if(e.length>=1+r)return this.data=e.subarray(1,1+r),1+this.data.length}throw Error("Invalid symmetric key")}write(){return A.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class Vl{constructor(e){if(e){const{hash:r,cipher:t}=e;this.hash=r,this.cipher=t}else this.hash=null,this.cipher=null}read(e){if(e.length<4||e[0]!==3||e[1]!==1)throw new oe("Cannot read KDFParams");return this.hash=e[2],this.cipher=e[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}class Wi{static fromObject({wrappedKey:e,algorithm:r}){const t=new Wi;return t.wrappedKey=e,t.algorithm=r,t}read(e){let r=0,t=e[r++];this.algorithm=t%2?e[r++]:null,t-=t%2,this.wrappedKey=A.readExactSubarray(e,r,r+t),r+=t}write(){return A.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}}async function Wl(n,e,r,t,i){switch(n){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:{const{n:s,e:a}=r;return{c:await yl(t,s,a)}}case d.publicKey.elgamal:{const{p:s,g:a,y:o}=r;return(async function(c,u,h,l){u=X(u),h=X(h),l=X(l);const f=X(Tc(c,Ze(u))),p=pa(Va,u-Va);return{c1:at(dt(h,p,u)),c2:at(he(dt(l,p,u)*f,u))}})(t,s,a,o)}case d.publicKey.ecdh:{const{oid:s,Q:a,kdfParams:o}=r,{publicKey:c,wrappedKey:u}=await Gl(s,o,t,a,i);return{V:c,C:new l1(u)}}case d.publicKey.x25519:case d.publicKey.x448:{if(e&&!A.isAES(e))throw Error("X25519 and X448 keys can only encrypt AES session keys");const{A:s}=r,{ephemeralPublicKey:a,wrappedKey:o}=await Kl(n,t,s);return{ephemeralPublicKey:a,C:Wi.fromObject({algorithm:e,wrappedKey:o})}}default:return[]}}async function jl(n,e,r,t,i,s){switch(n){case d.publicKey.rsaEncryptSign:case d.publicKey.rsaEncrypt:{const{c:a}=t,{n:o,e:c}=e,{d:u,p:h,q:l,u:f}=r;return gl(a,o,c,u,h,l,f,s)}case d.publicKey.elgamal:{const{c1:a,c2:o}=t;return(async function(c,u,h,l,f){return c=X(c),u=X(u),h=X(h),Rc(at(he(Hi(dt(c,l=X(l),h),h)*u,h),"be",Ze(h)),f)})(a,o,e.p,r.x,s)}case d.publicKey.ecdh:{const{oid:a,Q:o,kdfParams:c}=e,{d:u}=r,{V:h,C:l}=t;return zl(a,c,h,l.data,o,u,i)}case d.publicKey.x25519:case d.publicKey.x448:{const{A:a}=e,{k:o}=r,{ephemeralPublicKey:c,C:u}=t;if(u.algorithm!==null&&!A.isAES(u.algorithm))throw Error("AES session key expected");return Tl(n,c,u.wrappedKey,a,o)}default:throw Error("Unknown public key encryption algorithm.")}}function Di(n,e){const r=new Set([d.publicKey.ed25519,d.publicKey.x25519,d.publicKey.ed448,d.publicKey.x448]),t=Object.keys(e).map((i=>{const s=e[i];return A.isUint8Array(s)?r.has(n)?s:A.uint8ArrayToMPI(s):s.write()}));return A.concatUint8Array(t)}function qs(n){const{keySize:e}=ge(n);return yt(e)}function fs(n){try{n.getName()}catch{throw new oe("Unknown curve OID")}}function u1(n,e){switch(n){case d.publicKey.ecdsa:case d.publicKey.ecdh:case d.publicKey.eddsaLegacy:return new Yt(e).payloadSize;case d.publicKey.ed25519:case d.publicKey.ed448:return ga(n);case d.publicKey.x25519:case d.publicKey.x448:return Sa(n);default:throw Error("Unknown elliptic algo")}}const fi=A.getWebCrypto(),Nn=A.getNodeCrypto(),gr=Nn?Nn.getCiphers():[],Pi={idea:gr.includes("idea-cfb")?"idea-cfb":void 0,tripledes:gr.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:gr.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:gr.includes("bf-cfb")?"bf-cfb":void 0,aes128:gr.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:gr.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:gr.includes("aes-256-cfb")?"aes-256-cfb":void 0};async function h1(n){const{blockSize:e}=ge(n),r=await yt(e),t=new Uint8Array([r[r.length-2],r[r.length-1]]);return A.concat([r,t])}async function Ki(n,e,r,t,i){const s=d.read(d.symmetric,n);if(A.getNodeCrypto()&&Pi[s])return(function(l,f,p,y){const w=d.read(d.symmetric,l),g=new Nn.createCipheriv(Pi[w],f,y);return ve(p,(m=>new Uint8Array(g.update(m))))})(n,e,r,t);if(A.isAES(n))return(async function(l,f,p,y){if(fi&&await no.isSupported(l)){const w=new no(l,f,y);return A.isStream(p)?ve(p,(g=>w.encryptChunk(g)),(()=>w.finish())):w.encrypt(p)}if(A.isStream(p)){const w=new f1(!0,l,f,y);return ve(p,(g=>w.processChunk(g)),(()=>w.finish()))}return Yc(f,y).encrypt(p)})(n,e,r,t);const a=new(await e1(n))(e),o=a.blockSize,c=t.slice();let u=new Uint8Array;const h=l=>{l&&(u=A.concatUint8Array([u,l]));const f=new Uint8Array(u.length);let p,y=0;for(;l?u.length>=o:u.length;){const w=a.encrypt(c);for(p=0;p<o;p++)c[p]=u[p]^w[p],f[y++]=c[p];u=u.subarray(o)}return f.subarray(0,y)};return ve(r,h,h)}async function xa(n,e,r,t){const i=d.read(d.symmetric,n);if(Nn&&Pi[i])return(function(h,l,f,p){const y=d.read(d.symmetric,h),w=new Nn.createDecipheriv(Pi[y],l,p);return ve(f,(g=>new Uint8Array(w.update(g))))})(n,e,r,t);if(A.isAES(n))return(async function(h,l,f,p){if(A.isStream(f)){const y=new f1(!1,h,l,p);return ve(f,(w=>y.processChunk(w)),(()=>y.finish()))}return Yc(l,p).decrypt(f)})(n,e,r,t);const s=new(await e1(n))(e),a=s.blockSize;let o=t,c=new Uint8Array;const u=h=>{h&&(c=A.concatUint8Array([c,h]));const l=new Uint8Array(c.length);let f,p=0;for(;h?c.length>=a:c.length;){const y=s.encrypt(o);for(o=c.subarray(0,a),f=0;f<a;f++)l[p++]=o[f]^y[f];c=c.subarray(a)}return l.subarray(0,p)};return ve(r,u,u)}class no{constructor(e,r,t){const{blockSize:i}=ge(e);this.key=r,this.prevBlock=t,this.nextBlock=new Uint8Array(i),this.i=0,this.blockSize=i,this.zeroBlock=new Uint8Array(this.blockSize)}static async isSupported(e){const{keySize:r}=ge(e);return fi.importKey("raw",new Uint8Array(r),"aes-cbc",!1,["encrypt"]).then((()=>!0),(()=>!1))}async _runCBC(e,r){const t="AES-CBC";this.keyRef=this.keyRef||await fi.importKey("raw",this.key,t,!1,["encrypt"]);const i=await fi.encrypt({name:t,iv:r||this.zeroBlock},this.keyRef,e);return new Uint8Array(i).subarray(0,e.length)}async encryptChunk(e){const r=this.nextBlock.length-this.i,t=e.subarray(0,r);if(this.nextBlock.set(t,this.i),this.i+e.length>=2*this.blockSize){const s=(e.length-r)%this.blockSize,a=A.concatUint8Array([this.nextBlock,e.subarray(r,e.length-s)]),o=A.concatUint8Array([this.prevBlock,a.subarray(0,a.length-this.blockSize)]),c=await this._runCBC(o);return Jn(c,a),this.prevBlock=c.slice(-this.blockSize),s>0&&this.nextBlock.set(e.subarray(-s)),this.i=s,c}let i;if(this.i+=t.length,this.i===this.nextBlock.length){const s=this.nextBlock;i=await this._runCBC(this.prevBlock),Jn(i,s),this.prevBlock=i.slice(),this.i=0;const a=e.subarray(t.length);this.nextBlock.set(a,this.i),this.i+=a.length}else i=new Uint8Array;return i}async finish(){let e;if(this.i===0)e=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);const r=this.nextBlock,t=await this._runCBC(this.prevBlock);Jn(t,r),e=t.subarray(0,r.length)}return this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}async encrypt(e){const r=(await this._runCBC(A.concatUint8Array([new Uint8Array(this.blockSize),e]),this.iv)).subarray(0,e.length);return Jn(r,e),this.clearSensitiveData(),r}}class f1{constructor(e,r,t,i){this.forEncryption=e;const{blockSize:s}=ge(r);this.key=Za.expandKeyLE(t),i.byteOffset%4!=0&&(i=i.slice()),this.prevBlock=ds(i),this.nextBlock=new Uint8Array(s),this.i=0,this.blockSize=s}_runCFB(e){const r=ds(e),t=new Uint8Array(e.length),i=ds(t);for(let s=0;s+4<=i.length;s+=4){const{s0:a,s1:o,s2:c,s3:u}=Za.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);i[s+0]=r[s+0]^a,i[s+1]=r[s+1]^o,i[s+2]=r[s+2]^c,i[s+3]=r[s+3]^u,this.prevBlock=(this.forEncryption?i:r).slice(s,s+4)}return t}async processChunk(e){const r=this.nextBlock.length-this.i,t=e.subarray(0,r);if(this.nextBlock.set(t,this.i),this.i+e.length>=2*this.blockSize){const s=(e.length-r)%this.blockSize,a=A.concatUint8Array([this.nextBlock,e.subarray(r,e.length-s)]),o=this._runCFB(a);return s>0&&this.nextBlock.set(e.subarray(-s)),this.i=s,o}let i;if(this.i+=t.length,this.i===this.nextBlock.length){i=this._runCFB(this.nextBlock),this.i=0;const s=e.subarray(t.length);this.nextBlock.set(s,this.i),this.i+=s.length}else i=new Uint8Array;return i}async finish(){let e;return this.i===0?e=new Uint8Array:e=this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}}function Jn(n,e){const r=Math.min(n.length,e.length);for(let t=0;t<r;t++)n[t]=n[t]^e[t]}const ds=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),io=A.getWebCrypto(),ql=A.getNodeCrypto(),Sr=16;function so(n,e){const r=n.length-Sr;for(let t=0;t<Sr;t++)n[t+r]^=e[t];return n}const di=new Uint8Array(Sr);async function Yl(n){const e=await Jl(n),r=A.double(await e(di)),t=A.double(r);return async function(i){return(await e((function(s,a,o){if(s.length&&s.length%Sr==0)return so(s,a);const c=new Uint8Array(s.length+(Sr-s.length%Sr));return c.set(s),c[s.length]=128,so(c,o)})(i,r,t))).subarray(-16)}}async function Jl(n){if(A.getNodeCrypto())return async function(e){const r=new ql.createCipheriv("aes-"+8*n.length+"-cbc",n,di).update(e);return new Uint8Array(r)};if(A.getWebCrypto())try{return n=await io.importKey("raw",n,{name:"AES-CBC",length:8*n.length},!1,["encrypt"]),async function(e){const r=await io.encrypt({name:"AES-CBC",iv:di,length:128},n,e);return new Uint8Array(r).subarray(0,r.byteLength-Sr)}}catch(e){if(e.name!=="NotSupportedError"&&(n.length!==24||e.name!=="OperationError"))throw e;A.printDebugError("Browser did not support operation: "+e.message)}return async function(e){return _s(n,di,{disablePadding:!0}).encrypt(e)}}const ao=A.getWebCrypto(),$l=A.getNodeCrypto(),Zl=A.getNodeBuffer(),Hn=16,pi=Hn,oo=new Uint8Array(Hn),Ys=new Uint8Array(Hn);Ys[15]=1;const Js=new Uint8Array(Hn);async function Xl(n){const e=await Yl(n);return function(r,t){return e(A.concatUint8Array([r,t]))}}async function e3(n){if(A.getNodeCrypto())return async function(e,r){const t=new $l.createCipheriv("aes-"+8*n.length+"-ctr",n,r),i=Zl.concat([t.update(e),t.final()]);return new Uint8Array(i)};if(A.getWebCrypto())try{const e=await ao.importKey("raw",n,{name:"AES-CTR",length:8*n.length},!1,["encrypt"]);return async function(r,t){const i=await ao.encrypt({name:"AES-CTR",counter:t,length:128},e,r);return new Uint8Array(i)}}catch(e){if(e.name!=="NotSupportedError"&&(n.length!==24||e.name!=="OperationError"))throw e;A.printDebugError("Browser did not support operation: "+e.message)}return async function(e,r){return kl(n,r).encrypt(e)}}async function En(n,e){if(n!==d.symmetric.aes128&&n!==d.symmetric.aes192&&n!==d.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[r,t]=await Promise.all([Xl(e),e3(e)]);return{encrypt:async function(i,s,a){const[o,c]=await Promise.all([r(oo,s),r(Ys,a)]),u=await t(i,o),h=await r(Js,u);for(let l=0;l<pi;l++)h[l]^=c[l]^o[l];return A.concatUint8Array([u,h])},decrypt:async function(i,s,a){if(i.length<pi)throw Error("Invalid EAX ciphertext");const o=i.subarray(0,-16),c=i.subarray(-16),[u,h,l]=await Promise.all([r(oo,s),r(Ys,a),r(Js,o)]),f=l;for(let p=0;p<pi;p++)f[p]^=h[p]^u[p];if(!A.equalsUint8Array(c,f))throw Error("Authentication tag mismatch");return await t(o,u)}}}Js[15]=2,En.getNonce=function(n,e){const r=n.slice();for(let t=0;t<e.length;t++)r[8+t]^=e[t];return r},En.blockLength=Hn,En.ivLength=16,En.tagLength=pi;const tt=16,$s=16;function co(n){let e=0;for(let r=1;!(n&r);r<<=1)e++;return e}function ze(n,e){for(let r=0;r<n.length;r++)n[r]^=e[r];return n}function $n(n,e){return ze(n.slice(),e)}const un=new Uint8Array(tt),t3=new Uint8Array([1]);async function vn(n,e){const{keySize:r}=ge(n);if(!A.isAES(n)||e.length!==r)throw Error("Unexpected algorithm or key size");let t=0;const i=c=>_s(e,un,{disablePadding:!0}).encrypt(c),s=c=>_s(e,un,{disablePadding:!0}).decrypt(c);let a;function o(c,u,h,l){const f=u.length/tt|0;(function(D,I){const b=A.nbits(Math.max(D.length,I.length)/tt|0)-1;for(let k=t+1;k<=b;k++)a[k]=A.double(a[k-1]);t=b})(u,l);const p=A.concatUint8Array([un.subarray(0,15-h.length),t3,h]),y=63&p[15];p[15]&=192;const w=i(p),g=A.concatUint8Array([w,$n(w.subarray(0,8),w.subarray(1,9))]),m=A.shiftRight(g.subarray(0+(y>>3),17+(y>>3)),8-(7&y)).subarray(1),S=new Uint8Array(tt),E=new Uint8Array(u.length+$s);let v,U=0;for(v=0;v<f;v++)ze(m,a[co(v+1)]),E.set(ze(c($n(m,u)),m),U),ze(S,c===i?u:E.subarray(U)),u=u.subarray(tt),U+=tt;if(u.length){ze(m,a.x);const D=i(m);E.set($n(u,D),U);const I=new Uint8Array(tt);I.set(c===i?u:E.subarray(U,-16),0),I[u.length]=128,ze(S,I),U+=u.length}const T=ze(i(ze(ze(S,m),a.$)),(function(D){if(!D.length)return un;const I=D.length/tt|0,b=new Uint8Array(tt),k=new Uint8Array(tt);for(let x=0;x<I;x++)ze(b,a[co(x+1)]),ze(k,i($n(b,D))),D=D.subarray(tt);if(D.length){ze(b,a.x);const x=new Uint8Array(tt);x.set(D,0),x[D.length]=128,ze(x,b),ze(k,i(x))}return k})(l));return E.set(T,U),E}return(function(){const c=i(un),u=A.double(c);a=[],a[0]=A.double(u),a.x=c,a.$=u})(),{encrypt:async function(c,u,h){return o(i,c,u,h)},decrypt:async function(c,u,h){if(c.length<$s)throw Error("Invalid OCB ciphertext");const l=c.subarray(-16);c=c.subarray(0,-16);const f=o(s,c,u,h);if(A.equalsUint8Array(l,f.subarray(-16)))return f.subarray(0,-16);throw Error("Authentication tag mismatch")}}}vn.getNonce=function(n,e){const r=n.slice();for(let t=0;t<e.length;t++)r[7+t]^=e[t];return r},vn.blockLength=tt,vn.ivLength=15,vn.tagLength=$s;const ps=A.getWebCrypto(),lo=A.getNodeCrypto(),uo=A.getNodeBuffer(),yi=16,ys="AES-GCM";async function _r(n,e){if(n!==d.symmetric.aes128&&n!==d.symmetric.aes192&&n!==d.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(A.getNodeCrypto())return{encrypt:async function(r,t,i=new Uint8Array){const s=new lo.createCipheriv("aes-"+8*e.length+"-gcm",e,t);s.setAAD(i);const a=uo.concat([s.update(r),s.final(),s.getAuthTag()]);return new Uint8Array(a)},decrypt:async function(r,t,i=new Uint8Array){const s=new lo.createDecipheriv("aes-"+8*e.length+"-gcm",e,t);s.setAAD(i),s.setAuthTag(r.slice(r.length-yi,r.length));const a=uo.concat([s.update(r.slice(0,r.length-yi)),s.final()]);return new Uint8Array(a)}};if(A.getWebCrypto())try{const r=await ps.importKey("raw",e,{name:ys},!1,["encrypt","decrypt"]),t=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:async function(i,s,a=new Uint8Array){if(t&&!i.length)return Yn(e,s,a).encrypt(i);const o=await ps.encrypt({name:ys,iv:s,additionalData:a,tagLength:128},r,i);return new Uint8Array(o)},decrypt:async function(i,s,a=new Uint8Array){if(t&&i.length===yi)return Yn(e,s,a).decrypt(i);try{const o=await ps.decrypt({name:ys,iv:s,additionalData:a,tagLength:128},r,i);return new Uint8Array(o)}catch(o){if(o.name==="OperationError")throw Error("Authentication tag mismatch")}}}}catch(r){if(r.name!=="NotSupportedError"&&(e.length!==24||r.name!=="OperationError"))throw r;A.printDebugError("Browser did not support operation: "+r.message)}return{encrypt:async function(r,t,i){return Yn(e,t,i).encrypt(r)},decrypt:async function(r,t,i){return Yn(e,t,i).decrypt(r)}}}function $r(n,e=!1){switch(n){case d.aead.eax:return En;case d.aead.ocb:return vn;case d.aead.gcm:return _r;case d.aead.experimentalGCM:if(!e)throw Error("Unexpected non-standard `experimentalGCM` AEAD algorithm provided in `config.preferredAEADAlgorithm`: use `gcm` instead");return _r;default:throw Error("Unsupported AEAD mode")}}async function r3(n,e,r,t,i,s){switch(n){case d.publicKey.rsaEncryptSign:case d.publicKey.rsaEncrypt:case d.publicKey.rsaSign:{const{n:a,e:o}=t;return pl(e,i,A.leftPad(r.s,a.length),a,o,s)}case d.publicKey.dsa:{const{g:a,p:o,q:c,y:u}=t,{r:h,s:l}=r;return(async function(f,p,y,w,g,m,S,E){if(p=X(p),y=X(y),m=X(m),S=X(S),g=X(g),E=X(E),p<=hs||p>=S||y<=hs||y>=S)return A.printDebug("invalid DSA Signature"),!1;const v=he(X(w.subarray(0,Ze(S))),S),U=Hi(y,S);if(U===hs)return A.printDebug("invalid DSA Signature"),!1;g=he(g,m),E=he(E,m);const T=he(v*U,S),D=he(p*U,S);return he(he(dt(g,T,m)*dt(E,D,m),m),S)===p})(0,h,l,s,a,o,c,u)}case d.publicKey.ecdsa:{const{oid:a,Q:o}=t,c=new Yt(a).payloadSize;return Ol(a,e,{r:A.leftPad(r.r,c),s:A.leftPad(r.s,c)},i,o,s)}case d.publicKey.eddsaLegacy:{const{oid:a,Q:o}=t,c=new Yt(a).payloadSize;return Ql(a,e,{r:A.leftPad(r.r,c),s:A.leftPad(r.s,c)},0,o,s)}case d.publicKey.ed25519:case d.publicKey.ed448:{const{A:a}=t;return Qc(n,e,r,0,a,s)}default:throw Error("Unknown signature algorithm.")}}async function n3(n,e,r,t,i,s){if(!r||!t)throw Error("Missing key parameters");switch(n){case d.publicKey.rsaEncryptSign:case d.publicKey.rsaEncrypt:case d.publicKey.rsaSign:{const{n:a,e:o}=r,{d:c,p:u,q:h,u:l}=t;return{s:await dl(e,i,a,o,c,u,h,l,s)}}case d.publicKey.dsa:{const{g:a,p:o,q:c}=r,{x:u}=t;return(async function(h,l,f,p,y,w){const g=BigInt(0);let m,S,E,v;p=X(p),y=X(y),f=X(f),w=X(w),f=he(f,p),w=he(w,y);const U=he(X(l.subarray(0,Ze(y))),y);for(;;){if(m=pa(_l,y),S=he(dt(f,m,p),y),S===g)continue;const T=he(w*S,y);if(v=he(U+T,y),E=he(Hi(m,y)*v,y),E!==g)break}return{r:at(S,"be",Ze(p)),s:at(E,"be",Ze(p))}})(0,s,a,o,c,u)}case d.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case d.publicKey.ecdsa:{const{oid:a,Q:o}=r,{d:c}=t;return Nl(a,e,i,o,c,s)}case d.publicKey.eddsaLegacy:{const{oid:a,Q:o}=r,{seed:c}=t;return Ll(a,e,0,o,c,s)}case d.publicKey.ed25519:case d.publicKey.ed448:{const{A:a}=r,{seed:o}=t;return Lc(n,e,0,a,o,s)}default:throw Error("Unknown signature algorithm.")}}_r.getNonce=function(n,e){const r=n.slice();for(let t=0;t<e.length;t++)r[4+t]^=e[t];return r},_r.blockLength=16,_r.ivLength=12,_r.tagLength=yi;class ji extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,ji),this.name="Argon2OutOfMemoryError"}}let Zn,hn;class i3{constructor(e=$){const{passes:r,parallelism:t,memoryExponent:i}=e.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=r,this.p=t,this.encodedM=i}generateSalt(){this.salt=yt(16)}read(e){let r=0;return this.salt=e.subarray(r,r+16),r+=16,this.t=e[r++],this.p=e[r++],this.encodedM=e[r++],r}write(){const e=[new Uint8Array([d.write(d.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return A.concatUint8Array(e)}async produceKey(e,r){const t=2<<this.encodedM-1;try{Zn=Zn||(await Promise.resolve().then((function(){return Ph}))).default,hn=hn||Zn();const i=await hn,s=i({version:19,type:2,password:A.encodeUTF8(e),salt:this.salt,tagLength:r,memorySize:t,parallelism:this.p,passes:this.t});return t>1048576&&(hn=Zn(),hn.catch((()=>{}))),s}catch(i){throw i.message&&(i.message.includes("Unable to grow instance memory")||i.message.includes("failed to grow memory")||i.message.includes("WebAssembly.Memory.grow")||i.message.includes("Out of memory"))?new ji("Could not allocate required memory for Argon2"):i}}}class s3{constructor(e,r=$){this.algorithm=d.hash.sha256,this.type=d.read(d.s2k,e),this.c=r.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=yt(8)}}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(e){let r=0;switch(this.algorithm=e[r++],this.type){case"simple":break;case"salted":this.salt=e.subarray(r,r+8),r+=8;break;case"iterated":this.salt=e.subarray(r,r+8),r+=8,this.c=e[r++];break;case"gnu":if(A.uint8ArrayToString(e.subarray(r,r+3))!=="GNU")throw new oe("Unknown s2k type.");if(r+=3,1e3+e[r++]!==1001)throw new oe("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new oe("Unknown s2k type.")}return r}write(){if(this.type==="gnu-dummy")return new Uint8Array([101,0,...A.stringToUint8Array("GNU"),1]);const e=[new Uint8Array([d.write(d.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":e.push(this.salt);break;case"iterated":e.push(this.salt),e.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return A.concatUint8Array(e)}async produceKey(e,r){e=A.encodeUTF8(e);const t=[];let i=0,s=0;for(;i<r;){let a;switch(this.type){case"simple":a=A.concatUint8Array([new Uint8Array(s),e]);break;case"salted":a=A.concatUint8Array([new Uint8Array(s),this.salt,e]);break;case"iterated":{const c=A.concatUint8Array([this.salt,e]);let u=c.length;const h=Math.max(this.getCount(),u);a=new Uint8Array(s+h),a.set(c,s);for(let l=s+u;l<h;l+=u,u*=2)a.copyWithin(l,s,l);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const o=await kr(this.algorithm,a);t.push(o),i+=o.length,s++}return A.concatUint8Array(t).subarray(0,r)}}const a3=new Set([d.s2k.argon2,d.s2k.iterated]);function d1(n,e=$){switch(n){case d.s2k.argon2:return new i3(e);case d.s2k.iterated:case d.s2k.gnu:case d.s2k.salted:case d.s2k.simple:return new s3(n,e);default:throw new oe("Unsupported S2K type")}}function o3(n){const{s2kType:e}=n;if(!a3.has(e))throw Error("The provided `config.s2kType` value is not allowed");return d1(e,n)}var Se=Uint8Array,it=Uint16Array,Ia=Int32Array,qi=new Se([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Yi=new Se([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Zs=new Se([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),p1=function(n,e){for(var r=new it(31),t=0;t<31;++t)r[t]=e+=1<<n[t-1];var i=new Ia(r[30]);for(t=1;t<30;++t)for(var s=r[t];s<r[t+1];++s)i[s]=s-r[t]<<5|t;return{b:r,r:i}},y1=p1(qi,2),g1=y1.b,Xs=y1.r;g1[28]=258,Xs[258]=28;for(var ho=p1(Yi,0),c3=ho.b,fo=ho.r,ea=new it(32768),fe=0;fe<32768;++fe){var Ar=(43690&fe)>>1|(21845&fe)<<1;Ar=(61680&(Ar=(52428&Ar)>>2|(13107&Ar)<<2))>>4|(3855&Ar)<<4,ea[fe]=((65280&Ar)>>8|(255&Ar)<<8)>>1}var Nt=function(n,e,r){for(var t=n.length,i=0,s=new it(e);i<t;++i)n[i]&&++s[n[i]-1];var a,o=new it(e);for(i=1;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;if(r){a=new it(1<<e);var c=15-e;for(i=0;i<t;++i)if(n[i])for(var u=i<<4|n[i],h=e-n[i],l=o[n[i]-1]++<<h,f=l|(1<<h)-1;l<=f;++l)a[ea[l]>>c]=u}else for(a=new it(t),i=0;i<t;++i)n[i]&&(a[i]=ea[o[n[i]-1]++]>>15-n[i]);return a},hr=new Se(288);for(fe=0;fe<144;++fe)hr[fe]=8;for(fe=144;fe<256;++fe)hr[fe]=9;for(fe=256;fe<280;++fe)hr[fe]=7;for(fe=280;fe<288;++fe)hr[fe]=8;var On=new Se(32);for(fe=0;fe<32;++fe)On[fe]=5;var l3=Nt(hr,9,0),u3=Nt(hr,9,1),h3=Nt(On,5,0),f3=Nt(On,5,1),gs=function(n){for(var e=n[0],r=1;r<n.length;++r)n[r]>e&&(e=n[r]);return e},At=function(n,e,r){var t=e/8|0;return(n[t]|n[t+1]<<8)>>(7&e)&r},As=function(n,e){var r=e/8|0;return(n[r]|n[r+1]<<8|n[r+2]<<16)>>(7&e)},Ca=function(n){return(n+7)/8|0},Sn=function(n,e,r){return(e==null||e<0)&&(e=0),(r==null||r>n.length)&&(r=n.length),new Se(n.subarray(e,r))},d3=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],De=function(n,e,r){var t=Error(e||d3[n]);if(t.code=n,Error.captureStackTrace&&Error.captureStackTrace(t,De),!r)throw t;return t},Ft=function(n,e,r){r<<=7&e;var t=e/8|0;n[t]|=r,n[t+1]|=r>>8},fn=function(n,e,r){r<<=7&e;var t=e/8|0;n[t]|=r,n[t+1]|=r>>8,n[t+2]|=r>>16},ws=function(n,e){for(var r=[],t=0;t<n.length;++t)n[t]&&r.push({s:t,f:n[t]});var i=r.length,s=r.slice();if(!i)return{t:w1,l:0};if(i==1){var a=new Se(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort((function(U,T){return U.f-T.f})),r.push({s:-1,f:25001});var o=r[0],c=r[1],u=0,h=1,l=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};h!=i-1;)o=r[r[u].f<r[l].f?u++:l++],c=r[u!=h&&r[u].f<r[l].f?u++:l++],r[h++]={s:-1,f:o.f+c.f,l:o,r:c};var f=s[0].s;for(t=1;t<i;++t)s[t].s>f&&(f=s[t].s);var p=new it(f+1),y=ta(r[h-1],p,0);if(y>e){t=0;var w=0,g=y-e,m=1<<g;for(s.sort((function(U,T){return p[T.s]-p[U.s]||U.f-T.f}));t<i;++t){var S=s[t].s;if(!(p[S]>e))break;w+=m-(1<<y-p[S]),p[S]=e}for(w>>=g;w>0;){var E=s[t].s;p[E]<e?w-=1<<e-p[E]++-1:++t}for(;t>=0&&w;--t){var v=s[t].s;p[v]==e&&(--p[v],++w)}y=e}return{t:new Se(p),l:y}},ta=function(n,e,r){return n.s==-1?Math.max(ta(n.l,e,r+1),ta(n.r,e,r+1)):e[n.s]=r},po=function(n){for(var e=n.length;e&&!n[--e];);for(var r=new it(++e),t=0,i=n[0],s=1,a=function(c){r[t++]=c},o=1;o<=e;++o)if(n[o]==i&&o!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=n[o]}return{c:r.subarray(0,t),n:e}},dn=function(n,e){for(var r=0,t=0;t<e.length;++t)r+=n[t]*e[t];return r},A1=function(n,e,r){var t=r.length,i=Ca(e+2);n[i]=255&t,n[i+1]=t>>8,n[i+2]=255^n[i],n[i+3]=255^n[i+1];for(var s=0;s<t;++s)n[i+s+4]=r[s];return 8*(i+4+t)},yo=function(n,e,r,t,i,s,a,o,c,u,h){Ft(e,h++,r),++i[256];for(var l=ws(i,15),f=l.t,p=l.l,y=ws(s,15),w=y.t,g=y.l,m=po(f),S=m.c,E=m.n,v=po(w),U=v.c,T=v.n,D=new it(19),I=0;I<S.length;++I)++D[31&S[I]];for(I=0;I<U.length;++I)++D[31&U[I]];for(var b=ws(D,7),k=b.t,x=b.l,C=19;C>4&&!k[Zs[C-1]];--C);var B,P,R,K,N=u+5<<3,M=dn(i,hr)+dn(s,On)+a,L=dn(i,f)+dn(s,w)+a+14+3*C+dn(D,k)+2*D[16]+3*D[17]+7*D[18];if(c>=0&&N<=M&&N<=L)return A1(e,h,n.subarray(c,c+u));if(Ft(e,h,1+(L<M)),h+=2,L<M){B=Nt(f,p,0),P=f,R=Nt(w,g,0),K=w;var O=Nt(k,x,0);for(Ft(e,h,E-257),Ft(e,h+5,T-1),Ft(e,h+10,C-4),h+=14,I=0;I<C;++I)Ft(e,h+3*I,k[Zs[I]]);h+=3*C;for(var z=[S,U],Q=0;Q<2;++Q){var G=z[Q];for(I=0;I<G.length;++I){var H=31&G[I];Ft(e,h,O[H]),h+=k[H],H>15&&(Ft(e,h,G[I]>>5&127),h+=G[I]>>12)}}}else B=l3,P=hr,R=h3,K=On;for(I=0;I<o;++I){var _=t[I];if(_>255){fn(e,h,B[(H=_>>18&31)+257]),h+=P[H+257],H>7&&(Ft(e,h,_>>23&31),h+=qi[H]);var W=31&_;fn(e,h,R[W]),h+=K[W],W>3&&(fn(e,h,_>>5&8191),h+=Yi[W])}else fn(e,h,B[_]),h+=P[_]}return fn(e,h,B[256]),h+P[256]},p3=new Ia([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),w1=new Se(0),go=function(){var n=1,e=0;return{p:function(r){for(var t=n,i=e,s=0|r.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=t+=r[a];t=(65535&t)+15*(t>>16),i=(65535&i)+15*(i>>16)}n=t,e=i},d:function(){return(255&(n%=65521))<<24|(65280&n)<<8|(255&(e%=65521))<<8|e>>8}}},m1=function(n,e,r,t,i){if(!i&&(i={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),a=new Se(s.length+n.length);a.set(s),a.set(n,s.length),n=a,i.w=s.length}return(function(o,c,u,h,l,f){var p=f.z||o.length,y=new Se(h+p+5*(1+Math.ceil(p/7e3))+l),w=y.subarray(h,y.length-l),g=f.l,m=7&(f.r||0);if(c){m&&(w[0]=f.r>>3);for(var S=p3[c-1],E=S>>13,v=8191&S,U=(1<<u)-1,T=f.p||new it(32768),D=f.h||new it(U+1),I=Math.ceil(u/3),b=2*I,k=function(ts){return(o[ts]^o[ts+1]<<I^o[ts+2]<<b)&U},x=new Ia(25e3),C=new it(288),B=new it(32),P=0,R=0,K=f.i||0,N=0,M=f.w||0,L=0;K+2<p;++K){var O=k(K),z=32767&K,Q=D[O];if(T[z]=Q,D[O]=z,M<=K){var G=p-K;if((P>7e3||N>24576)&&(G>423||!g)){m=yo(o,w,0,x,C,B,R,N,L,K-L,m),N=P=R=0,L=K;for(var H=0;H<286;++H)C[H]=0;for(H=0;H<30;++H)B[H]=0}var _=2,W=0,J=v,q=z-Q&32767;if(G>2&&O==k(K-q))for(var ne=Math.min(E,G)-1,re=Math.min(32767,K),ae=Math.min(258,G);q<=re&&--J&&z!=Q;){if(o[K+_]==o[K+_-q]){for(var ee=0;ee<ae&&o[K+ee]==o[K+ee-q];++ee);if(ee>_){if(_=ee,W=q,ee>ne)break;var Ae=Math.min(q,ee-2),be=0;for(H=0;H<Ae;++H){var we=K-q+H&32767,on=we-T[we]&32767;on>be&&(be=on,Q=we)}}}q+=(z=Q)-(Q=T[z])&32767}if(W){x[N++]=268435456|Xs[_]<<18|fo[W];var Ta=31&Xs[_],Ra=31&fo[W];R+=qi[Ta]+Yi[Ra],++C[257+Ta],++B[Ra],M=K+_,++P}else x[N++]=o[K],++C[o[K]]}}for(K=Math.max(K,M);K<p;++K)x[N++]=o[K],++C[o[K]];m=yo(o,w,g,x,C,B,R,N,L,K-L,m),g||(f.r=7&m|w[m/8|0]<<3,m-=7,f.h=D,f.p=T,f.i=K,f.w=M)}else{for(K=f.w||0;K<p+g;K+=65535){var es=K+65535;es>=p&&(w[m/8|0]=g,es=p),m=A1(w,m+1,o.subarray(K,es))}f.i=p}return Sn(y,0,h+Ca(m)+l)})(n,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(n.length)))):20:12+e.mem,r,t,i)},Ao=function(n,e,r){for(;r;++e)n[e]=r,r>>>=8},gi=(function(){function n(e,r){if(typeof e=="function"&&(r=e,e={}),this.ondata=r,this.o=e||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new Se(98304),this.o.dictionary){var t=this.o.dictionary.subarray(-32768);this.b.set(t,32768-t.length),this.s.i=32768-t.length}}return n.prototype.p=function(e,r){this.ondata(m1(e,this.o,0,0,this.s),r)},n.prototype.push=function(e,r){this.ondata||De(5),this.s.l&&De(4);var t=e.length+this.s.z;if(t>this.b.length){if(t>2*this.b.length-32768){var i=new Se(-32768&t);i.set(this.b.subarray(0,this.s.z)),this.b=i}var s=this.b.length-this.s.z;this.b.set(e.subarray(0,s),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(e.subarray(s),32768),this.s.z=e.length-s+32768,this.s.i=32766,this.s.w=32768}else this.b.set(e,this.s.z),this.s.z+=e.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n.prototype.flush=function(){this.ondata||De(5),this.s.l&&De(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},n})(),Ai=(function(){function n(e,r){typeof e=="function"&&(r=e,e={}),this.ondata=r;var t=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:t?t.length:0},this.o=new Se(32768),this.p=new Se(0),t&&this.o.set(t)}return n.prototype.e=function(e){if(this.ondata||De(5),this.d&&De(4),this.p.length){if(e.length){var r=new Se(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length),this.p=r}}else this.p=e},n.prototype.c=function(e){this.s.i=+(this.d=e||!1);var r=this.s.b,t=(function(i,s,a,o){var c=i.length;if(!c||s.f&&!s.l)return a||new Se(0);var u=!a,h=u||s.i!=2,l=s.i;u&&(a=new Se(3*c));var f=function(be){var we=a.length;if(be>we){var on=new Se(Math.max(2*we,be));on.set(a),a=on}},p=s.f||0,y=s.p||0,w=s.b||0,g=s.l,m=s.d,S=s.m,E=s.n,v=8*c;do{if(!g){p=At(i,y,1);var U=At(i,y+1,3);if(y+=3,!U){var T=i[(N=Ca(y)+4)-4]|i[N-3]<<8,D=N+T;if(D>c){l&&De(0);break}h&&f(w+T),a.set(i.subarray(N,D),w),s.b=w+=T,s.p=y=8*D,s.f=p;continue}if(U==1)g=u3,m=f3,S=9,E=5;else if(U==2){var I=At(i,y,31)+257,b=At(i,y+10,15)+4,k=I+At(i,y+5,31)+1;y+=14;for(var x=new Se(k),C=new Se(19),B=0;B<b;++B)C[Zs[B]]=At(i,y+3*B,7);y+=3*b;var P=gs(C),R=(1<<P)-1,K=Nt(C,P,1);for(B=0;B<k;){var N,M=K[At(i,y,R)];if(y+=15&M,(N=M>>4)<16)x[B++]=N;else{var L=0,O=0;for(N==16?(O=3+At(i,y,3),y+=2,L=x[B-1]):N==17?(O=3+At(i,y,7),y+=3):N==18&&(O=11+At(i,y,127),y+=7);O--;)x[B++]=L}}var z=x.subarray(0,I),Q=x.subarray(I);S=gs(z),E=gs(Q),g=Nt(z,S,1),m=Nt(Q,E,1)}else De(1);if(y>v){l&&De(0);break}}h&&f(w+131072);for(var G=(1<<S)-1,H=(1<<E)-1,_=y;;_=y){var W=(L=g[As(i,y)&G])>>4;if((y+=15&L)>v){l&&De(0);break}if(L||De(2),W<256)a[w++]=W;else{if(W==256){_=y,g=null;break}var J=W-254;if(W>264){var q=qi[B=W-257];J=At(i,y,(1<<q)-1)+g1[B],y+=q}var ne=m[As(i,y)&H],re=ne>>4;if(ne||De(3),y+=15&ne,Q=c3[re],re>3&&(q=Yi[re],Q+=As(i,y)&(1<<q)-1,y+=q),y>v){l&&De(0);break}h&&f(w+131072);var ae=w+J;if(w<Q){var ee=0-Q,Ae=Math.min(Q,ae);for(ee+w<0&&De(3);w<Ae;++w)a[w]=o[ee+w]}for(;w<ae;++w)a[w]=a[w-Q]}}s.l=g,s.p=_,s.b=w,s.f=p,g&&(p=1,s.m=S,s.d=m,s.n=E)}while(!p);return w!=a.length&&u?Sn(a,0,w):a.subarray(0,w)})(this.p,this.s,this.o);this.ondata(Sn(t,r,this.s.b),this.d),this.o=Sn(t,this.s.b-32768),this.s.b=this.o.length,this.p=Sn(this.p,this.s.p/8|0),this.s.p&=7},n.prototype.push=function(e,r){this.e(e),this.c(r)},n})(),y3=(function(){function n(e,r){this.c=go(),this.v=1,gi.call(this,e,r)}return n.prototype.push=function(e,r){this.c.p(e),gi.prototype.push.call(this,e,r)},n.prototype.p=function(e,r){var t=m1(e,this.o,this.v&&(this.o.dictionary?6:2),r&&4,this.s);this.v&&((function(i,s){var a=s.level,o=a==0?0:a<6?1:a==9?3:2;if(i[0]=120,i[1]=o<<6|(s.dictionary&&32),i[1]|=31-(i[0]<<8|i[1])%31,s.dictionary){var c=go();c.p(s.dictionary),Ao(i,2,c.d())}})(t,this.o),this.v=0),r&&Ao(t,t.length-4,this.c.d()),this.ondata(t,r)},n.prototype.flush=function(){gi.prototype.flush.call(this)},n})(),g3=(function(){function n(e,r){Ai.call(this,e,r),this.v=e&&e.dictionary?2:1}return n.prototype.push=function(e,r){if(Ai.prototype.e.call(this,e),this.v){if(this.p.length<6&&!r)return;this.p=this.p.subarray((t=this.p,i=this.v-1,((15&t[0])!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&De(6,"invalid zlib data"),(t[1]>>5&1)==+!i&&De(6,"invalid zlib data: "+(32&t[1]?"need":"unexpected")+" dictionary"),2+(t[1]>>3&4))),this.v=0}var t,i;r&&(this.p.length<4&&De(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Ai.prototype.c.call(this,r)},n})(),A3=typeof TextDecoder<"u"&&new TextDecoder;try{A3.decode(w1,{stream:!0})}catch{}class nn{static get tag(){return d.packet.literalData}constructor(e=new Date){this.format=d.literal.utf8,this.date=A.normalizeDate(e),this.text=null,this.data=null,this.filename=""}setText(e,r=d.literal.utf8){this.format=r,this.text=e,this.data=null}getText(e=!1){return(this.text===null||A.isStream(this.text))&&(this.text=A.decodeUTF8(A.nativeEOL(this.getBytes(e)))),this.text}setBytes(e,r){this.format=r,this.data=e,this.text=null}getBytes(e=!1){return this.data===null&&(this.data=A.canonicalizeEOL(A.encodeUTF8(this.text))),e?Pn(this.data):this.data}setFilename(e){this.filename=e}getFilename(){return this.filename}async read(e){await Gi(e,(async r=>{const t=await r.readByte(),i=await r.readByte();this.filename=A.decodeUTF8(await r.readBytes(i)),this.date=A.readDate(await r.readBytes(4));let s=r.remainder();xe(s)&&(s=await Ce(s)),this.setBytes(s,t)}))}writeHeader(){const e=A.encodeUTF8(this.filename),r=new Uint8Array([e.length]),t=new Uint8Array([this.format]),i=A.writeDate(this.date);return A.concatUint8Array([t,r,e,i])}write(){const e=this.writeHeader(),r=this.getBytes();return A.concat([e,r])}}class Ot{constructor(){this.bytes=""}read(e){return this.bytes=A.uint8ArrayToString(e.subarray(0,8)),this.bytes.length}write(){return A.stringToUint8Array(this.bytes)}toHex(){return A.uint8ArrayToHex(A.stringToUint8Array(this.bytes))}equals(e,r=!1){return r&&(e.isWildcard()||this.isWildcard())||this.bytes===e.bytes}isNull(){return this.bytes===""}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(e){return e.toHex()}static fromID(e){const r=new Ot;return r.read(A.hexToUint8Array(e)),r}static wildcard(){const e=new Ot;return e.read(new Uint8Array(8)),e}}const pn=Symbol("verified"),wo="salt@notations.openpgpjs.org",w3=new Set([d.signatureSubpacket.issuerKeyID,d.signatureSubpacket.issuerFingerprint,d.signatureSubpacket.embeddedSignature]);class He{static get tag(){return d.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new Ot,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[pn]=null}read(e,r=$){let t=0;if(this.version=e[t++],this.version===5&&!r.enableParsingV5Entities)throw new oe("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version!==4&&this.version!==5&&this.version!==6)throw new oe(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=e[t++],this.publicKeyAlgorithm=e[t++],this.hashAlgorithm=e[t++],t+=this.readSubPackets(e.subarray(t,e.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=e.subarray(0,t),t+=this.readSubPackets(e.subarray(t,e.length),!1),this.signedHashValue=e.subarray(t,t+2),t+=2,this.version===6){const o=e[t++];this.salt=e.subarray(t,t+o),t+=o}const i=e.subarray(t,e.length),{read:s,signatureParams:a}=(function(o,c){let u=0;switch(o){case d.publicKey.rsaEncryptSign:case d.publicKey.rsaEncrypt:case d.publicKey.rsaSign:{const h=A.readMPI(c.subarray(u));return u+=h.length+2,{read:u,signatureParams:{s:h}}}case d.publicKey.dsa:case d.publicKey.ecdsa:{const h=A.readMPI(c.subarray(u));u+=h.length+2;const l=A.readMPI(c.subarray(u));return u+=l.length+2,{read:u,signatureParams:{r:h,s:l}}}case d.publicKey.eddsaLegacy:{const h=A.readMPI(c.subarray(u));u+=h.length+2;const l=A.readMPI(c.subarray(u));return u+=l.length+2,{read:u,signatureParams:{r:h,s:l}}}case d.publicKey.ed25519:case d.publicKey.ed448:{const h=2*ga(o),l=A.readExactSubarray(c,u,u+h);return u+=l.length,{read:u,signatureParams:{RS:l}}}default:throw new oe("Unknown signature algorithm.")}})(this.publicKeyAlgorithm,i);if(s<i.length)throw Error("Error reading MPIs");this.params=a}writeParams(){return this.params instanceof Promise?dr((async()=>Di(this.publicKeyAlgorithm,await this.params))):Di(this.publicKeyAlgorithm,this.params)}write(){const e=[];return e.push(this.signatureData),e.push(this.writeUnhashedSubPackets()),e.push(this.signedHashValue),this.version===6&&(e.push(new Uint8Array([this.salt.length])),e.push(this.salt)),e.push(this.writeParams()),A.concat(e)}async sign(e,r,t=new Date,i=!1,s){this.version=e.version,this.created=A.normalizeDate(t),this.issuerKeyVersion=e.version,this.issuerFingerprint=e.getFingerprintBytes(),this.issuerKeyID=e.getKeyID();const a=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(this.version===6){const h=ms(this.hashAlgorithm);if(this.salt===null)this.salt=yt(h);else if(h!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(s.nonDeterministicSignaturesViaNotation){if(this.rawNotations.filter((({name:h})=>h===wo)).length!==0)throw Error("Unexpected existing salt notation");{const h=yt(ms(this.hashAlgorithm));this.rawNotations.push({name:wo,value:h,humanReadable:!1,critical:!1})}}a.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=A.concat(a);const o=this.toHash(this.signatureType,r,i),c=await this.hash(this.signatureType,r,o,i);this.signedHashValue=Re(Cr(c),0,2);const u=async()=>n3(this.publicKeyAlgorithm,this.hashAlgorithm,e.publicParams,e.privateParams,o,await Ce(c));A.isStream(c)?this.params=u():(this.params=await u(),this[pn]=!0)}writeHashedSubPackets(){const e=d.signatureSubpacket,r=[];let t;if(this.created===null)throw Error("Missing signature creation time");r.push(ce(e.signatureCreationTime,!0,A.writeDate(this.created))),this.signatureExpirationTime!==null&&r.push(ce(e.signatureExpirationTime,!0,A.writeNumber(this.signatureExpirationTime,4))),this.exportable!==null&&r.push(ce(e.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),this.trustLevel!==null&&(t=new Uint8Array([this.trustLevel,this.trustAmount]),r.push(ce(e.trustSignature,!0,t))),this.regularExpression!==null&&r.push(ce(e.regularExpression,!0,this.regularExpression)),this.revocable!==null&&r.push(ce(e.revocable,!0,new Uint8Array([this.revocable?1:0]))),this.keyExpirationTime!==null&&r.push(ce(e.keyExpirationTime,!0,A.writeNumber(this.keyExpirationTime,4))),this.preferredSymmetricAlgorithms!==null&&(t=A.stringToUint8Array(A.uint8ArrayToString(this.preferredSymmetricAlgorithms)),r.push(ce(e.preferredSymmetricAlgorithms,!1,t))),this.revocationKeyClass!==null&&(t=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),t=A.concat([t,this.revocationKeyFingerprint]),r.push(ce(e.revocationKey,!1,t))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&r.push(ce(e.issuerKeyID,!1,this.issuerKeyID.write())),this.rawNotations.forEach((({name:a,value:o,humanReadable:c,critical:u})=>{t=[new Uint8Array([c?128:0,0,0,0])];const h=A.encodeUTF8(a);t.push(A.writeNumber(h.length,2)),t.push(A.writeNumber(o.length,2)),t.push(h),t.push(o),t=A.concat(t),r.push(ce(e.notationData,u,t))})),this.preferredHashAlgorithms!==null&&(t=A.stringToUint8Array(A.uint8ArrayToString(this.preferredHashAlgorithms)),r.push(ce(e.preferredHashAlgorithms,!1,t))),this.preferredCompressionAlgorithms!==null&&(t=A.stringToUint8Array(A.uint8ArrayToString(this.preferredCompressionAlgorithms)),r.push(ce(e.preferredCompressionAlgorithms,!1,t))),this.keyServerPreferences!==null&&(t=A.stringToUint8Array(A.uint8ArrayToString(this.keyServerPreferences)),r.push(ce(e.keyServerPreferences,!1,t))),this.preferredKeyServer!==null&&r.push(ce(e.preferredKeyServer,!1,A.encodeUTF8(this.preferredKeyServer))),this.isPrimaryUserID!==null&&r.push(ce(e.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),this.policyURI!==null&&r.push(ce(e.policyURI,!1,A.encodeUTF8(this.policyURI))),this.keyFlags!==null&&(t=A.stringToUint8Array(A.uint8ArrayToString(this.keyFlags)),r.push(ce(e.keyFlags,!0,t))),this.signersUserID!==null&&r.push(ce(e.signersUserID,!1,A.encodeUTF8(this.signersUserID))),this.reasonForRevocationFlag!==null&&(t=A.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),r.push(ce(e.reasonForRevocation,!0,t))),this.features!==null&&(t=A.stringToUint8Array(A.uint8ArrayToString(this.features)),r.push(ce(e.features,!1,t))),this.signatureTargetPublicKeyAlgorithm!==null&&(t=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],t.push(A.stringToUint8Array(this.signatureTargetHash)),t=A.concat(t),r.push(ce(e.signatureTarget,!0,t))),this.embeddedSignature!==null&&r.push(ce(e.embeddedSignature,!0,this.embeddedSignature.write())),this.issuerFingerprint!==null&&(t=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],t=A.concat(t),r.push(ce(e.issuerFingerprint,this.version>=5,t))),this.preferredAEADAlgorithms!==null&&(t=A.stringToUint8Array(A.uint8ArrayToString(this.preferredAEADAlgorithms)),r.push(ce(e.preferredAEADAlgorithms,!1,t))),this.preferredCipherSuites!==null&&(t=new Uint8Array([].concat(...this.preferredCipherSuites)),r.push(ce(e.preferredCipherSuites,!1,t)));const i=A.concat(r),s=A.writeNumber(i.length,this.version===6?4:2);return A.concat([s,i])}writeUnhashedSubPackets(){const e=this.unhashedSubpackets.map((({type:i,critical:s,body:a})=>ce(i,s,a))),r=A.concat(e),t=A.writeNumber(r.length,this.version===6?4:2);return A.concat([t,r])}readSubPacket(e,r=!0){let t=0;const i=!!(128&e[t]),s=127&e[t];if(t++,r||(this.unhashedSubpackets.push({type:s,critical:i,body:e.subarray(t,e.length)}),w3.has(s)))switch(s){case d.signatureSubpacket.signatureCreationTime:this.created=A.readDate(e.subarray(t,e.length));break;case d.signatureSubpacket.signatureExpirationTime:{const a=A.readNumber(e.subarray(t,e.length));this.signatureNeverExpires=a===0,this.signatureExpirationTime=a;break}case d.signatureSubpacket.exportableCertification:this.exportable=e[t++]===1;break;case d.signatureSubpacket.trustSignature:this.trustLevel=e[t++],this.trustAmount=e[t++];break;case d.signatureSubpacket.regularExpression:this.regularExpression=e[t];break;case d.signatureSubpacket.revocable:this.revocable=e[t++]===1;break;case d.signatureSubpacket.keyExpirationTime:{const a=A.readNumber(e.subarray(t,e.length));this.keyExpirationTime=a,this.keyNeverExpires=a===0;break}case d.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...e.subarray(t,e.length)];break;case d.signatureSubpacket.revocationKey:this.revocationKeyClass=e[t++],this.revocationKeyAlgorithm=e[t++],this.revocationKeyFingerprint=e.subarray(t,t+20);break;case d.signatureSubpacket.issuerKeyID:if(this.version===4)this.issuerKeyID.read(e.subarray(t,e.length));else if(r)throw Error("Unexpected Issuer Key ID subpacket");break;case d.signatureSubpacket.notationData:{const a=!!(128&e[t]);t+=4;const o=A.readNumber(e.subarray(t,t+2));t+=2;const c=A.readNumber(e.subarray(t,t+2));t+=2;const u=A.decodeUTF8(e.subarray(t,t+o)),h=e.subarray(t+o,t+o+c);this.rawNotations.push({name:u,humanReadable:a,value:h,critical:i}),a&&(this.notations[u]=A.decodeUTF8(h));break}case d.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...e.subarray(t,e.length)];break;case d.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...e.subarray(t,e.length)];break;case d.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...e.subarray(t,e.length)];break;case d.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=A.decodeUTF8(e.subarray(t,e.length));break;case d.signatureSubpacket.primaryUserID:this.isPrimaryUserID=e[t++]!==0;break;case d.signatureSubpacket.policyURI:this.policyURI=A.decodeUTF8(e.subarray(t,e.length));break;case d.signatureSubpacket.keyFlags:this.keyFlags=[...e.subarray(t,e.length)];break;case d.signatureSubpacket.signersUserID:this.signersUserID=A.decodeUTF8(e.subarray(t,e.length));break;case d.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=e[t++],this.reasonForRevocationString=A.decodeUTF8(e.subarray(t,e.length));break;case d.signatureSubpacket.features:this.features=[...e.subarray(t,e.length)];break;case d.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=e[t++],this.signatureTargetHashAlgorithm=e[t++];const a=ke(this.signatureTargetHashAlgorithm);this.signatureTargetHash=A.uint8ArrayToString(e.subarray(t,t+a));break}case d.signatureSubpacket.embeddedSignature:this.embeddedSignature=new He,this.embeddedSignature.read(e.subarray(t,e.length));break;case d.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=e[t++],this.issuerFingerprint=e.subarray(t,e.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case d.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...e.subarray(t,e.length)];break;case d.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let a=t;a<e.length;a+=2)this.preferredCipherSuites.push([e[a],e[a+1]]);break;default:this.unknownSubpackets.push({type:s,critical:i,body:e.subarray(t,e.length)})}}readSubPackets(e,r=!0,t){const i=this.version===6?4:2,s=A.readNumber(e.subarray(0,i));let a=i;for(;a<2+s;){const o=wl(e.subarray(a,e.length));a+=o.offset,this.readSubPacket(e.subarray(a,a+o.len),r,t),a+=o.len}return a}toSign(e,r){const t=d.signature;switch(e){case t.binary:return r.text!==null?A.encodeUTF8(r.getText(!0)):r.getBytes(!0);case t.text:{const i=r.getBytes(!0);return A.canonicalizeEOL(i)}case t.standalone:return new Uint8Array(0);case t.certGeneric:case t.certPersona:case t.certCasual:case t.certPositive:case t.certRevocation:{let i,s;if(r.userID)s=180,i=r.userID;else{if(!r.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");s=209,i=r.userAttribute}const a=i.write();return A.concat([this.toSign(t.key,r),new Uint8Array([s]),A.writeNumber(a.length,4),a])}case t.subkeyBinding:case t.subkeyRevocation:case t.keyBinding:return A.concat([this.toSign(t.key,r),this.toSign(t.key,{key:r.bind})]);case t.key:if(r.key===void 0)throw Error("Key packet is required for this signature.");return r.key.writeForHash(this.version);case t.keyRevocation:return this.toSign(t.key,r);case t.timestamp:return new Uint8Array(0);case t.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(e,r){let t=0;return ve(Cr(this.signatureData),(i=>{t+=i.length}),(()=>{const i=[];return this.version!==5||this.signatureType!==d.signature.binary&&this.signatureType!==d.signature.text||(r?i.push(new Uint8Array(6)):i.push(e.writeHeader())),i.push(new Uint8Array([this.version,255])),this.version===5&&i.push(new Uint8Array(4)),i.push(A.writeNumber(t,4)),A.concat(i)}))}toHash(e,r,t=!1){const i=this.toSign(e,r);return A.concat([this.salt||new Uint8Array,i,this.signatureData,this.calculateTrailer(r,t)])}async hash(e,r,t,i=!1){if(this.version===6&&this.salt.length!==ms(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return t||(t=this.toHash(e,r,i)),kr(this.hashAlgorithm,t)}async verify(e,r,t,i=new Date,s=!1,a=$){if(!this.issuerKeyID.equals(e.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const o=r===d.signature.binary||r===d.signature.text;if(!(this[pn]&&!o)){let u,h;if(this.hashed?h=await this.hashed:(u=this.toHash(r,t,s),h=await this.hash(r,t,u)),h=await Ce(h),this.signedHashValue[0]!==h[0]||this.signedHashValue[1]!==h[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[pn]=await r3(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,e.publicParams,u,h),!this[pn])throw Error("Signature verification failed")}const c=A.normalizeDate(i);if(c&&this.created>c)throw Error("Signature creation time is in the future");if(c&&c>=this.getExpirationTime())throw Error("Signature is expired");if(a.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+d.read(d.hash,this.hashAlgorithm).toUpperCase());if(a.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[d.signature.binary,d.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+d.read(d.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach((({type:u,critical:h})=>{if(h)throw Error("Unknown critical signature subpacket type "+u)})),this.rawNotations.forEach((({name:u,critical:h})=>{if(h&&a.knownNotations.indexOf(u)<0)throw Error("Unknown critical notation: "+u)})),this.revocationKeyClass!==null)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(e=new Date){const r=A.normalizeDate(e);return r!==null&&!(this.created<=r&&r<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function ce(n,e,r){const t=[];return t.push(ya(r.length+1)),t.push(new Uint8Array([(e?128:0)|n])),t.push(r),A.concat(t)}function ms(n){switch(n){case d.hash.sha256:return 16;case d.hash.sha384:return 24;case d.hash.sha512:return 32;case d.hash.sha224:case d.hash.sha3_256:return 16;case d.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}class pt{static get tag(){return d.packet.onePassSignature}static fromSignaturePacket(e,r){const t=new pt;return t.version=e.version===6?6:3,t.signatureType=e.signatureType,t.hashAlgorithm=e.hashAlgorithm,t.publicKeyAlgorithm=e.publicKeyAlgorithm,t.issuerKeyID=e.issuerKeyID,t.salt=e.salt,t.issuerFingerprint=e.issuerFingerprint,t.flags=r?1:0,t}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(e){let r=0;if(this.version=e[r++],this.version!==3&&this.version!==6)throw new oe(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=e[r++],this.hashAlgorithm=e[r++],this.publicKeyAlgorithm=e[r++],this.version===6){const t=e[r++];this.salt=e.subarray(r,r+t),r+=t,this.issuerFingerprint=e.subarray(r,r+32),r+=32,this.issuerKeyID=new Ot,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new Ot,this.issuerKeyID.read(e.subarray(r,r+8)),r+=8;return this.flags=e[r++],this}write(){const e=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return this.version===6?e.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):e.push(this.issuerKeyID.write()),e.push(new Uint8Array([this.flags])),A.concatUint8Array(e)}calculateTrailer(...e){return dr((async()=>He.prototype.calculateTrailer.apply(await this.correspondingSig,e)))}async verify(){const e=await this.correspondingSig;if(!e||e.constructor.tag!==d.packet.signature)throw Error("Corresponding signature packet missing");if(e.signatureType!==this.signatureType||e.hashAlgorithm!==this.hashAlgorithm||e.publicKeyAlgorithm!==this.publicKeyAlgorithm||!e.issuerKeyID.equals(this.issuerKeyID)||this.version===3&&e.version===6||this.version===6&&e.version!==6||this.version===6&&!A.equalsUint8Array(e.issuerFingerprint,this.issuerFingerprint)||this.version===6&&!A.equalsUint8Array(e.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return e.hashed=this.hashed,e.verify.apply(e,arguments)}}function m3(n,e){if(!e[n]){let r;try{r=d.read(d.packet,n)}catch{throw new hi("Unknown packet type with tag: "+n)}throw Error("Packet not allowed in this context: "+r)}return new e[n]}pt.prototype.hash=He.prototype.hash,pt.prototype.toHash=He.prototype.toHash,pt.prototype.toSign=He.prototype.toSign;class Ie extends Array{static async fromBinary(e,r,t=$,i=null,s=!1){const a=new Ie;return await a.read(e,r,t,i,s),a}async read(e,r,t=$,i=null,s=!1){let a;t.additionalAllowedPackets.length&&(a=A.constructAllowedPackets(t.additionalAllowedPackets),r={...r,...a}),this.stream=fr(e,(async(c,u)=>{const h=jt(c),l=st(u);try{let f=A.isStream(c);for(;;){let p,y;if(await l.ready,await bl(h,f,(async g=>{try{if(g.tag===d.packet.marker||g.tag===d.packet.trust||g.tag===d.packet.padding)return;const m=m3(g.tag,r);try{i?.recordPacket(g.tag,a)}catch(S){if(t.enforceGrammar)throw S;A.printDebugError(S)}m.packets=new Ie,m.fromStream=A.isStream(g.packet),y=m.fromStream;try{await m.read(g.packet,t)}catch(S){throw S instanceof oe?S:A.wrapError(new cs(`Parsing ${m.constructor.name} failed`),S)}await l.write(m)}catch(m){const S=m instanceof hi&&g.tag<=39,E=m instanceof oe&&!(m instanceof hi)&&!t.ignoreUnsupportedPackets,v=m instanceof cs&&!t.ignoreMalformedPackets,U=ui(g.tag);if(S||E||v||U||!(m instanceof hi||m instanceof oe||m instanceof cs))s?p=m:await l.abort(m);else{const T=new ja(g.tag,g.packet);await l.write(T)}A.printDebugError(m)}})),y&&(f=null),p)throw await h.readToEnd(),p;const w=await h.peekBytes(2);if(!w||!w.length){try{i?.recordEnd()}catch(g){if(t.enforceGrammar)throw g;A.printDebugError(g)}return await l.ready,void await l.close()}}}catch(f){await l.abort(f)}}));const o=jt(this.stream);for(;;){const{done:c,value:u}=await o.read();if(c?this.stream=null:this.push(u),c||ui(u.constructor.tag))break}o.releaseLock()}write(){const e=[];for(let r=0;r<this.length;r++){const t=this[r]instanceof ja?this[r].tag:this[r].constructor.tag,i=this[r].write();if(A.isStream(i)&&ui(this[r].constructor.tag)){let s=[],a=0;const o=512;e.push(Oc(t)),e.push(ve(i,(c=>{if(s.push(c),a+=c.length,a>=o){const u=Math.min(Math.log(a)/Math.LN2|0,30),h=2**u,l=A.concat([ml(u)].concat(s));return s=[l.subarray(1+h)],a=s[0].length,l.subarray(0,1+h)}}),(()=>A.concat([ya(a)].concat(s)))))}else{if(A.isStream(i)){let s=0;e.push(ve(Cr(i),(a=>{s+=a.length}),(()=>Wa(t,s))))}else e.push(Wa(t,i.length));e.push(i)}}return A.concat(e)}filterByTag(...e){const r=new Ie,t=i=>s=>i===s;for(let i=0;i<this.length;i++)e.some(t(this[i].constructor.tag))&&r.push(this[i]);return r}findPacket(e){return this.find((r=>r.constructor.tag===e))}indexOfTag(...e){const r=[],t=this,i=s=>a=>s===a;for(let s=0;s<this.length;s++)e.some(i(t[s].constructor.tag))&&r.push(s);return r}}class Ct extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Ct),this.name="GrammarError"}}var Ee;(function(n){n[n.EmptyMessage=0]="EmptyMessage",n[n.PlaintextOrEncryptedData=1]="PlaintextOrEncryptedData",n[n.EncryptedSessionKeys=2]="EncryptedSessionKeys",n[n.StandaloneAdditionalAllowedData=3]="StandaloneAdditionalAllowedData"})(Ee||(Ee={}));class Ji{constructor(){this.state=Ee.EmptyMessage,this.leadingOnePassSignatureCounter=0}recordPacket(e,r){switch(this.state){case Ee.EmptyMessage:case Ee.StandaloneAdditionalAllowedData:switch(e){case d.packet.literalData:case d.packet.compressedData:case d.packet.aeadEncryptedData:case d.packet.symEncryptedIntegrityProtectedData:case d.packet.symmetricallyEncryptedData:return void(this.state=Ee.PlaintextOrEncryptedData);case d.packet.signature:if(this.state===Ee.StandaloneAdditionalAllowedData&&--this.leadingOnePassSignatureCounter<0)throw new Ct("Trailing signature packet without OPS");return;case d.packet.onePassSignature:if(this.state===Ee.StandaloneAdditionalAllowedData)throw new Ct("OPS following StandaloneAdditionalAllowedData");return void this.leadingOnePassSignatureCounter++;case d.packet.publicKeyEncryptedSessionKey:case d.packet.symEncryptedSessionKey:return void(this.state=Ee.EncryptedSessionKeys);default:if(!r?.[e])throw new Ct(`Unexpected packet ${e} in state ${this.state}`);return void(this.state=Ee.StandaloneAdditionalAllowedData)}case Ee.PlaintextOrEncryptedData:if(e===d.packet.signature){if(--this.leadingOnePassSignatureCounter<0)throw new Ct("Trailing signature packet without OPS");return void(this.state=Ee.PlaintextOrEncryptedData)}if(!r?.[e])throw new Ct(`Unexpected packet ${e} in state ${this.state}`);return void(this.state=Ee.PlaintextOrEncryptedData);case Ee.EncryptedSessionKeys:switch(e){case d.packet.publicKeyEncryptedSessionKey:case d.packet.symEncryptedSessionKey:return void(this.state=Ee.EncryptedSessionKeys);case d.packet.symEncryptedIntegrityProtectedData:case d.packet.aeadEncryptedData:case d.packet.symmetricallyEncryptedData:return void(this.state=Ee.PlaintextOrEncryptedData);case d.packet.signature:if(--this.leadingOnePassSignatureCounter<0)throw new Ct("Trailing signature packet without OPS");return void(this.state=Ee.PlaintextOrEncryptedData);default:if(!r?.[e])throw new Ct(`Unexpected packet ${e} in state ${this.state}`);this.state=Ee.EncryptedSessionKeys}}}recordEnd(){switch(this.state){case Ee.EmptyMessage:case Ee.PlaintextOrEncryptedData:case Ee.EncryptedSessionKeys:case Ee.StandaloneAdditionalAllowedData:if(this.leadingOnePassSignatureCounter>0)throw new Ct("Missing trailing signature packets")}}}const b3=A.constructAllowedPackets([nn,pt,He]);class zn{static get tag(){return d.packet.compressedData}constructor(e=$){this.packets=null,this.algorithm=e.preferredCompressionAlgorithm,this.compressed=null}async read(e,r=$){await Gi(e,(async t=>{this.algorithm=await t.readByte(),this.compressed=t.remainder(),await this.decompress(r)}))}write(){return this.compressed===null&&this.compress(),A.concat([new Uint8Array([this.algorithm]),this.compressed])}async decompress(e=$){const r=d.read(d.compression,this.algorithm),t=S3[r];if(!t)throw Error(r+" decompression not supported");this.packets=await Ie.fromBinary(await t(this.compressed),b3,e,new Ji)}compress(){const e=d.read(d.compression,this.algorithm),r=v3[e];if(!r)throw Error(e+" compression not supported");this.compressed=r(this.packets.write())}}function Ti(n,e){return r=>{if(!A.isStream(r)||xe(r))return dr((()=>Ce(r).then((s=>new Promise(((a,o)=>{const c=new e,u=[];c.ondata=(h,l)=>{u.push(h),l&&a(A.concatUint8Array(u))};try{c.push(s,!0)}catch(h){o(h)}}))))));if(n)try{const s=n();return r.pipeThrough(s)}catch(s){if(s.name!=="TypeError")throw s}const t=r.getReader(),i=new e;return new ReadableStream({async start(s){for(i.ondata=async(a,o)=>{s.enqueue(a),o&&s.close()};;){const{done:a,value:o}=await t.read();if(a)return void i.push(new Uint8Array,!0);o.length&&i.push(o)}}})}}function E3(){return async function(n){const{decode:e}=await Promise.resolve().then((function(){return Rh}));return dr((async()=>e(await Ce(n))))}}const Ri=n=>({compressor:typeof CompressionStream<"u"&&(()=>new CompressionStream(n)),decompressor:typeof DecompressionStream<"u"&&(()=>new DecompressionStream(n))}),v3={zip:Ti(Ri("deflate-raw").compressor,gi),zlib:Ti(Ri("deflate").compressor,y3)},S3={uncompressed:n=>n,zip:Ti(Ri("deflate-raw").decompressor,Ai),zlib:Ti(Ri("deflate").decompressor,g3),bzip2:E3()},x3=A.constructAllowedPackets([nn,zn,pt,He]);class Xr{static get tag(){return d.packet.symEncryptedIntegrityProtectedData}static fromObject({version:e,aeadAlgorithm:r}){if(e!==1&&e!==2)throw Error("Unsupported SEIPD version");const t=new Xr;return t.version=e,e===2&&(t.aeadAlgorithm=r),t}constructor(){this.version=null,this.cipherAlgorithm=null,this.aeadAlgorithm=null,this.chunkSizeByte=null,this.salt=null,this.encrypted=null,this.packets=null}async read(e){await Gi(e,(async r=>{if(this.version=await r.readByte(),this.version!==1&&this.version!==2)throw new oe(`Version ${this.version} of the SEIP packet is unsupported.`);this.version===2&&(this.cipherAlgorithm=await r.readByte(),this.aeadAlgorithm=await r.readByte(),this.chunkSizeByte=await r.readByte(),this.salt=await r.readBytes(32)),this.encrypted=r.remainder()}))}write(){return this.version===2?A.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.salt,this.encrypted]):A.concat([new Uint8Array([this.version]),this.encrypted])}async encrypt(e,r,t=$){const{blockSize:i,keySize:s}=ge(e);if(r.length!==s)throw Error("Unexpected session key size");let a=this.packets.write();if(xe(a)&&(a=await Ce(a)),this.version===2)this.cipherAlgorithm=e,this.salt=yt(32),this.chunkSizeByte=t.aeadChunkSizeByte,this.encrypted=await Ni(this,"encrypt",r,a);else{const o=await h1(e),c=new Uint8Array([211,20]),u=A.concat([o,a,c]),h=await kr(d.hash.sha1,Pn(u)),l=A.concat([u,h]);this.encrypted=await Ki(e,r,l,new Uint8Array(i))}return!0}async decrypt(e,r,t=$){if(r.length!==ge(e).keySize)throw Error("Unexpected session key size");let i,s=Cr(this.encrypted);xe(s)&&(s=await Ce(s));let a=!1;if(this.version===2){if(this.cipherAlgorithm!==e)throw Error("Unexpected session key algorithm");i=await Ni(this,"decrypt",r,s)}else{const{blockSize:o}=ge(e),c=await xa(e,r,s,new Uint8Array(o)),u=Re(Pn(c),-20),h=Re(c,0,-20),l=Promise.all([Ce(await kr(d.hash.sha1,Pn(h))),Ce(u)]).then((([p,y])=>{if(!A.equalsUint8Array(p,y))throw Error("Modification detected.");return new Uint8Array})),f=Re(h,o+2);i=Re(f,0,-2),i=Je([i,dr((()=>l))]),A.isStream(s)&&t.allowUnauthenticatedStream?a=!0:i=await Ce(i)}return this.packets=await Ie.fromBinary(i,x3,t,new Ji,a),!0}}async function Ni(n,e,r,t){const i=n instanceof Xr&&n.version===2,s=!i&&n.constructor.tag===d.packet.aeadEncryptedData;if(!i&&!s)throw Error("Unexpected packet type");const a=$r(n.aeadAlgorithm,s),o=e==="decrypt"?a.tagLength:0,c=e==="encrypt"?a.tagLength:0,u=2**(n.chunkSizeByte+6)+o,h=s?8:0,l=new ArrayBuffer(13+h),f=new Uint8Array(l,0,5+h),p=new Uint8Array(l),y=new DataView(l),w=new Uint8Array(l,5,8);f.set([192|n.constructor.tag,n.version,n.cipherAlgorithm,n.aeadAlgorithm,n.chunkSizeByte],0);let g,m,S=0,E=Promise.resolve(),v=0,U=0;if(i){const{keySize:D}=ge(n.cipherAlgorithm),{ivLength:I}=a,b=new Uint8Array(l,0,5),k=await Br(d.hash.sha256,r,n.salt,b,D+I);r=k.subarray(0,D),g=k.subarray(D),g.fill(0,g.length-8),m=new DataView(g.buffer,g.byteOffset,g.byteLength)}else g=n.iv;const T=await a(n.cipherAlgorithm,r);return fr(t,(async(D,I)=>{if(A.isStream(D)!=="array"){const x=new TransformStream({},{highWaterMark:A.getHardwareConcurrency()*2**(n.chunkSizeByte+6),size:C=>C.length});Ir(x.readable,I),I=x.writable}const b=jt(D),k=st(I);try{for(;;){let x=await b.readBytes(u+o)||new Uint8Array;const C=x.subarray(x.length-o);let B,P,R;if(x=x.subarray(0,x.length-o),i)R=g;else{R=g.slice();for(let K=0;K<8;K++)R[g.length-8+K]^=w[K]}if(!S||x.length?(b.unshift(C),B=T[e](x,R,f),B.catch((()=>{})),U+=x.length-o+c):(y.setInt32(5+h+4,v),B=T[e](C,R,p),B.catch((()=>{})),U+=c,P=!0),v+=x.length-o,E=E.then((()=>B)).then((async K=>{await k.ready,await k.write(K),U-=K.length})).catch((K=>k.abort(K))),(P||U>k.desiredSize)&&await E,P){await k.close();break}i?m.setInt32(g.length-4,++S):y.setInt32(9,++S)}}catch(x){await k.ready.catch((()=>{})),await k.abort(x)}}))}const I3=A.constructAllowedPackets([nn,zn,pt,He]);class C3{static get tag(){return d.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=d.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}async read(e){await Gi(e,(async r=>{const t=await r.readByte();if(t!==1)throw new oe(`Version ${t} of the AEAD-encrypted data packet is not supported.`);this.cipherAlgorithm=await r.readByte(),this.aeadAlgorithm=await r.readByte(),this.chunkSizeByte=await r.readByte();const i=$r(this.aeadAlgorithm,!0);this.iv=await r.readBytes(i.ivLength),this.encrypted=r.remainder()}))}write(){return A.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}async decrypt(e,r,t=$){this.packets=await Ie.fromBinary(await Ni(this,"decrypt",r,Cr(this.encrypted)),I3,t,new Ji)}async encrypt(e,r,t=$){this.cipherAlgorithm=e;const{ivLength:i}=$r(this.aeadAlgorithm,!0);this.iv=yt(i),this.chunkSizeByte=t.aeadChunkSizeByte;const s=this.packets.write();this.encrypted=await Ni(this,"encrypt",r,s)}}class Ln{static get tag(){return d.packet.publicKeyEncryptedSessionKey}constructor(){this.version=null,this.publicKeyID=new Ot,this.publicKeyVersion=null,this.publicKeyFingerprint=null,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}static fromObject({version:e,encryptionKeyPacket:r,anonymousRecipient:t,sessionKey:i,sessionKeyAlgorithm:s}){const a=new Ln;if(e!==3&&e!==6)throw Error("Unsupported PKESK version");return a.version=e,e===6&&(a.publicKeyVersion=t?null:r.version,a.publicKeyFingerprint=t?null:r.getFingerprintBytes()),a.publicKeyID=t?Ot.wildcard():r.getKeyID(),a.publicKeyAlgorithm=r.algorithm,a.sessionKey=i,a.sessionKeyAlgorithm=s,a}read(e){let r=0;if(this.version=e[r++],this.version!==3&&this.version!==6)throw new oe(`Version ${this.version} of the PKESK packet is unsupported.`);if(this.version===6){const t=e[r++];if(t){this.publicKeyVersion=e[r++];const i=t-1;this.publicKeyFingerprint=e.subarray(r,r+i),r+=i,this.publicKeyVersion>=5?this.publicKeyID.read(this.publicKeyFingerprint):this.publicKeyID.read(this.publicKeyFingerprint.subarray(-8))}else this.publicKeyID=Ot.wildcard()}else r+=this.publicKeyID.read(e.subarray(r,r+8));if(this.publicKeyAlgorithm=e[r++],this.encrypted=(function(t,i){let s=0;switch(t){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:return{c:A.readMPI(i.subarray(s))};case d.publicKey.elgamal:{const a=A.readMPI(i.subarray(s));return s+=a.length+2,{c1:a,c2:A.readMPI(i.subarray(s))}}case d.publicKey.ecdh:{const a=A.readMPI(i.subarray(s));s+=a.length+2;const o=new l1;return o.read(i.subarray(s)),{V:a,C:o}}case d.publicKey.x25519:case d.publicKey.x448:{const a=u1(t),o=A.readExactSubarray(i,s,s+a);s+=o.length;const c=new Wi;return c.read(i.subarray(s)),{ephemeralPublicKey:o,C:c}}default:throw new oe("Unknown public key encryption algorithm.")}})(this.publicKeyAlgorithm,e.subarray(r)),this.publicKeyAlgorithm===d.publicKey.x25519||this.publicKeyAlgorithm===d.publicKey.x448){if(this.version===3)this.sessionKeyAlgorithm=d.write(d.symmetric,this.encrypted.C.algorithm);else if(this.encrypted.C.algorithm!==null)throw Error("Unexpected cleartext symmetric algorithm")}}write(){const e=[new Uint8Array([this.version])];return this.version===6?this.publicKeyFingerprint!==null?(e.push(new Uint8Array([this.publicKeyFingerprint.length+1,this.publicKeyVersion])),e.push(this.publicKeyFingerprint)):e.push(new Uint8Array([0])):e.push(this.publicKeyID.write()),e.push(new Uint8Array([this.publicKeyAlgorithm]),Di(this.publicKeyAlgorithm,this.encrypted)),A.concatUint8Array(e)}async encrypt(e){const r=d.write(d.publicKey,this.publicKeyAlgorithm),t=this.version===3?this.sessionKeyAlgorithm:null,i=e.version===5?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),s=mo(this.version,r,t,this.sessionKey);this.encrypted=await Wl(r,t,e.publicParams,s,i)}async decrypt(e,r){if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Decryption error");const t=r?mo(this.version,this.publicKeyAlgorithm,r.sessionKeyAlgorithm,r.sessionKey):null,i=e.version===5?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),s=await jl(this.publicKeyAlgorithm,e.publicParams,e.privateParams,this.encrypted,i,t),{sessionKey:a,sessionKeyAlgorithm:o}=(function(c,u,h,l){switch(u){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:case d.publicKey.elgamal:case d.publicKey.ecdh:{const f=h.subarray(0,h.length-2),p=h.subarray(h.length-2),y=A.writeChecksum(f.subarray(f.length%8)),w=y[0]===p[0]&y[1]===p[1],g=c===6?{sessionKeyAlgorithm:null,sessionKey:f}:{sessionKeyAlgorithm:f[0],sessionKey:f.subarray(1)};if(l){const m=w&g.sessionKeyAlgorithm===l.sessionKeyAlgorithm&g.sessionKey.length===l.sessionKey.length;return{sessionKey:A.selectUint8Array(m,g.sessionKey,l.sessionKey),sessionKeyAlgorithm:c===6?null:A.selectUint8(m,g.sessionKeyAlgorithm,l.sessionKeyAlgorithm)}}if(w&&(c===6||d.read(d.symmetric,g.sessionKeyAlgorithm)))return g;throw Error("Decryption error")}case d.publicKey.x25519:case d.publicKey.x448:return{sessionKeyAlgorithm:null,sessionKey:h};default:throw Error("Unsupported public key algorithm")}})(this.version,this.publicKeyAlgorithm,s,r);if(this.version===3){const c=this.publicKeyAlgorithm!==d.publicKey.x25519&&this.publicKeyAlgorithm!==d.publicKey.x448;if(this.sessionKeyAlgorithm=c?o:this.sessionKeyAlgorithm,a.length!==ge(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}this.sessionKey=a}}function mo(n,e,r,t){switch(e){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:case d.publicKey.elgamal:case d.publicKey.ecdh:return A.concatUint8Array([new Uint8Array(n===6?[]:[r]),t,A.writeChecksum(t.subarray(t.length%8))]);case d.publicKey.x25519:case d.publicKey.x448:return t;default:throw Error("Unsupported public key algorithm")}}class en{static get tag(){return d.packet.symEncryptedSessionKey}constructor(e=$){this.version=e.aeadProtect?6:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=null,this.aeadAlgorithm=d.write(d.aead,e.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(e){let r=0;if(this.version=e[r++],this.version!==4&&this.version!==5&&this.version!==6)throw new oe(`Version ${this.version} of the SKESK packet is unsupported.`);this.version===6&&r++;const t=e[r++];this.version>=5&&(this.aeadAlgorithm=e[r++],this.version===6&&r++);const i=e[r++];if(this.s2k=d1(i),r+=this.s2k.read(e.subarray(r,e.length)),this.version>=5){const s=$r(this.aeadAlgorithm,!0);this.iv=e.subarray(r,r+=s.ivLength)}this.version>=5||r<e.length?(this.encrypted=e.subarray(r,e.length),this.sessionKeyEncryptionAlgorithm=t):this.sessionKeyAlgorithm=t}write(){const e=this.encrypted===null?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm;let r;const t=this.s2k.write();if(this.version===6){const i=t.length,s=3+i+this.iv.length;r=A.concatUint8Array([new Uint8Array([this.version,s,e,this.aeadAlgorithm,i]),t,this.iv,this.encrypted])}else this.version===5?r=A.concatUint8Array([new Uint8Array([this.version,e,this.aeadAlgorithm]),t,this.iv,this.encrypted]):(r=A.concatUint8Array([new Uint8Array([this.version,e]),t]),this.encrypted!==null&&(r=A.concatUint8Array([r,this.encrypted])));return r}async decrypt(e){const r=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:t,keySize:i}=ge(r),s=await this.s2k.produceKey(e,i);if(this.version>=5){const a=$r(this.aeadAlgorithm,!0),o=new Uint8Array([192|en.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),c=this.version===6?await Br(d.hash.sha256,s,new Uint8Array,o,i):s,u=await a(r,c);this.sessionKey=await u.decrypt(this.encrypted,this.iv,o)}else if(this.encrypted!==null){const a=await xa(r,s,this.encrypted,new Uint8Array(t));if(this.sessionKeyAlgorithm=d.write(d.symmetric,a[0]),this.sessionKey=a.subarray(1,a.length),this.sessionKey.length!==ge(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}else this.sessionKey=s}async encrypt(e,r=$){const t=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=t,this.s2k=o3(r),this.s2k.generateSalt();const{blockSize:i,keySize:s}=ge(t),a=await this.s2k.produceKey(e,s);if(this.sessionKey===null&&(this.sessionKey=qs(this.sessionKeyAlgorithm)),this.version>=5){const o=$r(this.aeadAlgorithm);this.iv=yt(o.ivLength);const c=new Uint8Array([192|en.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),u=this.version===6?await Br(d.hash.sha256,a,new Uint8Array,c,s):a,h=await o(t,u);this.encrypted=await h.encrypt(this.sessionKey,this.iv,c)}else{const o=A.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=await Ki(t,a,o,new Uint8Array(i))}}}class Vr{static get tag(){return d.packet.publicKey}constructor(e=new Date,r=$){this.version=r.v6Keys?6:4,this.created=A.normalizeDate(e),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(e){const r=new Vr,{version:t,created:i,algorithm:s,publicParams:a,keyID:o,fingerprint:c}=e;return r.version=t,r.created=i,r.algorithm=s,r.publicParams=a,r.keyID=o,r.fingerprint=c,r}async read(e,r=$){let t=0;if(this.version=e[t++],this.version===5&&!r.enableParsingV5Entities)throw new oe("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version===4||this.version===5||this.version===6){this.created=A.readDate(e.subarray(t,t+4)),t+=4,this.algorithm=e[t++],this.version>=5&&(t+=4);const{read:i,publicParams:s}=(function(a,o){let c=0;switch(a){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:case d.publicKey.rsaSign:{const u=A.readMPI(o.subarray(c));c+=u.length+2;const h=A.readMPI(o.subarray(c));return c+=h.length+2,{read:c,publicParams:{n:u,e:h}}}case d.publicKey.dsa:{const u=A.readMPI(o.subarray(c));c+=u.length+2;const h=A.readMPI(o.subarray(c));c+=h.length+2;const l=A.readMPI(o.subarray(c));c+=l.length+2;const f=A.readMPI(o.subarray(c));return c+=f.length+2,{read:c,publicParams:{p:u,q:h,g:l,y:f}}}case d.publicKey.elgamal:{const u=A.readMPI(o.subarray(c));c+=u.length+2;const h=A.readMPI(o.subarray(c));c+=h.length+2;const l=A.readMPI(o.subarray(c));return c+=l.length+2,{read:c,publicParams:{p:u,g:h,y:l}}}case d.publicKey.ecdsa:{const u=new Yr;c+=u.read(o),fs(u);const h=A.readMPI(o.subarray(c));return c+=h.length+2,{read:c,publicParams:{oid:u,Q:h}}}case d.publicKey.eddsaLegacy:{const u=new Yr;if(c+=u.read(o),fs(u),u.getName()!==d.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let h=A.readMPI(o.subarray(c));return c+=h.length+2,h=A.leftPad(h,33),{read:c,publicParams:{oid:u,Q:h}}}case d.publicKey.ecdh:{const u=new Yr;c+=u.read(o),fs(u);const h=A.readMPI(o.subarray(c));c+=h.length+2;const l=new Vl;return c+=l.read(o.subarray(c)),{read:c,publicParams:{oid:u,Q:h,kdfParams:l}}}case d.publicKey.ed25519:case d.publicKey.ed448:case d.publicKey.x25519:case d.publicKey.x448:{const u=A.readExactSubarray(o,c,c+u1(a));return c+=u.length,{read:c,publicParams:{A:u}}}default:throw new oe("Unknown public key encryption algorithm.")}})(this.algorithm,e.subarray(t));if(this.version===6&&s.oid&&(s.oid.getName()===d.curve.curve25519Legacy||s.oid.getName()===d.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=s,t+=i,await this.computeFingerprintAndKeyID(),t}throw new oe(`Version ${this.version} of the key packet is unsupported.`)}write(){const e=[];e.push(new Uint8Array([this.version])),e.push(A.writeDate(this.created)),e.push(new Uint8Array([this.algorithm]));const r=Di(this.algorithm,this.publicParams);return this.version>=5&&e.push(A.writeNumber(r.length,4)),e.push(r),A.concatUint8Array(e)}writeForHash(e){const r=this.writePublicKey(),t=149+e,i=e>=5?4:2;return A.concatUint8Array([new Uint8Array([t]),A.writeNumber(r.length,i),r])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new Ot,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(this.version!==4)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const e=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=await kr(d.hash.sha256,e);else{if(this.version!==4)throw Error("Unsupported key version");this.fingerprint=await kr(d.hash.sha1,e)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return A.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(e){return this.version===e.version&&A.equalsUint8Array(this.writePublicKey(),e.writePublicKey())}getAlgorithmInfo(){const e={};e.algorithm=d.read(d.publicKey,this.algorithm);const r=this.publicParams.n||this.publicParams.p;return r?e.bits=A.uint8ArrayBitLength(r):this.publicParams.oid&&(e.curve=this.publicParams.oid.getName()),e}}Vr.prototype.readPublicKey=Vr.prototype.read,Vr.prototype.writePublicKey=Vr.prototype.write;const k3=A.constructAllowedPackets([nn,zn,pt,He]);class B3{static get tag(){return d.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(e){this.encrypted=e}write(){return this.encrypted}async decrypt(e,r,t=$){if(!t.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");const{blockSize:i}=ge(e),s=await Ce(Cr(this.encrypted)),a=await xa(e,r,s.subarray(i+2),s.subarray(2,i+2));this.packets=await Ie.fromBinary(a,k3,t)}async encrypt(e,r,t=$){const i=this.packets.write(),{blockSize:s}=ge(e),a=await h1(e),o=await Ki(e,r,a,new Uint8Array(s)),c=await Ki(e,r,i,o.subarray(2));this.encrypted=A.concat([o,c])}}class b1{constructor(e){this.packets=e||new Ie}write(){return this.packets.write()}armor(e=$){const r=this.packets.some((t=>t.constructor.tag===He.tag&&t.version!==6));return Kc(d.armor.signature,this.write(),void 0,void 0,void 0,r,e)}getSigningKeyIDs(){return this.packets.map((e=>e.issuerKeyID))}}async function U3(n,e,r=new Date,t=[],i){const s=d.hash.sha256,a=i.preferredHashAlgorithm,o=await Promise.all(n.map((async(l,f)=>(await l.getPrimarySelfSignature(r,t[f],i)).preferredHashAlgorithms||[]))),c=new Map;for(const l of o)for(const f of l)try{const p=d.write(d.hash,f);c.set(p,c.has(p)?c.get(p)+1:1)}catch{}const u=l=>n.length===0||c.get(l)===n.length||l===s,h=()=>{if(c.size===0)return s;const l=Array.from(c.keys()).filter((f=>u(f))).sort(((f,p)=>ke(f)-ke(p)))[0];return ke(l)>=ke(s)?l:s};if(new Set([d.publicKey.ecdsa,d.publicKey.eddsaLegacy,d.publicKey.ed25519,d.publicKey.ed448]).has(e.algorithm)){const l=(function(y,w){switch(y){case d.publicKey.ecdsa:case d.publicKey.eddsaLegacy:return Rl(w);case d.publicKey.ed25519:case d.publicKey.ed448:return Aa(y);default:throw Error("Unknown elliptic signing algo")}})(e.algorithm,e.publicParams.oid),f=u(a),p=ke(a)>=ke(l);if(f&&p)return a;{const y=h();return ke(y)>=ke(l)?y:l}}return u(a)?a:h()}async function D3(n,e,r,t,i,s,a=[],o=!1,c){if(r.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!r.isDecrypted())throw Error("Signing key is not decrypted.");const u=new He;return Object.assign(u,t),u.publicKeyAlgorithm=r.algorithm,u.hashAlgorithm=await U3(e,r,i,s,c),u.rawNotations=[...a],await u.sign(r,n,i,o,c),u}d.packet.publicKey,d.packet.privateKey;d.packet.publicKey,d.packet.privateKey,d.packet.publicSubkey,d.packet.privateSubkey;const P3=A.constructAllowedPackets([nn,zn,C3,Xr,B3,Ln,en,pt,He]),K3=A.constructAllowedPackets([en]),T3=A.constructAllowedPackets([He]);class lt{constructor(e){this.packets=e||new Ie}getEncryptionKeyIDs(){const e=[];return this.packets.filterByTag(d.packet.publicKeyEncryptedSessionKey).forEach((function(r){e.push(r.publicKeyID)})),e}getSigningKeyIDs(){const e=this.unwrapCompressed(),r=e.packets.filterByTag(d.packet.onePassSignature);return r.length>0?r.map((t=>t.issuerKeyID)):e.packets.filterByTag(d.packet.signature).map((t=>t.issuerKeyID))}async decrypt(e,r,t,i=new Date,s=$){const a=this.packets.filterByTag(d.packet.symmetricallyEncryptedData,d.packet.symEncryptedIntegrityProtectedData,d.packet.aeadEncryptedData);if(a.length===0)throw Error("No encrypted data found");const o=a[0],c=o.cipherAlgorithm,u=t||await this.decryptSessionKeys(e,r,c,i,s);let h=null;const l=Promise.all(u.map((async({algorithm:p,data:y})=>{if(!A.isUint8Array(y)||!o.cipherAlgorithm&&!A.isString(p))throw Error("Invalid session key for decryption.");try{const w=o.cipherAlgorithm||d.write(d.symmetric,p);await o.decrypt(w,y,s)}catch(w){A.printDebugError(w),h=w}})));if(Qs(o.encrypted),o.encrypted=null,await l,!o.packets||!o.packets.length)throw h||Error("Decryption failed.");const f=new lt(o.packets);return o.packets=new Ie,f}async decryptSessionKeys(e,r,t,i=new Date,s=$){let a,o=[];if(r){const c=this.packets.filterByTag(d.packet.symEncryptedSessionKey);if(c.length===0)throw Error("No symmetrically encrypted session key packet found.");await Promise.all(r.map((async function(u,h){let l;l=h?await Ie.fromBinary(c.write(),K3,s):c,await Promise.all(l.map((async function(f){try{await f.decrypt(u),o.push(f)}catch(p){A.printDebugError(p),p instanceof ji&&(a=p)}})))})))}else{if(!e)throw Error("No key or password specified.");{const c=this.packets.filterByTag(d.packet.publicKeyEncryptedSessionKey);if(c.length===0)throw Error("No public key encrypted session key packet found.");await Promise.all(c.map((async function(u){await Promise.all(e.map((async function(h){let l;try{l=(await h.getDecryptionKeys(u.publicKeyID,null,void 0,s)).map((p=>p.keyPacket))}catch(p){return void(a=p)}let f=[d.symmetric.aes256,d.symmetric.aes128,d.symmetric.tripledes,d.symmetric.cast5];try{const p=await h.getPrimarySelfSignature(i,void 0,s);p.preferredSymmetricAlgorithms&&(f=f.concat(p.preferredSymmetricAlgorithms))}catch{}await Promise.all(l.map((async function(p){if(!p.isDecrypted())throw Error("Decryption key is not decrypted.");if(s.constantTimePKCS1Decryption&&(u.publicKeyAlgorithm===d.publicKey.rsaEncrypt||u.publicKeyAlgorithm===d.publicKey.rsaEncryptSign||u.publicKeyAlgorithm===d.publicKey.rsaSign||u.publicKeyAlgorithm===d.publicKey.elgamal)){const y=u.write();await Promise.all((t?[t]:Array.from(s.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms)).map((async w=>{const g=new Ln;g.read(y);const m={sessionKeyAlgorithm:w,sessionKey:qs(w)};try{await g.decrypt(p,m),o.push(g)}catch(S){A.printDebugError(S),a=S}})))}else try{await u.decrypt(p);const y=t||u.sessionKeyAlgorithm;if(y&&!f.includes(d.write(d.symmetric,y)))throw Error("A non-preferred symmetric algorithm was used.");o.push(u)}catch(y){A.printDebugError(y),a=y}})))}))),Qs(u.encrypted),u.encrypted=null})))}}if(o.length>0){if(o.length>1){const c=new Set;o=o.filter((u=>{const h=u.sessionKeyAlgorithm+A.uint8ArrayToString(u.sessionKey);return!c.has(h)&&(c.add(h),!0)}))}return o.map((c=>({data:c.sessionKey,algorithm:c.sessionKeyAlgorithm&&d.read(d.symmetric,c.sessionKeyAlgorithm)})))}throw a||Error("Session key decryption failed.")}getLiteralData(){const e=this.unwrapCompressed().packets.findPacket(d.packet.literalData);return e&&e.getBytes()||null}getFilename(){const e=this.unwrapCompressed().packets.findPacket(d.packet.literalData);return e&&e.getFilename()||null}getText(){const e=this.unwrapCompressed().packets.findPacket(d.packet.literalData);return e?e.getText():null}static async generateSessionKey(e=[],r=new Date,t=[],i=$){const{symmetricAlgo:s,aeadAlgo:a}=await(async function(u=[],h=new Date,l=[],f=$){const p=await Promise.all(u.map(((g,m)=>g.getPrimarySelfSignature(h,l[m],f))));if(u.length?p.every((g=>g.features&&g.features[0]&d.features.seipdv2)):f.aeadProtect){const g={symmetricAlgo:d.symmetric.aes128,aeadAlgo:d.aead.ocb},m=[{symmetricAlgo:f.preferredSymmetricAlgorithm,aeadAlgo:f.preferredAEADAlgorithm},{symmetricAlgo:f.preferredSymmetricAlgorithm,aeadAlgo:d.aead.ocb},{symmetricAlgo:d.symmetric.aes128,aeadAlgo:f.preferredAEADAlgorithm}];for(const S of m)if(p.every((E=>E.preferredCipherSuites&&E.preferredCipherSuites.some((v=>v[0]===S.symmetricAlgo&&v[1]===S.aeadAlgo)))))return S;return g}const y=d.symmetric.aes128,w=f.preferredSymmetricAlgorithm;return{symmetricAlgo:p.every((g=>g.preferredSymmetricAlgorithms&&g.preferredSymmetricAlgorithms.includes(w)))?w:y,aeadAlgo:void 0}})(e,r,t,i),o=d.read(d.symmetric,s),c=a?d.read(d.aead,a):void 0;return await Promise.all(e.map((u=>u.getEncryptionKey().catch((()=>null)).then((h=>{if(h&&(h.keyPacket.algorithm===d.publicKey.x25519||h.keyPacket.algorithm===d.publicKey.x448)&&!c&&!A.isAES(s))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 and X448 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))))),{data:qs(s),algorithm:o,aeadAlgorithm:c}}async encrypt(e,r,t,i=!1,s=[],a=new Date,o=[],c=$){if(t){if(!A.isUint8Array(t.data)||!A.isString(t.algorithm))throw Error("Invalid session key for encryption.")}else if(e&&e.length)t=await lt.generateSessionKey(e,a,o,c);else{if(!r||!r.length)throw Error("No keys, passwords, or session key provided.");t=await lt.generateSessionKey(void 0,void 0,void 0,c)}const{data:u,algorithm:h,aeadAlgorithm:l}=t,f=await lt.encryptSessionKey(u,h,l,e,r,i,s,a,o,c),p=Xr.fromObject({version:l?2:1,aeadAlgorithm:l?d.write(d.aead,l):null});p.packets=this.packets;const y=d.write(d.symmetric,h);return await p.encrypt(y,u,c),f.packets.push(p),p.packets=new Ie,f}static async encryptSessionKey(e,r,t,i,s,a=!1,o=[],c=new Date,u=[],h=$){const l=new Ie,f=d.write(d.symmetric,r),p=t&&d.write(d.aead,t);if(i){const y=await Promise.all(i.map((async function(w,g){const m=await w.getEncryptionKey(o[g],c,u,h),S=Ln.fromObject({version:p?6:3,encryptionKeyPacket:m.keyPacket,anonymousRecipient:a,sessionKey:e,sessionKeyAlgorithm:f});return await S.encrypt(m.keyPacket),delete S.sessionKey,S})));l.push(...y)}if(s){const y=async function(S,E){try{return await S.decrypt(E),1}catch{return 0}},w=(S,E)=>S+E,g=async function(S,E,v,U){const T=new en(h);return T.sessionKey=S,T.sessionKeyAlgorithm=E,v&&(T.aeadAlgorithm=v),await T.encrypt(U,h),h.passwordCollisionCheck&&(await Promise.all(s.map((D=>y(T,D))))).reduce(w)!==1?g(S,E,U):(delete T.sessionKey,T)},m=await Promise.all(s.map((S=>g(e,f,p,S))));l.push(...m)}return new lt(l)}async sign(e=[],r=[],t=null,i=[],s=new Date,a=[],o=[],c=[],u=$){const h=new Ie,l=this.packets.findPacket(d.packet.literalData);if(!l)throw Error("No literal data packet to sign.");const f=await bo(l,e,r,t,i,s,a,o,c,!1,u),p=f.map(((y,w)=>pt.fromSignaturePacket(y,w===0))).reverse();return h.push(...p),h.push(l),h.push(...f),new lt(h)}compress(e,r=$){if(e===d.compression.uncompressed)return this;const t=new zn(r);t.algorithm=e,t.packets=this.packets;const i=new Ie;return i.push(t),new lt(i)}async signDetached(e=[],r=[],t=null,i=[],s=[],a=new Date,o=[],c=[],u=$){const h=this.packets.findPacket(d.packet.literalData);if(!h)throw Error("No literal data packet to sign.");return new b1(await bo(h,e,r,t,i,s,a,o,c,!0,u))}async verify(e,r=new Date,t=$){const i=this.unwrapCompressed(),s=i.packets.filterByTag(d.packet.literalData);if(s.length!==1)throw Error("Can only verify message with one literal data packet.");let a=i.packets;xe(a.stream)&&(a=a.concat(await Ce(a.stream,(u=>u||[]))));const o=a.filterByTag(d.packet.onePassSignature).reverse(),c=a.filterByTag(d.packet.signature);return o.length&&!c.length&&A.isStream(a.stream)&&!xe(a.stream)?(await Promise.all(o.map((async u=>{u.correspondingSig=new Promise(((h,l)=>{u.correspondingSigResolve=h,u.correspondingSigReject=l})),u.signatureData=dr((async()=>(await u.correspondingSig).signatureData)),u.hashed=Ce(await u.hash(u.signatureType,s[0],void 0,!1)),u.hashed.catch((()=>{}))}))),a.stream=fr(a.stream,(async(u,h)=>{const l=jt(u),f=st(h);try{for(let p=0;p<o.length;p++){const{value:y}=await l.read();o[p].correspondingSigResolve(y)}await l.readToEnd(),await f.ready,await f.close()}catch(p){o.forEach((y=>{y.correspondingSigReject(p)})),await f.abort(p)}})),bs(o,s,e,r,!1,t)):bs(c,s,e,r,!1,t)}verifyDetached(e,r,t=new Date,i=$){const s=this.unwrapCompressed().packets.filterByTag(d.packet.literalData);if(s.length!==1)throw Error("Can only verify message with one literal data packet.");return bs(e.packets.filterByTag(d.packet.signature),s,r,t,!0,i)}unwrapCompressed(){const e=this.packets.filterByTag(d.packet.compressedData);return e.length?new lt(e[0].packets):this}async appendSignature(e,r=$){await this.packets.read(A.isUint8Array(e)?e:(await Pc(e)).data,T3,r)}write(){return this.packets.write()}armor(e=$){const r=this.packets[this.packets.length-1],t=r.constructor.tag===Xr.tag?r.version!==2:this.packets.some((i=>i.constructor.tag===He.tag&&i.version!==6));return Kc(d.armor.message,this.write(),null,null,null,t,e)}}async function bo(n,e,r=[],t=null,i=[],s=new Date,a=[],o=[],c=[],u=!1,h=$){const l=new Ie,f=n.text===null?d.signature.binary:d.signature.text;if(await Promise.all(e.map((async(p,y)=>{const w=a[y];if(!p.isPrivate())throw Error("Need private key for signing");const g=await p.getSigningKey(i[y],s,w,h);return D3(n,r.length?r:[p],g.keyPacket,{signatureType:f},s,o,c,u,h)}))).then((p=>{l.push(...p)})),t){const p=t.packets.filterByTag(d.packet.signature);l.push(...p)}return l}async function bs(n,e,r,t=new Date,i=!1,s=$){return Promise.all(n.filter((function(a){return["text","binary"].includes(d.read(d.signature,a.signatureType))})).map((async function(a){return(async function(o,c,u,h=new Date,l=!1,f=$){let p,y;for(const m of u){const S=m.getKeys(o.issuerKeyID);if(S.length>0){p=m,y=S[0];break}}const w=o instanceof pt?o.correspondingSig:o,g={keyID:o.issuerKeyID,verified:(async()=>{if(!y)throw Error("Could not find signing key with key ID "+o.issuerKeyID.toHex());await o.verify(y.keyPacket,o.signatureType,c[0],h,l,f);const m=await w;if(y.getCreationTime()>m.created)throw Error("Key is newer than the signature");try{await p.getSigningKey(y.getKeyID(),m.created,void 0,f)}catch(S){if(!f.allowInsecureVerificationWithReformattedKeys||!S.message.match(/Signature creation time is in the future/))throw S;await p.getSigningKey(y.getKeyID(),h,void 0,f)}return!0})(),signature:(async()=>{const m=await w,S=new Ie;return m&&S.push(m),new b1(S)})()};return g.signature.catch((()=>{})),g.verified.catch((()=>{})),g})(a,e,r,t,i,s)})))}async function Eo({armoredMessage:n,binaryMessage:e,config:r,...t}){r={...$,...r};let i=n||e;if(!i)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(n&&!A.isString(n)&&!A.isStream(n))throw Error("readMessage: options.armoredMessage must be a string or stream");if(e&&!A.isUint8Array(e)&&!A.isStream(e))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");const s=Object.keys(t);if(s.length>0)throw Error("Unknown option: "+s.join(", "));const a=A.isStream(i);if(n){const{type:u,data:h}=await Pc(i);if(u!==d.armor.message)throw Error("Armored text not of type message");i=h}const o=await Ie.fromBinary(i,P3,r,new Ji),c=new lt(o);return c.fromStream=a,c}async function R3({text:n,binary:e,filename:r,date:t=new Date,format:i=n!==void 0?"utf8":"binary",...s}){const a=n!==void 0?n:e;if(a===void 0)throw Error("createMessage: must pass options object containing `text` or `binary`");if(n&&!A.isString(n)&&!A.isStream(n))throw Error("createMessage: options.text must be a string or stream");if(e&&!A.isUint8Array(e)&&!A.isStream(e))throw Error("createMessage: options.binary must be a Uint8Array or stream");const o=Object.keys(s);if(o.length>0)throw Error("Unknown option: "+o.join(", "));const c=A.isStream(a),u=new nn(t);n!==void 0?u.setText(a,d.write(d.literal,i)):u.setBytes(a,d.write(d.literal,i)),r!==void 0&&u.setFilename(r);const h=new Ie;h.push(u);const l=new lt(h);return l.fromStream=c,l}async function N3({message:n,encryptionKeys:e,signingKeys:r,passwords:t,sessionKey:i,format:s="armored",signature:a=null,wildcard:o=!1,signingKeyIDs:c=[],encryptionKeyIDs:u=[],date:h=new Date,signingUserIDs:l=[],encryptionUserIDs:f=[],signatureNotations:p=[],config:y,...w}){if(v1(y={...$,...y}),E1(n),L3(s),e=ut(e),r=ut(r),t=ut(t),c=ut(c),u=ut(u),l=ut(l),f=ut(f),p=ut(p),w.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(w.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(w.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(w.armor!==void 0)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");const g=Object.keys(w);if(g.length>0)throw Error("Unknown option: "+g.join(", "));r||(r=[]);try{if((r.length||a)&&(n=await n.sign(r,e,a,c,h,l,u,p,y)),n=n.compress(await(async function(S=[],E=new Date,v=[],U=$){const T=d.compression.uncompressed,D=U.preferredCompressionAlgorithm;return(await Promise.all(S.map((async function(b,k){const x=(await b.getPrimarySelfSignature(E,v[k],U)).preferredCompressionAlgorithms;return!!x&&x.indexOf(D)>=0})))).every(Boolean)?D:T})(e,h,f,y),y),n=await n.encrypt(e,t,i,o,u,h,f,y),s==="object")return n;const m=s==="armored"?n.armor(y):n.write();return await S1(m)}catch(m){throw A.wrapError("Error encrypting message",m)}}async function O3({message:n,decryptionKeys:e,passwords:r,sessionKeys:t,verificationKeys:i,expectSigned:s=!1,format:a="utf8",signature:o=null,date:c=new Date,config:u,...h}){if(v1(u={...$,...u}),E1(n),i=ut(i),e=ut(e),r=ut(r),t=ut(t),h.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(h.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");const l=Object.keys(h);if(l.length>0)throw Error("Unknown option: "+l.join(", "));try{const f=await n.decrypt(e,r,t,c,u);i||(i=[]);const p={};if(p.signatures=o?await f.verifyDetached(o,i,c,u):await f.verify(i,c,u),p.data=a==="binary"?f.getLiteralData():f.getText(),p.filename=f.getFilename(),F3(p,n,...new Set([f,f.unwrapCompressed()])),s){if(i.length===0)throw Error("Verification keys are required to verify message signatures");if(p.signatures.length===0)throw Error("Message is not signed");p.data=Je([p.data,dr((async()=>(await A.anyPromise(p.signatures.map((y=>y.verified))),a==="binary"?new Uint8Array:"")))])}return p.data=await S1(p.data),p}catch(f){throw A.wrapError("Error decrypting message",f)}}function E1(n){if(!(n instanceof lt))throw Error("Parameter [message] needs to be of type Message")}function L3(n){if(n!=="armored"&&n!=="binary"&&n!=="object")throw Error("Unsupported format "+n)}const Q3=Object.keys($).length;function v1(n){const e=Object.keys(n);if(e.length!==Q3){for(const r of e)if($[r]===void 0)throw Error("Unknown config property: "+r)}}function ut(n){return n&&!A.isArray(n)&&(n=[n]),n}async function S1(n){return A.isStream(n)==="array"?Ce(n):n}function F3(n,e,...r){n.data=fr(e.packets.stream,(async(t,i)=>{await Ir(n.data,i,{preventClose:!0});const s=st(i);try{await Ce(t,(a=>a)),await Promise.all(r.map((a=>Ce(a.packets.stream,(o=>o))))),await s.close()}catch(a){await s.abort(a)}}))}const Or=typeof Qe=="object"&&"crypto"in Qe?Qe.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function _n(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function Qn(n){if(!Number.isSafeInteger(n)||n<0)throw Error("positive integer expected, got "+n)}function Lt(n,...e){if(!_n(n))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw Error("Uint8Array expected of length "+e+", got length="+n.length)}function x1(n){if(typeof n!="function"||typeof n.create!="function")throw Error("Hash should be wrapped by utils.createHasher");Qn(n.outputLen),Qn(n.blockLen)}function tn(n,e=!0){if(n.destroyed)throw Error("Hash instance has been destroyed");if(e&&n.finished)throw Error("Hash#digest() has already been called")}function I1(n,e){Lt(n);const r=e.outputLen;if(n.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function gt(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function Es(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function St(n,e){return n<<32-e|n>>>e}function lr(n,e){return n<<e|n>>>32-e>>>0}const vo=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68?n=>n:function(n){for(let r=0;r<n.length;r++)n[r]=(e=n[r])<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;var e;return n},C1=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",M3=Array.from({length:256},((n,e)=>e.toString(16).padStart(2,"0")));function xr(n){if(Lt(n),C1)return n.toHex();let e="";for(let r=0;r<n.length;r++)e+=M3[n[r]];return e}const So=48,G3=57,xo=65,H3=70,Io=97,z3=102;function Co(n){return n>=So&&n<=G3?n-So:n>=xo&&n<=H3?n-(xo-10):n>=Io&&n<=z3?n-(Io-10):void 0}function Oi(n){if(typeof n!="string")throw Error("hex string expected, got "+typeof n);if(C1)return Uint8Array.fromHex(n);const e=n.length,r=e/2;if(e%2)throw Error("hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const a=Co(n.charCodeAt(s)),o=Co(n.charCodeAt(s+1));if(a===void 0||o===void 0){const c=n[s]+n[s+1];throw Error('hex string expected, got non-hex character "'+c+'" at index '+s)}t[i]=16*a+o}return t}function Vn(n){return typeof n=="string"&&(n=(function(e){if(typeof e!="string")throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))})(n)),Lt(n),n}function mt(...n){let e=0;for(let t=0;t<n.length;t++){const i=n[t];Lt(i),e+=i.length}const r=new Uint8Array(e);for(let t=0,i=0;t<n.length;t++){const s=n[t];r.set(s,i),i+=s.length}return r}class ka{}function Zt(n){const e=t=>n().update(Vn(t)).digest(),r=n();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>n(),e}const _3=Zt;function $i(n=32){if(Or&&typeof Or.getRandomValues=="function")return Or.getRandomValues(new Uint8Array(n));if(Or&&typeof Or.randomBytes=="function")return Uint8Array.from(Or.randomBytes(n));throw Error("crypto.getRandomValues must be defined")}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ba=BigInt(0),ra=BigInt(1);function Dr(n,e=""){if(typeof n!="boolean")throw Error((e&&`"${e}"`)+"expected boolean, got type="+typeof n);return n}function Et(n,e,r=""){const t=_n(n),i=n?.length,s=e!==void 0;if(!t||s&&i!==e)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(s?" of length "+e:"")+", got "+(t?"length="+i:"type="+typeof n));return n}function Xn(n){const e=n.toString(16);return 1&e.length?"0"+e:e}function k1(n){if(typeof n!="string")throw Error("hex string expected, got "+typeof n);return n===""?Ba:BigInt("0x"+n)}function Zi(n){return k1(xr(n))}function Pr(n){return Lt(n),k1(xr(Uint8Array.from(n).reverse()))}function Ua(n,e){return Oi(n.toString(16).padStart(2*e,"0"))}function Da(n,e){return Ua(n,e).reverse()}function pe(n,e,r){let t;if(typeof e=="string")try{t=Oi(e)}catch(s){throw Error(n+" must be hex string or Uint8Array, cause: "+s)}else{if(!_n(e))throw Error(n+" must be hex string or Uint8Array");t=Uint8Array.from(e)}const i=t.length;if(typeof r=="number"&&i!==r)throw Error(n+" of length "+r+" expected, got "+i);return t}function ko(n){return Uint8Array.from(n)}const vs=n=>typeof n=="bigint"&&Ba<=n;function Fn(n,e,r,t){if(!(function(i,s,a){return vs(i)&&vs(s)&&vs(a)&&s<=i&&i<a})(e,r,t))throw Error("expected valid "+n+": "+r+" <= n < "+t+", got "+e)}function B1(n){let e;for(e=0;n>Ba;n>>=ra,e+=1);return e}const Wn=n=>(ra<<BigInt(n))-ra;function sn(n,e,r={}){if(!n||typeof n!="object")throw Error("expected valid options object");function t(i,s,a){const o=n[i];if(a&&o===void 0)return;const c=typeof o;if(c!==s||o===null)throw Error(`param "${i}" is invalid: expected ${s}, got ${c}`)}Object.entries(e).forEach((([i,s])=>t(i,s,!1))),Object.entries(r).forEach((([i,s])=>t(i,s,!0)))}function Li(n){const e=new WeakMap;return(r,...t)=>{const i=e.get(r);if(i!==void 0)return i;const s=n(r,...t);return e.set(r,s),s}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const qe=BigInt(0),Ge=BigInt(1),br=BigInt(2),U1=BigInt(3),D1=BigInt(4),P1=BigInt(5),V3=BigInt(7),K1=BigInt(8),W3=BigInt(9),Bo=BigInt(16);function Be(n,e){const r=n%e;return r>=qe?r:e+r}function de(n,e,r){let t=n;for(;e-- >qe;)t*=t,t%=r;return t}function Uo(n,e){if(n===qe)throw Error("invert: expected non-zero number");if(e<=qe)throw Error("invert: expected positive modulus, got "+e);let r=Be(n,e),t=e,i=qe,s=Ge;for(;r!==qe;){const a=t%r,o=i-s*(t/r);t=r,r=a,i=s,s=o}if(t!==Ge)throw Error("invert: does not exist");return Be(i,e)}function Pa(n,e,r){if(!n.eql(n.sqr(e),r))throw Error("Cannot find square root")}function T1(n,e){const r=(n.ORDER+Ge)/D1,t=n.pow(e,r);return Pa(n,t,e),t}function j3(n,e){const r=(n.ORDER-P1)/K1,t=n.mul(e,br),i=n.pow(t,r),s=n.mul(e,i),a=n.mul(n.mul(s,br),i),o=n.mul(s,n.sub(a,n.ONE));return Pa(n,o,e),o}function Do(n){if(n<U1)throw Error("sqrt is not defined for small field");let e=n-Ge,r=0;for(;e%br===qe;)e/=br,r++;let t=br;const i=et(n);for(;Po(i,t)===1;)if(t++>1e3)throw Error("Cannot find square root: probably non-prime P");if(r===1)return T1;let s=i.pow(t,e);const a=(e+Ge)/br;return function(o,c){if(o.is0(c))return c;if(Po(o,c)!==1)throw Error("Cannot find square root");let u=r,h=o.mul(o.ONE,s),l=o.pow(c,e),f=o.pow(c,a);for(;!o.eql(l,o.ONE);){if(o.is0(l))return o.ZERO;let p=1,y=o.sqr(l);for(;!o.eql(y,o.ONE);)if(p++,y=o.sqr(y),p===u)throw Error("Cannot find square root");const w=Ge<<BigInt(u-p-1),g=o.pow(h,w);u=p,h=o.sqr(g),l=o.mul(l,h),f=o.mul(f,g)}return f}}function q3(n){return n%D1===U1?T1:n%K1===P1?j3:n%Bo===W3?(function(e){const r=et(e),t=Do(e),i=t(r,r.neg(r.ONE)),s=t(r,i),a=t(r,r.neg(i)),o=(e+V3)/Bo;return(c,u)=>{let h=c.pow(u,o),l=c.mul(h,i);const f=c.mul(h,s),p=c.mul(h,a),y=c.eql(c.sqr(l),u),w=c.eql(c.sqr(f),u);h=c.cmov(h,l,y),l=c.cmov(p,f,w);const g=c.eql(c.sqr(l),u),m=c.cmov(h,l,g);return Pa(c,m,u),m}})(n):Do(n)}const Y3=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function R1(n,e,r=!1){const t=Array(e.length).fill(r?n.ZERO:void 0),i=e.reduce(((a,o,c)=>n.is0(o)?a:(t[c]=a,n.mul(a,o))),n.ONE),s=n.inv(i);return e.reduceRight(((a,o,c)=>n.is0(o)?a:(t[c]=n.mul(a,t[c]),n.mul(a,o))),s),t}function Po(n,e){const r=(n.ORDER-Ge)/br,t=n.pow(e,r),i=n.eql(t,n.ONE),s=n.eql(t,n.ZERO),a=n.eql(t,n.neg(n.ONE));if(!i&&!s&&!a)throw Error("invalid Legendre symbol result");return i?1:s?0:-1}function N1(n,e){e!==void 0&&Qn(e);const r=e!==void 0?e:n.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function et(n,e,r=!1,t={}){if(n<=qe)throw Error("invalid field: expected ORDER > 0, got "+n);let i,s,a,o=!1;if(typeof e=="object"&&e!=null){if(t.sqrt||r)throw Error("cannot specify opts in two arguments");const f=e;f.BITS&&(i=f.BITS),f.sqrt&&(s=f.sqrt),typeof f.isLE=="boolean"&&(r=f.isLE),typeof f.modFromBytes=="boolean"&&(o=f.modFromBytes),a=f.allowedLengths}else typeof e=="number"&&(i=e),t.sqrt&&(s=t.sqrt);const{nBitLength:c,nByteLength:u}=N1(n,i);if(u>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let h;const l=Object.freeze({ORDER:n,isLE:r,BITS:c,BYTES:u,MASK:Wn(c),ZERO:qe,ONE:Ge,allowedLengths:a,create:f=>Be(f,n),isValid:f=>{if(typeof f!="bigint")throw Error("invalid field element: expected bigint, got "+typeof f);return qe<=f&&f<n},is0:f=>f===qe,isValidNot0:f=>!l.is0(f)&&l.isValid(f),isOdd:f=>(f&Ge)===Ge,neg:f=>Be(-f,n),eql:(f,p)=>f===p,sqr:f=>Be(f*f,n),add:(f,p)=>Be(f+p,n),sub:(f,p)=>Be(f-p,n),mul:(f,p)=>Be(f*p,n),pow:(f,p)=>(function(y,w,g){if(g<qe)throw Error("invalid exponent, negatives unsupported");if(g===qe)return y.ONE;if(g===Ge)return w;let m=y.ONE,S=w;for(;g>qe;)g&Ge&&(m=y.mul(m,S)),S=y.sqr(S),g>>=Ge;return m})(l,f,p),div:(f,p)=>Be(f*Uo(p,n),n),sqrN:f=>f*f,addN:(f,p)=>f+p,subN:(f,p)=>f-p,mulN:(f,p)=>f*p,inv:f=>Uo(f,n),sqrt:s||(f=>(h||(h=q3(n)),h(l,f))),toBytes:f=>r?Da(f,u):Ua(f,u),fromBytes:(f,p=!0)=>{if(a){if(!a.includes(f.length)||f.length>u)throw Error("Field.fromBytes: expected "+a+" bytes, got "+f.length);const w=new Uint8Array(u);w.set(f,r?0:w.length-f.length),f=w}if(f.length!==u)throw Error("Field.fromBytes: expected "+u+" bytes, got "+f.length);let y=r?Pr(f):Zi(f);if(o&&(y=Be(y,n)),!p&&!l.isValid(y))throw Error("invalid field element: outside of range 0..ORDER");return y},invertBatch:f=>R1(l,f),cmov:(f,p,y)=>y?p:f});return Object.freeze(l)}function O1(n){if(typeof n!="bigint")throw Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function Ko(n){const e=O1(n);return e+Math.ceil(e/2)}function L1(n,e,r){return n&e^~n&r}function Q1(n,e,r){return n&e^n&r^e&r}class jn extends ka{constructor(e,r,t,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=t,this.isLE=i,this.buffer=new Uint8Array(e),this.view=Es(this.buffer)}update(e){tn(this),Lt(e=Vn(e));const{view:r,buffer:t,blockLen:i}=this,s=e.length;for(let a=0;a<s;){const o=Math.min(i-this.pos,s-a);if(o!==i)t.set(e.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===i&&(this.process(r,0),this.pos=0);else{const c=Es(e);for(;i<=s-a;a+=i)this.process(c,a)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){tn(this),I1(e,this),this.finished=!0;const{buffer:r,view:t,blockLen:i,isLE:s}=this;let{pos:a}=this;r[a++]=128,gt(this.buffer.subarray(a)),this.padOffset>i-a&&(this.process(t,0),a=0);for(let l=a;l<i;l++)r[l]=0;(function(l,f,p,y){if(typeof l.setBigUint64=="function")return l.setBigUint64(f,p,y);const w=BigInt(32),g=BigInt(4294967295),m=Number(p>>w&g),S=Number(p&g),E=y?4:0,v=y?0:4;l.setUint32(f+E,m,y),l.setUint32(f+v,S,y)})(t,i-8,BigInt(8*this.length),s),this.process(t,0);const o=Es(e),c=this.outputLen;if(c%4)throw Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,h=this.get();if(u>h.length)throw Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)o.setUint32(4*l,h[l],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const t=e.slice(0,r);return this.destroy(),t}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:t,length:i,finished:s,destroyed:a,pos:o}=this;return e.destroyed=a,e.finished=s,e.length=i,e.pos=o,i%r&&e.buffer.set(t),e}clone(){return this._cloneInto()}}const Xt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),er=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),Ne=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Oe=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),ei=BigInt(2**32-1),To=BigInt(32);function J3(n,e=!1){return e?{h:Number(n&ei),l:Number(n>>To&ei)}:{h:0|Number(n>>To&ei),l:0|Number(n&ei)}}function F1(n,e=!1){const r=n.length;let t=new Uint32Array(r),i=new Uint32Array(r);for(let s=0;s<r;s++){const{h:a,l:o}=J3(n[s],e);[t[s],i[s]]=[a,o]}return[t,i]}const Ro=(n,e,r)=>n>>>r,No=(n,e,r)=>n<<32-r|e>>>r,Lr=(n,e,r)=>n>>>r|e<<32-r,Qr=(n,e,r)=>n<<32-r|e>>>r,ti=(n,e,r)=>n<<64-r|e>>>r-32,ri=(n,e,r)=>n>>>r-32|e<<64-r;function Mt(n,e,r,t){const i=(e>>>0)+(t>>>0);return{h:n+r+(i/2**32|0)|0,l:0|i}}const $3=(n,e,r)=>(n>>>0)+(e>>>0)+(r>>>0),Z3=(n,e,r,t)=>e+r+t+(n/2**32|0)|0,X3=(n,e,r,t)=>(n>>>0)+(e>>>0)+(r>>>0)+(t>>>0),eu=(n,e,r,t,i)=>e+r+t+i+(n/2**32|0)|0,tu=(n,e,r,t,i)=>(n>>>0)+(e>>>0)+(r>>>0)+(t>>>0)+(i>>>0),ru=(n,e,r,t,i,s)=>e+r+t+i+s+(n/2**32|0)|0,nu=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),tr=new Uint32Array(64);class M1 extends jn{constructor(e=32){super(64,e,8,!1),this.A=0|Xt[0],this.B=0|Xt[1],this.C=0|Xt[2],this.D=0|Xt[3],this.E=0|Xt[4],this.F=0|Xt[5],this.G=0|Xt[6],this.H=0|Xt[7]}get(){const{A:e,B:r,C:t,D:i,E:s,F:a,G:o,H:c}=this;return[e,r,t,i,s,a,o,c]}set(e,r,t,i,s,a,o,c){this.A=0|e,this.B=0|r,this.C=0|t,this.D=0|i,this.E=0|s,this.F=0|a,this.G=0|o,this.H=0|c}process(e,r){for(let l=0;l<16;l++,r+=4)tr[l]=e.getUint32(r,!1);for(let l=16;l<64;l++){const f=tr[l-15],p=tr[l-2],y=St(f,7)^St(f,18)^f>>>3,w=St(p,17)^St(p,19)^p>>>10;tr[l]=w+tr[l-7]+y+tr[l-16]|0}let{A:t,B:i,C:s,D:a,E:o,F:c,G:u,H:h}=this;for(let l=0;l<64;l++){const f=h+(St(o,6)^St(o,11)^St(o,25))+L1(o,c,u)+nu[l]+tr[l]|0,p=(St(t,2)^St(t,13)^St(t,22))+Q1(t,i,s)|0;h=u,u=c,c=o,o=a+f|0,a=s,s=i,i=t,t=f+p|0}t=t+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,c=c+this.F|0,u=u+this.G|0,h=h+this.H|0,this.set(t,i,s,a,o,c,u,h)}roundClean(){gt(tr)}destroy(){this.set(0,0,0,0,0,0,0,0),gt(this.buffer)}}class iu extends M1{constructor(){super(28),this.A=0|er[0],this.B=0|er[1],this.C=0|er[2],this.D=0|er[3],this.E=0|er[4],this.F=0|er[5],this.G=0|er[6],this.H=0|er[7]}}const G1=F1(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((n=>BigInt(n)))),su=G1[0],au=G1[1],rr=new Uint32Array(80),nr=new Uint32Array(80);class H1 extends jn{constructor(e=64){super(128,e,16,!1),this.Ah=0|Oe[0],this.Al=0|Oe[1],this.Bh=0|Oe[2],this.Bl=0|Oe[3],this.Ch=0|Oe[4],this.Cl=0|Oe[5],this.Dh=0|Oe[6],this.Dl=0|Oe[7],this.Eh=0|Oe[8],this.El=0|Oe[9],this.Fh=0|Oe[10],this.Fl=0|Oe[11],this.Gh=0|Oe[12],this.Gl=0|Oe[13],this.Hh=0|Oe[14],this.Hl=0|Oe[15]}get(){const{Ah:e,Al:r,Bh:t,Bl:i,Ch:s,Cl:a,Dh:o,Dl:c,Eh:u,El:h,Fh:l,Fl:f,Gh:p,Gl:y,Hh:w,Hl:g}=this;return[e,r,t,i,s,a,o,c,u,h,l,f,p,y,w,g]}set(e,r,t,i,s,a,o,c,u,h,l,f,p,y,w,g){this.Ah=0|e,this.Al=0|r,this.Bh=0|t,this.Bl=0|i,this.Ch=0|s,this.Cl=0|a,this.Dh=0|o,this.Dl=0|c,this.Eh=0|u,this.El=0|h,this.Fh=0|l,this.Fl=0|f,this.Gh=0|p,this.Gl=0|y,this.Hh=0|w,this.Hl=0|g}process(e,r){for(let E=0;E<16;E++,r+=4)rr[E]=e.getUint32(r),nr[E]=e.getUint32(r+=4);for(let E=16;E<80;E++){const v=0|rr[E-15],U=0|nr[E-15],T=Lr(v,U,1)^Lr(v,U,8)^Ro(v,0,7),D=Qr(v,U,1)^Qr(v,U,8)^No(v,U,7),I=0|rr[E-2],b=0|nr[E-2],k=Lr(I,b,19)^ti(I,b,61)^Ro(I,0,6),x=Qr(I,b,19)^ri(I,b,61)^No(I,b,6),C=X3(D,x,nr[E-7],nr[E-16]),B=eu(C,T,k,rr[E-7],rr[E-16]);rr[E]=0|B,nr[E]=0|C}let{Ah:t,Al:i,Bh:s,Bl:a,Ch:o,Cl:c,Dh:u,Dl:h,Eh:l,El:f,Fh:p,Fl:y,Gh:w,Gl:g,Hh:m,Hl:S}=this;for(let E=0;E<80;E++){const v=Lr(l,f,14)^Lr(l,f,18)^ti(l,f,41),U=Qr(l,f,14)^Qr(l,f,18)^ri(l,f,41),T=l&p^~l&w,D=tu(S,U,f&y^~f&g,au[E],nr[E]),I=ru(D,m,v,T,su[E],rr[E]),b=0|D,k=Lr(t,i,28)^ti(t,i,34)^ti(t,i,39),x=Qr(t,i,28)^ri(t,i,34)^ri(t,i,39),C=t&s^t&o^s&o,B=i&a^i&c^a&c;m=0|w,S=0|g,w=0|p,g=0|y,p=0|l,y=0|f,{h:l,l:f}=Mt(0|u,0|h,0|I,0|b),u=0|o,h=0|c,o=0|s,c=0|a,s=0|t,a=0|i;const P=$3(b,x,B);t=Z3(P,I,k,C),i=0|P}({h:t,l:i}=Mt(0|this.Ah,0|this.Al,0|t,0|i)),{h:s,l:a}=Mt(0|this.Bh,0|this.Bl,0|s,0|a),{h:o,l:c}=Mt(0|this.Ch,0|this.Cl,0|o,0|c),{h:u,l:h}=Mt(0|this.Dh,0|this.Dl,0|u,0|h),{h:l,l:f}=Mt(0|this.Eh,0|this.El,0|l,0|f),{h:p,l:y}=Mt(0|this.Fh,0|this.Fl,0|p,0|y),{h:w,l:g}=Mt(0|this.Gh,0|this.Gl,0|w,0|g),{h:m,l:S}=Mt(0|this.Hh,0|this.Hl,0|m,0|S),this.set(t,i,s,a,o,c,u,h,l,f,p,y,w,g,m,S)}roundClean(){gt(rr,nr)}destroy(){gt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class ou extends H1{constructor(){super(48),this.Ah=0|Ne[0],this.Al=0|Ne[1],this.Bh=0|Ne[2],this.Bl=0|Ne[3],this.Ch=0|Ne[4],this.Cl=0|Ne[5],this.Dh=0|Ne[6],this.Dl=0|Ne[7],this.Eh=0|Ne[8],this.El=0|Ne[9],this.Fh=0|Ne[10],this.Fl=0|Ne[11],this.Gh=0|Ne[12],this.Gl=0|Ne[13],this.Hh=0|Ne[14],this.Hl=0|Ne[15]}}const Ka=Zt((()=>new M1)),cu=Zt((()=>new iu)),z1=Zt((()=>new H1)),_1=Zt((()=>new ou));class V1 extends ka{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,x1(e);const t=Vn(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(t.length>i?e.create().update(t).digest():t);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=e.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),gt(s)}update(e){return tn(this),this.iHash.update(e),this}digestInto(e){tn(this),Lt(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:t,finished:i,destroyed:s,blockLen:a,outputLen:o}=this;return e.finished=i,e.destroyed=s,e.blockLen=a,e.outputLen=o,e.oHash=r._cloneInto(e.oHash),e.iHash=t._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const W1=(n,e,r)=>new V1(n,e).update(r).digest();W1.create=(n,e)=>new V1(n,e);const rn=BigInt(0),Er=BigInt(1);function Qi(n,e){const r=e.negate();return n?r:e}function vr(n,e){const r=R1(n.Fp,e.map((t=>t.Z)));return e.map(((t,i)=>n.fromAffine(t.toAffine(r[i]))))}function j1(n,e){if(!Number.isSafeInteger(n)||n<=0||n>e)throw Error("invalid window size, expected [1.."+e+"], got W="+n)}function Ss(n,e){j1(n,e);const r=2**n;return{windows:Math.ceil(e/n)+1,windowSize:2**(n-1),mask:Wn(n),maxNumber:r,shiftBy:BigInt(n)}}function Oo(n,e,r){const{windowSize:t,mask:i,maxNumber:s,shiftBy:a}=r;let o=Number(n&i),c=n>>a;o>t&&(o-=s,c+=Er);const u=e*t;return{nextN:c,offset:u+Math.abs(o)-1,isZero:o===0,isNeg:o<0,isNegF:e%2!=0,offsetF:u}}const xs=new WeakMap,q1=new WeakMap;function Is(n){return q1.get(n)||1}function Lo(n){if(n!==rn)throw Error("invalid wNAF")}class Y1{constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,t=this.ZERO){let i=e;for(;r>rn;)r&Er&&(t=t.add(i)),i=i.double(),r>>=Er;return t}precomputeWindow(e,r){const{windows:t,windowSize:i}=Ss(r,this.bits),s=[];let a=e,o=a;for(let c=0;c<t;c++){o=a,s.push(o);for(let u=1;u<i;u++)o=o.add(a),s.push(o);a=o.double()}return s}wNAF(e,r,t){if(!this.Fn.isValid(t))throw Error("invalid scalar");let i=this.ZERO,s=this.BASE;const a=Ss(e,this.bits);for(let o=0;o<a.windows;o++){const{nextN:c,offset:u,isZero:h,isNeg:l,isNegF:f,offsetF:p}=Oo(t,o,a);t=c,h?s=s.add(Qi(f,r[p])):i=i.add(Qi(l,r[u]))}return Lo(t),{p:i,f:s}}wNAFUnsafe(e,r,t,i=this.ZERO){const s=Ss(e,this.bits);for(let a=0;a<s.windows&&t!==rn;a++){const{nextN:o,offset:c,isZero:u,isNeg:h}=Oo(t,a,s);if(t=o,!u){const l=r[c];i=i.add(h?l.negate():l)}}return Lo(t),i}getPrecomputes(e,r,t){let i=xs.get(r);return i||(i=this.precomputeWindow(r,e),e!==1&&(typeof t=="function"&&(i=t(i)),xs.set(r,i))),i}cached(e,r,t){const i=Is(e);return this.wNAF(i,this.getPrecomputes(i,e,t),r)}unsafe(e,r,t,i){const s=Is(e);return s===1?this._unsafeLadder(e,r,i):this.wNAFUnsafe(s,this.getPrecomputes(s,e,t),r,i)}createCache(e,r){j1(r,this.bits),q1.set(e,r),xs.delete(e)}hasCache(e){return Is(e)!==1}}function J1(n,e,r,t){(function(f,p){if(!Array.isArray(f))throw Error("array expected");f.forEach(((y,w)=>{if(!(y instanceof p))throw Error("invalid point at index "+w)}))})(r,n),(function(f,p){if(!Array.isArray(f))throw Error("array of scalars expected");f.forEach(((y,w)=>{if(!p.isValid(y))throw Error("invalid scalar at index "+w)}))})(t,e);const i=r.length,s=t.length;if(i!==s)throw Error("arrays of points and scalars must have equal length");const a=n.ZERO,o=B1(BigInt(i));let c=1;o>12?c=o-3:o>4?c=o-2:o>0&&(c=2);const u=Wn(c),h=Array(Number(u)+1).fill(a);let l=a;for(let f=Math.floor((e.BITS-1)/c)*c;f>=0;f-=c){h.fill(a);for(let y=0;y<s;y++){const w=t[y],g=Number(w>>BigInt(f)&u);h[g]=h[g].add(r[y])}let p=a;for(let y=h.length-1,w=a;y>0;y--)w=w.add(h[y]),p=p.add(w);if(l=l.add(p),f!==0)for(let y=0;y<c;y++)l=l.double()}return l}function Qo(n,e,r){if(e){if(e.ORDER!==n)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return(function(t){sn(t,Y3.reduce(((i,s)=>(i[s]="function",i)),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"}))})(e),e}return et(n,{isLE:r})}function $1(n,e,r={},t){if(t===void 0&&(t=n==="edwards"),!e||typeof e!="object")throw Error(`expected valid ${n} CURVE object`);for(const o of["p","n","h"]){const c=e[o];if(!(typeof c=="bigint"&&c>rn))throw Error(`CURVE.${o} must be positive bigint`)}const i=Qo(e.p,r.Fp,t),s=Qo(e.n,r.Fn,t),a=["Gx","Gy","a",n==="weierstrass"?"b":"d"];for(const o of a)if(!i.isValid(e[o]))throw Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{CURVE:e=Object.freeze(Object.assign({},e)),Fp:i,Fn:s}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Fo=(n,e)=>(n+(n>=0?e:-e)/Z1)/e;function na(n){if(!["compact","recovered","der"].includes(n))throw Error('Signature format must be "compact", "recovered", or "der"');return n}function Cs(n,e){const r={};for(let t of Object.keys(e))r[t]=n[t]===void 0?e[t]:n[t];return Dr(r.lowS,"lowS"),Dr(r.prehash,"prehash"),r.format!==void 0&&na(r.format),r}const Vt={Err:class extends Error{constructor(n=""){super(n)}},_tlv:{encode:(n,e)=>{const{Err:r}=Vt;if(n<0||n>256)throw new r("tlv.encode: wrong tag");if(1&e.length)throw new r("tlv.encode: unpadded data");const t=e.length/2,i=Xn(t);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=t>127?Xn(i.length/2|128):"";return Xn(n)+s+i+e},decode(n,e){const{Err:r}=Vt;let t=0;if(n<0||n>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[t++]!==n)throw new r("tlv.decode: wrong tlv");const i=e[t++];let s=0;if(128&i){const o=127&i;if(!o)throw new r("tlv.decode(long): indefinite length not supported");if(o>4)throw new r("tlv.decode(long): byte length is too big");const c=e.subarray(t,t+o);if(c.length!==o)throw new r("tlv.decode: length bytes not complete");if(c[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of c)s=s<<8|u;if(t+=o,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=i;const a=e.subarray(t,t+s);if(a.length!==s)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(t+s)}}},_int:{encode(n){const{Err:e}=Vt;if(n<Wt)throw new e("integer: negative integers are not allowed");let r=Xn(n);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(n){const{Err:e}=Vt;if(128&n[0])throw new e("invalid signature integer: negative");if(n[0]===0&&!(128&n[1]))throw new e("invalid signature integer: unnecessary leading zero");return Zi(n)}},toSig(n){const{Err:e,_int:r,_tlv:t}=Vt,i=pe("signature",n),{v:s,l:a}=t.decode(48,i);if(a.length)throw new e("invalid signature: left bytes after parsing");const{v:o,l:c}=t.decode(2,s),{v:u,l:h}=t.decode(2,c);if(h.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(o),s:r.decode(u)}},hexFromSig(n){const{_tlv:e,_int:r}=Vt,t=e.encode(2,r.encode(n.r))+e.encode(2,r.encode(n.s));return e.encode(48,t)}},Wt=BigInt(0),Wr=BigInt(1),Z1=BigInt(2),ni=BigInt(3),lu=BigInt(4);function jr(n,e){const{BYTES:r}=n;let t;if(typeof e=="bigint")t=e;else{let i=pe("private key",e);try{t=n.fromBytes(i)}catch{throw Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!n.isValidNot0(t))throw Error("invalid private key: out of range [1..N-1]");return t}function uu(n,e={}){const r=$1("weierstrass",n,e),{Fp:t,Fn:i}=r;let s=r.CURVE;const{h:a,n:o}=s;sn(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!t.is0(s.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');const u=e0(t,i);function h(){if(!t.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}const l=e.toBytes||function(k,x,C){const{x:B,y:P}=x.toAffine(),R=t.toBytes(B);return Dr(C,"isCompressed"),C?(h(),mt(X1(!t.isOdd(P)),R)):mt(Uint8Array.of(4),R,t.toBytes(P))},f=e.fromBytes||function(k){Et(k,void 0,"Point");const{publicKey:x,publicKeyUncompressed:C}=u,B=k.length,P=k[0],R=k.subarray(1);if(B!==x||P!==2&&P!==3){if(B===C&&P===4){const K=t.BYTES,N=t.fromBytes(R.subarray(0,K)),M=t.fromBytes(R.subarray(K,2*K));if(!y(N,M))throw Error("bad point: is not on curve");return{x:N,y:M}}throw Error(`bad point: got length ${B}, expected compressed=${x} or uncompressed=${C}`)}{const K=t.fromBytes(R);if(!t.isValid(K))throw Error("bad point: is not on curve, wrong x");const N=p(K);let M;try{M=t.sqrt(N)}catch(L){const O=L instanceof Error?": "+L.message:"";throw Error("bad point: is not on curve, sqrt error"+O)}return h(),!(1&~P)!==t.isOdd(M)&&(M=t.neg(M)),{x:K,y:M}}};function p(k){const x=t.sqr(k),C=t.mul(x,k);return t.add(t.add(C,t.mul(k,s.a)),s.b)}function y(k,x){const C=t.sqr(x),B=p(k);return t.eql(C,B)}if(!y(s.Gx,s.Gy))throw Error("bad curve params: generator point");const w=t.mul(t.pow(s.a,ni),lu),g=t.mul(t.sqr(s.b),BigInt(27));if(t.is0(t.add(w,g)))throw Error("bad curve params: a or b");function m(k,x,C=!1){if(!t.isValid(x)||C&&t.is0(x))throw Error("bad point coordinate "+k);return x}function S(k){if(!(k instanceof D))throw Error("ProjectivePoint expected")}function E(k){if(!c||!c.basises)throw Error("no endo");return(function(x,C,B){const[[P,R],[K,N]]=C,M=Fo(N*x,B),L=Fo(-R*x,B);let O=x-M*P-L*K,z=-M*R-L*N;const Q=O<Wt,G=z<Wt;Q&&(O=-O),G&&(z=-z);const H=Wn(Math.ceil(B1(B)/2))+Wr;if(O<Wt||O>=H||z<Wt||z>=H)throw Error("splitScalar (endomorphism): failed, k="+x);return{k1neg:Q,k1:O,k2neg:G,k2:z}})(k,c.basises,i.ORDER)}const v=Li(((k,x)=>{const{X:C,Y:B,Z:P}=k;if(t.eql(P,t.ONE))return{x:C,y:B};const R=k.is0();x==null&&(x=R?t.ONE:t.inv(P));const K=t.mul(C,x),N=t.mul(B,x),M=t.mul(P,x);if(R)return{x:t.ZERO,y:t.ZERO};if(!t.eql(M,t.ONE))throw Error("invZ was invalid");return{x:K,y:N}})),U=Li((k=>{if(k.is0()){if(e.allowInfinityPoint&&!t.is0(k.Y))return;throw Error("bad point: ZERO")}const{x,y:C}=k.toAffine();if(!t.isValid(x)||!t.isValid(C))throw Error("bad point: x or y not field elements");if(!y(x,C))throw Error("bad point: equation left != right");if(!k.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0}));function T(k,x,C,B,P){return C=new D(t.mul(C.X,k),C.Y,C.Z),x=Qi(B,x),C=Qi(P,C),x.add(C)}class D{constructor(x,C,B){this.X=m("x",x),this.Y=m("y",C,!0),this.Z=m("z",B),Object.freeze(this)}static CURVE(){return s}static fromAffine(x){const{x:C,y:B}=x||{};if(!x||!t.isValid(C)||!t.isValid(B))throw Error("invalid affine point");if(x instanceof D)throw Error("projective point not allowed");return t.is0(C)&&t.is0(B)?D.ZERO:new D(C,B,t.ONE)}static fromBytes(x){const C=D.fromAffine(f(Et(x,void 0,"point")));return C.assertValidity(),C}static fromHex(x){return D.fromBytes(pe("pointHex",x))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(x=8,C=!0){return b.createCache(this,x),C||this.multiply(ni),this}assertValidity(){U(this)}hasEvenY(){const{y:x}=this.toAffine();if(!t.isOdd)throw Error("Field doesn't support isOdd");return!t.isOdd(x)}equals(x){S(x);const{X:C,Y:B,Z:P}=this,{X:R,Y:K,Z:N}=x,M=t.eql(t.mul(C,N),t.mul(R,P)),L=t.eql(t.mul(B,N),t.mul(K,P));return M&&L}negate(){return new D(this.X,t.neg(this.Y),this.Z)}double(){const{a:x,b:C}=s,B=t.mul(C,ni),{X:P,Y:R,Z:K}=this;let N=t.ZERO,M=t.ZERO,L=t.ZERO,O=t.mul(P,P),z=t.mul(R,R),Q=t.mul(K,K),G=t.mul(P,R);return G=t.add(G,G),L=t.mul(P,K),L=t.add(L,L),N=t.mul(x,L),M=t.mul(B,Q),M=t.add(N,M),N=t.sub(z,M),M=t.add(z,M),M=t.mul(N,M),N=t.mul(G,N),L=t.mul(B,L),Q=t.mul(x,Q),G=t.sub(O,Q),G=t.mul(x,G),G=t.add(G,L),L=t.add(O,O),O=t.add(L,O),O=t.add(O,Q),O=t.mul(O,G),M=t.add(M,O),Q=t.mul(R,K),Q=t.add(Q,Q),O=t.mul(Q,G),N=t.sub(N,O),L=t.mul(Q,z),L=t.add(L,L),L=t.add(L,L),new D(N,M,L)}add(x){S(x);const{X:C,Y:B,Z:P}=this,{X:R,Y:K,Z:N}=x;let M=t.ZERO,L=t.ZERO,O=t.ZERO;const z=s.a,Q=t.mul(s.b,ni);let G=t.mul(C,R),H=t.mul(B,K),_=t.mul(P,N),W=t.add(C,B),J=t.add(R,K);W=t.mul(W,J),J=t.add(G,H),W=t.sub(W,J),J=t.add(C,P);let q=t.add(R,N);return J=t.mul(J,q),q=t.add(G,_),J=t.sub(J,q),q=t.add(B,P),M=t.add(K,N),q=t.mul(q,M),M=t.add(H,_),q=t.sub(q,M),O=t.mul(z,J),M=t.mul(Q,_),O=t.add(M,O),M=t.sub(H,O),O=t.add(H,O),L=t.mul(M,O),H=t.add(G,G),H=t.add(H,G),_=t.mul(z,_),J=t.mul(Q,J),H=t.add(H,_),_=t.sub(G,_),_=t.mul(z,_),J=t.add(J,_),G=t.mul(H,J),L=t.add(L,G),G=t.mul(q,J),M=t.mul(W,M),M=t.sub(M,G),G=t.mul(W,H),O=t.mul(q,O),O=t.add(O,G),new D(M,L,O)}subtract(x){return this.add(x.negate())}is0(){return this.equals(D.ZERO)}multiply(x){const{endo:C}=e;if(!i.isValidNot0(x))throw Error("invalid scalar: out of range");let B,P;const R=K=>b.cached(this,K,(N=>vr(D,N)));if(C){const{k1neg:K,k1:N,k2neg:M,k2:L}=E(x),{p:O,f:z}=R(N),{p:Q,f:G}=R(L);P=z.add(G),B=T(C.beta,O,Q,K,M)}else{const{p:K,f:N}=R(x);B=K,P=N}return vr(D,[B,P])[0]}multiplyUnsafe(x){const{endo:C}=e,B=this;if(!i.isValid(x))throw Error("invalid scalar: out of range");if(x===Wt||B.is0())return D.ZERO;if(x===Wr)return B;if(b.hasCache(this))return this.multiply(x);if(C){const{k1neg:P,k1:R,k2neg:K,k2:N}=E(x),{p1:M,p2:L}=(function(O,z,Q,G){let H=z,_=O.ZERO,W=O.ZERO;for(;Q>rn||G>rn;)Q&Er&&(_=_.add(H)),G&Er&&(W=W.add(H)),H=H.double(),Q>>=Er,G>>=Er;return{p1:_,p2:W}})(D,B,R,N);return T(C.beta,M,L,P,K)}return b.unsafe(B,x)}multiplyAndAddUnsafe(x,C,B){const P=this.multiplyUnsafe(C).add(x.multiplyUnsafe(B));return P.is0()?void 0:P}toAffine(x){return v(this,x)}isTorsionFree(){const{isTorsionFree:x}=e;return a===Wr||(x?x(D,this):b.unsafe(this,o).is0())}clearCofactor(){const{clearCofactor:x}=e;return a===Wr?this:x?x(D,this):this.multiplyUnsafe(a)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}toBytes(x=!0){return Dr(x,"isCompressed"),this.assertValidity(),l(D,this,x)}toHex(x=!0){return xr(this.toBytes(x))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(x=!0){return this.toBytes(x)}_setWindowSize(x){this.precompute(x)}static normalizeZ(x){return vr(D,x)}static msm(x,C){return J1(D,i,x,C)}static fromPrivateKey(x){return D.BASE.multiply(jr(i,x))}}D.BASE=new D(s.Gx,s.Gy,t.ONE),D.ZERO=new D(t.ZERO,t.ONE,t.ZERO),D.Fp=t,D.Fn=i;const I=i.BITS,b=new Y1(D,e.endo?Math.ceil(I/2):I);return D.BASE.precompute(8),D}function X1(n){return Uint8Array.of(n?2:3)}function e0(n,e){return{secretKey:e.BYTES,publicKey:1+n.BYTES,publicKeyUncompressed:1+2*n.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function hu(n,e={}){const{Fn:r}=n,t=e.randomBytes||$i,i=Object.assign(e0(n.Fp,r),{seed:Ko(r.ORDER)});function s(h){try{return!!jr(r,h)}catch{return!1}}function a(h=t(i.seed)){return(function(l,f,p=!1){const y=l.length,w=O1(f),g=Ko(f);if(y<16||y<g||y>1024)throw Error("expected "+g+"-1024 bytes of input, got "+y);const m=Be(p?Pr(l):Zi(l),f-Ge)+Ge;return p?Da(m,w):Ua(m,w)})(Et(h,i.seed,"seed"),r.ORDER)}function o(h,l=!0){return n.BASE.multiply(jr(r,h)).toBytes(l)}function c(h){if(typeof h=="bigint")return!1;if(h instanceof n)return!0;const{secretKey:l,publicKey:f,publicKeyUncompressed:p}=i;if(r.allowedLengths||l===f)return;const y=pe("key",h).length;return y===f||y===p}return Object.freeze({getPublicKey:o,getSharedSecret:function(h,l,f=!0){if(c(h)===!0)throw Error("first arg must be private key");if(c(l)===!1)throw Error("second arg must be public key");const p=jr(r,h);return n.fromHex(l).multiply(p).toBytes(f)},keygen:function(h){const l=a(h);return{secretKey:l,publicKey:o(l)}},Point:n,utils:{isValidSecretKey:s,isValidPublicKey:function(h,l){const{publicKey:f,publicKeyUncompressed:p}=i;try{const y=h.length;return(l!==!0||y===f)&&(l!==!1||y===p)&&!!n.fromBytes(h)}catch{return!1}},randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:h=>jr(r,h),precompute:(h=8,l=n.BASE)=>l.precompute(h,!1)},lengths:i})}function fu(n,e,r={}){x1(e),sn(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const t=r.randomBytes||$i,i=r.hmac||((I,...b)=>W1(e,I,mt(...b))),{Fp:s,Fn:a}=n,{ORDER:o,BITS:c}=a,{keygen:u,getPublicKey:h,getSharedSecret:l,utils:f,lengths:p}=hu(n,r),y={prehash:!1,lowS:typeof r.lowS=="boolean"&&r.lowS,format:void 0,extraEntropy:!1},w="compact";function g(I){return I>o>>Wr}function m(I,b){if(!a.isValidNot0(b))throw Error(`invalid signature ${I}: out of range 1..Point.Fn.ORDER`);return b}class S{constructor(b,k,x){this.r=m("r",b),this.s=m("s",k),x!=null&&(this.recovery=x),Object.freeze(this)}static fromBytes(b,k=w){let x;if((function(R,K){na(K);const N=p.signature;Et(R,K==="compact"?N:K==="recovered"?N+1:void 0,K+" signature")})(b,k),k==="der"){const{r:R,s:K}=Vt.toSig(Et(b));return new S(R,K)}k==="recovered"&&(x=b[0],k="compact",b=b.subarray(1));const C=a.BYTES,B=b.subarray(0,C),P=b.subarray(C,2*C);return new S(a.fromBytes(B),a.fromBytes(P),x)}static fromHex(b,k){return this.fromBytes(Oi(b),k)}addRecoveryBit(b){return new S(this.r,this.s,b)}recoverPublicKey(b){const k=s.ORDER,{r:x,s:C,recovery:B}=this;if(B==null||![0,1,2,3].includes(B))throw Error("recovery id invalid");if(o*Z1<k&&B>1)throw Error("recovery id is ambiguous for h>1 curve");const P=B===2||B===3?x+o:x;if(!s.isValid(P))throw Error("recovery id 2 or 3 invalid");const R=s.toBytes(P),K=n.fromBytes(mt(X1(!(1&B)),R)),N=a.inv(P),M=v(pe("msgHash",b)),L=a.create(-M*N),O=a.create(C*N),z=n.BASE.multiplyUnsafe(L).add(K.multiplyUnsafe(O));if(z.is0())throw Error("point at infinify");return z.assertValidity(),z}hasHighS(){return g(this.s)}toBytes(b=w){if(na(b),b==="der")return Oi(Vt.hexFromSig(this));const k=a.toBytes(this.r),x=a.toBytes(this.s);if(b==="recovered"){if(this.recovery==null)throw Error("recovery bit must be present");return mt(Uint8Array.of(this.recovery),k,x)}return mt(k,x)}toHex(b){return xr(this.toBytes(b))}assertValidity(){}static fromCompact(b){return S.fromBytes(pe("sig",b),"compact")}static fromDER(b){return S.fromBytes(pe("sig",b),"der")}normalizeS(){return this.hasHighS()?new S(this.r,a.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return xr(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return xr(this.toBytes("compact"))}}const E=r.bits2int||function(I){if(I.length>8192)throw Error("input is too large");const b=Zi(I),k=8*I.length-c;return k>0?b>>BigInt(k):b},v=r.bits2int_modN||function(I){return a.create(E(I))},U=Wn(c);function T(I){return Fn("num < 2^"+c,I,Wt,U),a.toBytes(I)}function D(I,b){return Et(I,void 0,"message"),b?Et(e(I),void 0,"prehashed message"):I}return Object.freeze({keygen:u,getPublicKey:h,getSharedSecret:l,utils:f,lengths:p,Point:n,sign:function(I,b,k={}){I=pe("message",I);const{seed:x,k2sig:C}=(function(P,R,K){if(["recovered","canonical"].some((_=>_ in K)))throw Error("sign() legacy options not supported");const{lowS:N,prehash:M,extraEntropy:L}=Cs(K,y);P=D(P,M);const O=v(P),z=jr(a,R),Q=[T(z),T(O)];if(L!=null&&L!==!1){const _=L===!0?t(p.secretKey):L;Q.push(pe("extraEntropy",_))}const G=mt(...Q),H=O;return{seed:G,k2sig:function(_){const W=E(_);if(!a.isValidNot0(W))return;const J=a.inv(W),q=n.BASE.multiply(W).toAffine(),ne=a.create(q.x);if(ne===Wt)return;const re=a.create(J*a.create(H+ne*z));if(re===Wt)return;let ae=(q.x===ne?0:2)|Number(q.y&Wr),ee=re;return N&&g(re)&&(ee=a.neg(re),ae^=1),new S(ne,ee,ae)}}})(I,b,k);return(function(P,R,K){if(typeof P!="number"||P<2)throw Error("hashLen must be a number");if(typeof R!="number"||R<2)throw Error("qByteLen must be a number");if(typeof K!="function")throw Error("hmacFn must be a function");const N=W=>new Uint8Array(W),M=W=>Uint8Array.of(W);let L=N(P),O=N(P),z=0;const Q=()=>{L.fill(1),O.fill(0),z=0},G=(...W)=>K(O,L,...W),H=(W=N(0))=>{O=G(M(0),W),L=G(),W.length!==0&&(O=G(M(1),W),L=G())},_=()=>{if(z++>=1e3)throw Error("drbg: tried 1000 values");let W=0;const J=[];for(;W<R;){L=G();const q=L.slice();J.push(q),W+=L.length}return mt(...J)};return(W,J)=>{let q;for(Q(),H(W);!(q=J(_()));)H();return Q(),q}})(e.outputLen,a.BYTES,i)(x,C)},verify:function(I,b,k,x={}){const{lowS:C,prehash:B,format:P}=Cs(x,y);if(k=pe("publicKey",k),b=D(pe("message",b),B),"strict"in x)throw Error("options.strict was renamed to lowS");const R=P===void 0?(function(K){let N;const M=typeof K=="string"||_n(K),L=!M&&K!==null&&typeof K=="object"&&typeof K.r=="bigint"&&typeof K.s=="bigint";if(!M&&!L)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(L)N=new S(K.r,K.s);else if(M){try{N=S.fromBytes(pe("sig",K),"der")}catch(O){if(!(O instanceof Vt.Err))throw O}if(!N)try{N=S.fromBytes(pe("sig",K),"compact")}catch{return!1}}return N||!1})(I):S.fromBytes(pe("sig",I),P);if(R===!1)return!1;try{const K=n.fromBytes(k);if(C&&R.hasHighS())return!1;const{r:N,s:M}=R,L=v(b),O=a.inv(M),z=a.create(L*O),Q=a.create(N*O),G=n.BASE.multiplyUnsafe(z).add(K.multiplyUnsafe(Q));return G.is0()?!1:a.create(G.x)===N}catch{return!1}},recoverPublicKey:function(I,b,k={}){const{prehash:x}=Cs(k,y);return b=D(b,x),S.fromBytes(I,"recovered").recoverPublicKey(b).toBytes()},Signature:S,hash:e})}function du(n){const{CURVE:e,curveOpts:r}=(function(i){const s={a:i.a,b:i.b,p:i.Fp.ORDER,n:i.n,h:i.h,Gx:i.Gx,Gy:i.Gy},a=i.Fp;let o=i.allowedPrivateKeyLengths?Array.from(new Set(i.allowedPrivateKeyLengths.map((c=>Math.ceil(c/2))))):void 0;return{CURVE:s,curveOpts:{Fp:a,Fn:et(s.n,{BITS:i.nBitLength,allowedLengths:o,modFromBytes:i.wrapPrivateKey}),allowInfinityPoint:i.allowInfinityPoint,endo:i.endo,isTorsionFree:i.isTorsionFree,clearCofactor:i.clearCofactor,fromBytes:i.fromBytes,toBytes:i.toBytes}}})(n),t={hmac:n.hmac,randomBytes:n.randomBytes,lowS:n.lowS,bits2int:n.bits2int,bits2int_modN:n.bits2int_modN};return{CURVE:e,curveOpts:r,hash:n.hash,ecdsaOpts:t}}function pu(n){const{CURVE:e,curveOpts:r,hash:t,ecdsaOpts:i}=du(n);return(function(s,a){const o=a.Point;return Object.assign({},a,{ProjectivePoint:o,CURVE:Object.assign({},s,N1(o.Fn.ORDER,o.Fn.BITS))})})(n,fu(uu(e,r),t,i))}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Tr(n,e){const r=t=>pu({...n,hash:t});return{...r(e),create:r}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const t0={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},r0={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},n0={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},yu=et(t0.p),gu=et(r0.p),Au=et(n0.p),wu=Tr({...t0,Fp:yu,lowS:!1},Ka),mu=Tr({...r0,Fp:gu,lowS:!1},_1),bu=Tr({...n0,Fp:Au,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},z1),Eu=BigInt(0),yn=BigInt(1),vu=BigInt(2),Su=BigInt(7),xu=BigInt(256),Iu=BigInt(113),i0=[],s0=[],a0=[];for(let n=0,e=yn,r=1,t=0;n<24;n++){[r,t]=[t,(2*r+3*t)%5],i0.push(2*(5*t+r)),s0.push((n+1)*(n+2)/2%64);let i=Eu;for(let s=0;s<7;s++)e=(e<<yn^(e>>Su)*Iu)%xu,e&vu&&(i^=yn<<(yn<<BigInt(s))-yn);a0.push(i)}const o0=F1(a0,!0),Cu=o0[0],ku=o0[1],Mo=(n,e,r)=>r>32?((t,i,s)=>i<<s-32|t>>>64-s)(n,e,r):((t,i,s)=>t<<s|i>>>32-s)(n,e,r),Go=(n,e,r)=>r>32?((t,i,s)=>t<<s-32|i>>>64-s)(n,e,r):((t,i,s)=>i<<s|t>>>32-s)(n,e,r);class Xi extends ka{constructor(e,r,t,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=t,this.enableXOF=i,this.rounds=s,Qn(t),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");var a;this.state=new Uint8Array(200),this.state32=(a=this.state,new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4)))}clone(){return this._cloneInto()}keccak(){vo(this.state32),(function(e,r=24){const t=new Uint32Array(10);for(let i=24-r;i<24;i++){for(let o=0;o<10;o++)t[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const c=(o+8)%10,u=(o+2)%10,h=t[u],l=t[u+1],f=Mo(h,l,1)^t[c],p=Go(h,l,1)^t[c+1];for(let y=0;y<50;y+=10)e[o+y]^=f,e[o+y+1]^=p}let s=e[2],a=e[3];for(let o=0;o<24;o++){const c=s0[o],u=Mo(s,a,c),h=Go(s,a,c),l=i0[o];s=e[l],a=e[l+1],e[l]=u,e[l+1]=h}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)t[c]=e[o+c];for(let c=0;c<10;c++)e[o+c]^=~t[(c+2)%10]&t[(c+4)%10]}e[0]^=Cu[i],e[1]^=ku[i]}gt(t)})(this.state32,this.rounds),vo(this.state32),this.posOut=0,this.pos=0}update(e){tn(this),Lt(e=Vn(e));const{blockLen:r,state:t}=this,i=e.length;for(let s=0;s<i;){const a=Math.min(r-this.pos,i-s);for(let o=0;o<a;o++)t[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:t,blockLen:i}=this;e[t]^=r,128&r&&t===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){tn(this,!1),Lt(e),this.finish();const r=this.state,{blockLen:t}=this;for(let i=0,s=e.length;i<s;){this.posOut>=t&&this.keccak();const a=Math.min(t-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Qn(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(I1(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,gt(this.state)}_cloneInto(e){const{blockLen:r,suffix:t,outputLen:i,rounds:s,enableXOF:a}=this;return e||(e=new Xi(r,t,i,a,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=t,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}}const c0=(n,e,r)=>Zt((()=>new Xi(e,n,r))),Bu=c0(6,136,32),Uu=c0(6,72,64),Du=(n,e,r)=>(function(t){const i=(a,o)=>t(o).update(Vn(a)).digest(),s=t({});return i.outputLen=s.outputLen,i.blockLen=s.blockLen,i.create=a=>t(a),i})(((t={})=>new Xi(e,n,t.dkLen===void 0?r:t.dkLen,!0))),Pu=Du(31,136,32),ir=BigInt(0),Ue=BigInt(1),ks=BigInt(2),Ku=BigInt(8);function l0(n,e={}){const r=$1("edwards",n,e,e.FpFnLE),{Fp:t,Fn:i}=r;let s=r.CURVE;const{h:a}=s;sn(e,{},{uvRatio:"function"});const o=ks<<BigInt(8*i.BYTES)-Ue,c=g=>t.create(g),u=e.uvRatio||((g,m)=>{try{return{isValid:!0,value:t.sqrt(t.div(g,m))}}catch{return{isValid:!1,value:ir}}});if(!(function(g,m,S,E){const v=g.sqr(S),U=g.sqr(E),T=g.add(g.mul(m.a,v),U),D=g.add(g.ONE,g.mul(m.d,g.mul(v,U)));return g.eql(T,D)})(t,s,s.Gx,s.Gy))throw Error("bad curve params: generator point");function h(g,m,S=!1){return Fn("coordinate "+g,m,S?Ue:ir,o),m}function l(g){if(!(g instanceof y))throw Error("ExtendedPoint expected")}const f=Li(((g,m)=>{const{X:S,Y:E,Z:v}=g,U=g.is0();m==null&&(m=U?Ku:t.inv(v));const T=c(S*m),D=c(E*m),I=t.mul(v,m);if(U)return{x:ir,y:Ue};if(I!==Ue)throw Error("invZ was invalid");return{x:T,y:D}})),p=Li((g=>{const{a:m,d:S}=s;if(g.is0())throw Error("bad point: ZERO");const{X:E,Y:v,Z:U,T}=g,D=c(E*E),I=c(v*v),b=c(U*U),k=c(b*b),x=c(D*m);if(c(b*c(x+I))!==c(k+c(S*c(D*I))))throw Error("bad point: equation left != right (1)");if(c(E*v)!==c(U*T))throw Error("bad point: equation left != right (2)");return!0}));class y{constructor(m,S,E,v){this.X=h("x",m),this.Y=h("y",S),this.Z=h("z",E,!0),this.T=h("t",v),Object.freeze(this)}static CURVE(){return s}static fromAffine(m){if(m instanceof y)throw Error("extended point not allowed");const{x:S,y:E}=m||{};return h("x",S),h("y",E),new y(S,E,Ue,c(S*E))}static fromBytes(m,S=!1){const E=t.BYTES,{a:v,d:U}=s;m=ko(Et(m,E,"point")),Dr(S,"zip215");const T=ko(m),D=m[E-1];T[E-1]=-129&D;const I=Pr(T),b=S?o:t.ORDER;Fn("point.y",I,ir,b);const k=c(I*I),x=c(k-Ue),C=c(U*k-v);let{isValid:B,value:P}=u(x,C);if(!B)throw Error("bad point: invalid y coordinate");const R=(P&Ue)===Ue,K=!!(128&D);if(!S&&P===ir&&K)throw Error("bad point: x=0 and x_0=1");return K!==R&&(P=c(-P)),y.fromAffine({x:P,y:I})}static fromHex(m,S=!1){return y.fromBytes(pe("point",m),S)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(m=8,S=!0){return w.createCache(this,m),S||this.multiply(ks),this}assertValidity(){p(this)}equals(m){l(m);const{X:S,Y:E,Z:v}=this,{X:U,Y:T,Z:D}=m,I=c(S*D),b=c(U*v),k=c(E*D),x=c(T*v);return I===b&&k===x}is0(){return this.equals(y.ZERO)}negate(){return new y(c(-this.X),this.Y,this.Z,c(-this.T))}double(){const{a:m}=s,{X:S,Y:E,Z:v}=this,U=c(S*S),T=c(E*E),D=c(ks*c(v*v)),I=c(m*U),b=S+E,k=c(c(b*b)-U-T),x=I+T,C=x-D,B=I-T,P=c(k*C),R=c(x*B),K=c(k*B),N=c(C*x);return new y(P,R,N,K)}add(m){l(m);const{a:S,d:E}=s,{X:v,Y:U,Z:T,T:D}=this,{X:I,Y:b,Z:k,T:x}=m,C=c(v*I),B=c(U*b),P=c(D*E*x),R=c(T*k),K=c((v+U)*(I+b)-C-B),N=R-P,M=R+P,L=c(B-S*C),O=c(K*N),z=c(M*L),Q=c(K*L),G=c(N*M);return new y(O,z,G,Q)}subtract(m){return this.add(m.negate())}multiply(m){if(!i.isValidNot0(m))throw Error("invalid scalar: expected 1 <= sc < curve.n");const{p:S,f:E}=w.cached(this,m,(v=>vr(y,v)));return vr(y,[S,E])[0]}multiplyUnsafe(m,S=y.ZERO){if(!i.isValid(m))throw Error("invalid scalar: expected 0 <= sc < curve.n");return m===ir?y.ZERO:this.is0()||m===Ue?this:w.unsafe(this,m,(E=>vr(y,E)),S)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return w.unsafe(this,s.n).is0()}toAffine(m){return f(this,m)}clearCofactor(){return a===Ue?this:this.multiplyUnsafe(a)}toBytes(){const{x:m,y:S}=this.toAffine(),E=t.toBytes(S);return E[E.length-1]|=m&Ue?128:0,E}toHex(){return xr(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(m){return vr(y,m)}static msm(m,S){return J1(y,i,m,S)}_setWindowSize(m){this.precompute(m)}toRawBytes(){return this.toBytes()}}y.BASE=new y(s.Gx,s.Gy,Ue,c(s.Gx*s.Gy)),y.ZERO=new y(ir,Ue,Ue,ir),y.Fp=t,y.Fn=i;const w=new Y1(y,i.BITS);return y.BASE.precompute(8),y}function Tu(n,e,r={}){if(typeof e!="function")throw Error('"hash" function param is required');sn(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:t}=r,{BASE:i,Fp:s,Fn:a}=n,o=r.randomBytes||$i,c=r.adjustScalarBytes||(E=>E),u=r.domain||((E,v,U)=>{if(Dr(U,"phflag"),v.length||U)throw Error("Contexts/pre-hash are not supported");return E});function h(E){return a.create(Pr(E))}function l(E){const{head:v,prefix:U,scalar:T}=(function(b){const k=g.secretKey;b=pe("private key",b,k);const x=pe("hashed private key",e(b),2*k),C=c(x.slice(0,k));return{head:C,prefix:x.slice(k,2*k),scalar:h(C)}})(E),D=i.multiply(T),I=D.toBytes();return{head:v,prefix:U,scalar:T,point:D,pointBytes:I}}function f(E){return l(E).pointBytes}function p(E=Uint8Array.of(),...v){const U=mt(...v);return h(e(u(U,pe("context",E),!!t)))}const y={zip215:!0},w=s.BYTES,g={secretKey:w,publicKey:w,signature:2*w,seed:w};function m(E=o(g.seed)){return Et(E,g.seed,"seed")}const S={getExtendedPublicKey:l,randomSecretKey:m,isValidSecretKey:function(E){return _n(E)&&E.length===a.BYTES},isValidPublicKey:function(E,v){try{return!!n.fromBytes(E,v)}catch{return!1}},toMontgomery(E){const{y:v}=n.fromBytes(E),U=g.publicKey,T=U===32;if(!T&&U!==57)throw Error("only defined for 25519 and 448");const D=T?s.div(Ue+v,Ue-v):s.div(v-Ue,v+Ue);return s.toBytes(D)},toMontgomeryPriv(E){const v=g.secretKey;Et(E,v);const U=e(E.subarray(0,v));return c(U).subarray(0,v)},randomPrivateKey:m,precompute:(E=8,v=n.BASE)=>v.precompute(E,!1)};return Object.freeze({keygen:function(E){const v=S.randomSecretKey(E);return{secretKey:v,publicKey:f(v)}},getPublicKey:f,sign:function(E,v,U={}){E=pe("message",E),t&&(E=t(E));const{prefix:T,scalar:D,pointBytes:I}=l(v),b=p(U.context,T,E),k=i.multiply(b).toBytes(),x=p(U.context,k,I,E),C=a.create(b+x*D);if(!a.isValid(C))throw Error("sign failed: invalid s");return Et(mt(k,a.toBytes(C)),g.signature,"result")},verify:function(E,v,U,T=y){const{context:D,zip215:I}=T,b=g.signature;E=pe("signature",E,b),v=pe("message",v),U=pe("publicKey",U,g.publicKey),I!==void 0&&Dr(I,"zip215"),t&&(v=t(v));const k=b/2,x=E.subarray(0,k),C=Pr(E.subarray(k,b));let B,P,R;try{B=n.fromBytes(U,I),P=n.fromBytes(x,I),R=i.multiplyUnsafe(C)}catch{return!1}if(!I&&B.isSmallOrder())return!1;const K=p(D,P.toBytes(),B.toBytes(),v);return P.add(B.multiplyUnsafe(K)).subtract(R).clearCofactor().is0()},utils:S,Point:n,lengths:g})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const gn=BigInt(0),Fr=BigInt(1),ii=BigInt(2);function Ru(n){const e=(sn(r=n,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...r}));var r;const{P:t,type:i,adjustScalarBytes:s,powPminus2:a,randomBytes:o}=e,c=i==="x25519";if(!c&&i!=="x448")throw Error("invalid type");const u=o||$i,h=c?255:448,l=c?32:56,f=BigInt(c?9:5),p=BigInt(c?121665:39081),y=c?ii**BigInt(254):ii**BigInt(447),w=c?BigInt(8)*ii**BigInt(251)-Fr:BigInt(4)*ii**BigInt(445)-Fr,g=y+w+Fr,m=b=>Be(b,t),S=E(f);function E(b){return Da(m(b),l)}function v(b,k){const x=(function(C,B){Fn("u",C,gn,t),Fn("scalar",B,y,g);const P=B,R=C;let K=Fr,N=gn,M=C,L=Fr,O=gn;for(let Q=BigInt(h-1);Q>=gn;Q--){const G=P>>Q&Fr;O^=G,{x_2:K,x_3:M}=T(O,K,M),{x_2:N,x_3:L}=T(O,N,L),O=G;const H=K+N,_=m(H*H),W=K-N,J=m(W*W),q=_-J,ne=M+L,re=m((M-L)*H),ae=m(ne*W),ee=re+ae,Ae=re-ae;M=m(ee*ee),L=m(R*m(Ae*Ae)),K=m(_*J),N=m(q*(_+m(p*q)))}({x_2:K,x_3:M}=T(O,K,M)),{x_2:N,x_3:L}=T(O,N,L);const z=a(N);return m(K*z)})((function(C){const B=pe("u coordinate",C,l);return c&&(B[31]&=127),m(Pr(B))})(k),(function(C){return Pr(s(pe("scalar",C,l)))})(b));if(x===gn)throw Error("invalid private or public key received");return E(x)}function U(b){return v(b,S)}function T(b,k,x){const C=m(b*(k-x));return{x_2:k=m(k-C),x_3:x=m(x+C)}}const D={secretKey:l,publicKey:l,seed:l},I=(b=u(l))=>(Lt(b,D.seed),b);return{keygen:function(b){const k=I(b);return{secretKey:k,publicKey:U(k)}},getSharedSecret:(b,k)=>v(b,k),getPublicKey:b=>U(b),scalarMult:v,scalarMultBase:U,utils:{randomSecretKey:I,randomPrivateKey:I},GuBytes:S.slice(),lengths:D}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Rr={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},Nu=Object.assign({},Rr,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}),Ou=Zt((()=>Pu.create({dkLen:114}))),Lu=BigInt(1),ia=BigInt(2),Ho=BigInt(3);BigInt(4);const Qu=BigInt(11),Fu=BigInt(22),zo=BigInt(44),Mu=BigInt(88),Gu=BigInt(223);function u0(n){const e=Rr.p,r=n*n*n%e,t=r*r*n%e,i=de(t,Ho,e)*t%e,s=de(i,Ho,e)*t%e,a=de(s,ia,e)*r%e,o=de(a,Qu,e)*a%e,c=de(o,Fu,e)*o%e,u=de(c,zo,e)*c%e,h=de(u,Mu,e)*u%e,l=de(h,zo,e)*c%e,f=de(l,ia,e)*r%e,p=de(f,Lu,e)*n%e;return de(p,Gu,e)*f%e}function h0(n){return n[0]&=252,n[55]|=128,n[56]=0,n}function Hu(n,e){const r=Rr.p,t=Be(n*n*e,r),i=Be(t*n,r),s=Be(i*t*e,r),a=Be(i*u0(s),r),o=Be(a*a,r);return{isValid:Be(o*e,r)===n,value:a}}const zu=et(Rr.p,{BITS:456,isLE:!0}),_o=et(Rr.n,{BITS:456,isLE:!0});function _u(n,e,r){if(e.length>255)throw Error("context must be smaller than 255, got: "+e.length);return mt((t="SigEd448",Uint8Array.from(t,((i,s)=>{const a=i.charCodeAt(0);if(i.length!==1||a>127)throw Error(`string contains non-ASCII character "${t[s]}" with code ${a} at position ${s}`);return a}))),new Uint8Array([r?1:0,e.length]),e,n);var t}const Vu=(function(n){const{CURVE:e,curveOpts:r,hash:t,eddsaOpts:i}=(function(s){const a={a:s.a,d:s.d,p:s.Fp.ORDER,n:s.n,h:s.h,Gx:s.Gx,Gy:s.Gy},o={Fp:s.Fp,Fn:et(a.n,s.nBitLength,!0),uvRatio:s.uvRatio},c={randomBytes:s.randomBytes,adjustScalarBytes:s.adjustScalarBytes,domain:s.domain,prehash:s.prehash,mapToCurve:s.mapToCurve};return{CURVE:a,curveOpts:o,hash:s.hash,eddsaOpts:c}})(n);return(function(s,a){const o=a.Point;return Object.assign({},a,{ExtendedPoint:o,CURVE:s,nBitLength:o.Fn.BITS,nByteLength:o.Fn.BYTES})})(n,Tu(l0(e,r),t,i))})({...Rr,Fp:zu,Fn:_o,nBitLength:_o.BITS,hash:Ou,adjustScalarBytes:h0,domain:_u,uvRatio:Hu});l0(Nu);const Wu=(()=>{const n=Rr.p;return Ru({P:n,type:"x448",powPminus2:e=>Be(de(u0(e),ia,n)*e,n),adjustScalarBytes:h0})})(),sa={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},ju={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},Vo=BigInt(2);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const aa=et(sa.p,{sqrt:function(n){const e=sa.p,r=BigInt(3),t=BigInt(6),i=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),u=n*n*n%e,h=u*u*n%e,l=de(h,r,e)*h%e,f=de(l,r,e)*h%e,p=de(f,Vo,e)*u%e,y=de(p,i,e)*p%e,w=de(y,s,e)*y%e,g=de(w,o,e)*w%e,m=de(g,c,e)*g%e,S=de(m,o,e)*w%e,E=de(S,r,e)*h%e,v=de(E,a,e)*y%e,U=de(v,t,e)*u%e,T=de(U,Vo,e);if(!aa.eql(aa.sqr(T),n))throw Error("Cannot find square root");return T}}),qu=Tr({...sa,Fp:aa,lowS:!0,endo:ju},Ka),f0=Ka,Yu=cu,Wo=et(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),Ju=Tr({a:Wo.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:Wo,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},f0),d0=z1,p0=_1,jo=et(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),$u=Tr({a:jo.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:jo,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},p0),qo=et(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),Zu=Tr({a:qo.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:qo,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},d0),Xu=new Map(Object.entries({nistP256:wu,nistP384:mu,nistP521:bu,brainpoolP256r1:Ju,brainpoolP384r1:$u,brainpoolP512r1:Zu,secp256k1:qu,x448:Wu,ed448:Vu}));var eh=Object.freeze({__proto__:null,nobleCurves:Xu});const An=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),sr=new Uint32Array(80);class th extends jn{constructor(){super(64,20,8,!1),this.A=0|An[0],this.B=0|An[1],this.C=0|An[2],this.D=0|An[3],this.E=0|An[4]}get(){const{A:e,B:r,C:t,D:i,E:s}=this;return[e,r,t,i,s]}set(e,r,t,i,s){this.A=0|e,this.B=0|r,this.C=0|t,this.D=0|i,this.E=0|s}process(e,r){for(let c=0;c<16;c++,r+=4)sr[c]=e.getUint32(r,!1);for(let c=16;c<80;c++)sr[c]=lr(sr[c-3]^sr[c-8]^sr[c-14]^sr[c-16],1);let{A:t,B:i,C:s,D:a,E:o}=this;for(let c=0;c<80;c++){let u,h;c<20?(u=L1(i,s,a),h=1518500249):c<40?(u=i^s^a,h=1859775393):c<60?(u=Q1(i,s,a),h=2400959708):(u=i^s^a,h=3395469782);const l=lr(t,5)+u+o+h+sr[c]|0;o=a,a=s,s=lr(i,30),i=t,t=l}t=t+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,this.set(t,i,s,a,o)}roundClean(){gt(sr)}destroy(){this.set(0,0,0,0,0),gt(this.buffer)}}const rh=Zt((()=>new th)),nh=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),y0=Uint8Array.from(Array(16).fill(0).map(((n,e)=>e))),ih=y0.map((n=>(9*n+5)%16)),g0=(()=>{const n=[[y0],[ih]];for(let e=0;e<4;e++)for(let r of n)r.push(r[e].map((t=>nh[t])));return n})(),A0=g0[0],w0=g0[1],m0=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map((n=>Uint8Array.from(n))),sh=A0.map(((n,e)=>n.map((r=>m0[e][r])))),ah=w0.map(((n,e)=>n.map((r=>m0[e][r])))),oh=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),ch=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function Yo(n,e,r,t){return n===0?e^r^t:n===1?e&r|~e&t:n===2?(e|~r)^t:n===3?e&t|r&~t:e^(r|~t)}const si=new Uint32Array(16);class lh extends jn{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:r,h2:t,h3:i,h4:s}=this;return[e,r,t,i,s]}set(e,r,t,i,s){this.h0=0|e,this.h1=0|r,this.h2=0|t,this.h3=0|i,this.h4=0|s}process(e,r){for(let p=0;p<16;p++,r+=4)si[p]=e.getUint32(r,!0);let t=0|this.h0,i=t,s=0|this.h1,a=s,o=0|this.h2,c=o,u=0|this.h3,h=u,l=0|this.h4,f=l;for(let p=0;p<5;p++){const y=4-p,w=oh[p],g=ch[p],m=A0[p],S=w0[p],E=sh[p],v=ah[p];for(let U=0;U<16;U++){const T=lr(t+Yo(p,s,o,u)+si[m[U]]+w,E[U])+l|0;t=l,l=u,u=0|lr(o,10),o=s,s=T}for(let U=0;U<16;U++){const T=lr(i+Yo(y,a,c,h)+si[S[U]]+g,v[U])+f|0;i=f,f=h,h=0|lr(c,10),c=a,a=T}}this.set(this.h1+o+h|0,this.h2+u+f|0,this.h3+l+i|0,this.h4+t+a|0,this.h0+s+c|0)}roundClean(){gt(si)}destroy(){this.destroyed=!0,gt(this.buffer),this.set(0,0,0,0,0)}}const uh=rh,hh=Zt((()=>new lh)),fh=Array.from({length:64},((n,e)=>Math.floor(2**32*Math.abs(Math.sin(e+1))))),Jo=(n,e,r)=>n&e^~n&r,ai=new Uint32Array([1732584193,4023233417,2562383102,271733878]),Bs=new Uint32Array(16);class dh extends jn{constructor(){super(64,16,8,!0),this.A=0|ai[0],this.B=0|ai[1],this.C=0|ai[2],this.D=0|ai[3]}get(){const{A:e,B:r,C:t,D:i}=this;return[e,r,t,i]}set(e,r,t,i){this.A=0|e,this.B=0|r,this.C=0|t,this.D=0|i}process(e,r){for(let o=0;o<16;o++,r+=4)Bs[o]=e.getUint32(r,!0);let{A:t,B:i,C:s,D:a}=this;for(let o=0;o<64;o++){let c,u,h;o<16?(c=Jo(i,s,a),u=o,h=[7,12,17,22]):o<32?(c=Jo(a,i,s),u=(5*o+1)%16,h=[5,9,14,20]):o<48?(c=i^s^a,u=(3*o+5)%16,h=[4,11,16,23]):(c=s^(i|~a),u=7*o%16,h=[6,10,15,21]),c=c+t+fh[o]+Bs[u],t=a,a=s,s=i,i+=lr(c,h[o%4])}t=t+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,this.set(t,i,s,a)}roundClean(){Bs.fill(0)}destroy(){this.set(0,0,0,0),this.buffer.fill(0)}}const ph=new Map(Object.entries({md5:_3((()=>new dh)),sha1:uh,sha224:Yu,sha256:f0,sha384:p0,sha512:d0,sha3_256:Bu,sha3_512:Uu,ripemd160:hh}));var yh=Object.freeze({__proto__:null,nobleHashes:ph});const Us=typeof Qe=="object"&&"crypto"in Qe?Qe.crypto:void 0,_e={};var Y=function(n){var e,r=new Float64Array(16);if(n)for(e=0;e<n.length;e++)r[e]=n[e];return r},oa=function(){throw Error("no PRNG")},b0=new Uint8Array(32);b0[0]=9;var ca=Y(),Fi=Y([1]),gh=Y([56129,1]),Ah=Y([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),wh=Y([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),$o=Y([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Zo=Y([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),mh=Y([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Xo(n,e,r,t){n[e]=r>>24&255,n[e+1]=r>>16&255,n[e+2]=r>>8&255,n[e+3]=255&r,n[e+4]=t>>24&255,n[e+5]=t>>16&255,n[e+6]=t>>8&255,n[e+7]=255&t}function E0(n,e,r,t){return(function(i,s,a,o,c){var u,h=0;for(u=0;u<c;u++)h|=i[s+u]^a[o+u];return(1&h-1>>>8)-1})(n,e,r,t,32)}function ur(n,e){var r;for(r=0;r<16;r++)n[r]=0|e[r]}function Ds(n){var e,r,t=1;for(e=0;e<16;e++)r=n[e]+t+65535,t=Math.floor(r/65536),n[e]=r-65536*t;n[0]+=t-1+37*(t-1)}function qr(n,e,r){for(var t,i=~(r-1),s=0;s<16;s++)t=i&(n[s]^e[s]),n[s]^=t,e[s]^=t}function Mn(n,e){var r,t,i,s=Y(),a=Y();for(r=0;r<16;r++)a[r]=e[r];for(Ds(a),Ds(a),Ds(a),t=0;t<2;t++){for(s[0]=a[0]-65517,r=1;r<15;r++)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,qr(a,s,1-i)}for(r=0;r<16;r++)n[2*r]=255&a[r],n[2*r+1]=a[r]>>8}function ec(n,e){var r=new Uint8Array(32),t=new Uint8Array(32);return Mn(r,n),Mn(t,e),E0(r,0,t,0)}function v0(n){var e=new Uint8Array(32);return Mn(e,n),1&e[0]}function S0(n,e){var r;for(r=0;r<16;r++)n[r]=e[2*r]+(e[2*r+1]<<8);n[15]&=32767}function Dt(n,e,r){for(var t=0;t<16;t++)n[t]=e[t]+r[t]}function Kt(n,e,r){for(var t=0;t<16;t++)n[t]=e[t]-r[t]}function se(n,e,r){var t,i,s=0,a=0,o=0,c=0,u=0,h=0,l=0,f=0,p=0,y=0,w=0,g=0,m=0,S=0,E=0,v=0,U=0,T=0,D=0,I=0,b=0,k=0,x=0,C=0,B=0,P=0,R=0,K=0,N=0,M=0,L=0,O=r[0],z=r[1],Q=r[2],G=r[3],H=r[4],_=r[5],W=r[6],J=r[7],q=r[8],ne=r[9],re=r[10],ae=r[11],ee=r[12],Ae=r[13],be=r[14],we=r[15];s+=(t=e[0])*O,a+=t*z,o+=t*Q,c+=t*G,u+=t*H,h+=t*_,l+=t*W,f+=t*J,p+=t*q,y+=t*ne,w+=t*re,g+=t*ae,m+=t*ee,S+=t*Ae,E+=t*be,v+=t*we,a+=(t=e[1])*O,o+=t*z,c+=t*Q,u+=t*G,h+=t*H,l+=t*_,f+=t*W,p+=t*J,y+=t*q,w+=t*ne,g+=t*re,m+=t*ae,S+=t*ee,E+=t*Ae,v+=t*be,U+=t*we,o+=(t=e[2])*O,c+=t*z,u+=t*Q,h+=t*G,l+=t*H,f+=t*_,p+=t*W,y+=t*J,w+=t*q,g+=t*ne,m+=t*re,S+=t*ae,E+=t*ee,v+=t*Ae,U+=t*be,T+=t*we,c+=(t=e[3])*O,u+=t*z,h+=t*Q,l+=t*G,f+=t*H,p+=t*_,y+=t*W,w+=t*J,g+=t*q,m+=t*ne,S+=t*re,E+=t*ae,v+=t*ee,U+=t*Ae,T+=t*be,D+=t*we,u+=(t=e[4])*O,h+=t*z,l+=t*Q,f+=t*G,p+=t*H,y+=t*_,w+=t*W,g+=t*J,m+=t*q,S+=t*ne,E+=t*re,v+=t*ae,U+=t*ee,T+=t*Ae,D+=t*be,I+=t*we,h+=(t=e[5])*O,l+=t*z,f+=t*Q,p+=t*G,y+=t*H,w+=t*_,g+=t*W,m+=t*J,S+=t*q,E+=t*ne,v+=t*re,U+=t*ae,T+=t*ee,D+=t*Ae,I+=t*be,b+=t*we,l+=(t=e[6])*O,f+=t*z,p+=t*Q,y+=t*G,w+=t*H,g+=t*_,m+=t*W,S+=t*J,E+=t*q,v+=t*ne,U+=t*re,T+=t*ae,D+=t*ee,I+=t*Ae,b+=t*be,k+=t*we,f+=(t=e[7])*O,p+=t*z,y+=t*Q,w+=t*G,g+=t*H,m+=t*_,S+=t*W,E+=t*J,v+=t*q,U+=t*ne,T+=t*re,D+=t*ae,I+=t*ee,b+=t*Ae,k+=t*be,x+=t*we,p+=(t=e[8])*O,y+=t*z,w+=t*Q,g+=t*G,m+=t*H,S+=t*_,E+=t*W,v+=t*J,U+=t*q,T+=t*ne,D+=t*re,I+=t*ae,b+=t*ee,k+=t*Ae,x+=t*be,C+=t*we,y+=(t=e[9])*O,w+=t*z,g+=t*Q,m+=t*G,S+=t*H,E+=t*_,v+=t*W,U+=t*J,T+=t*q,D+=t*ne,I+=t*re,b+=t*ae,k+=t*ee,x+=t*Ae,C+=t*be,B+=t*we,w+=(t=e[10])*O,g+=t*z,m+=t*Q,S+=t*G,E+=t*H,v+=t*_,U+=t*W,T+=t*J,D+=t*q,I+=t*ne,b+=t*re,k+=t*ae,x+=t*ee,C+=t*Ae,B+=t*be,P+=t*we,g+=(t=e[11])*O,m+=t*z,S+=t*Q,E+=t*G,v+=t*H,U+=t*_,T+=t*W,D+=t*J,I+=t*q,b+=t*ne,k+=t*re,x+=t*ae,C+=t*ee,B+=t*Ae,P+=t*be,R+=t*we,m+=(t=e[12])*O,S+=t*z,E+=t*Q,v+=t*G,U+=t*H,T+=t*_,D+=t*W,I+=t*J,b+=t*q,k+=t*ne,x+=t*re,C+=t*ae,B+=t*ee,P+=t*Ae,R+=t*be,K+=t*we,S+=(t=e[13])*O,E+=t*z,v+=t*Q,U+=t*G,T+=t*H,D+=t*_,I+=t*W,b+=t*J,k+=t*q,x+=t*ne,C+=t*re,B+=t*ae,P+=t*ee,R+=t*Ae,K+=t*be,N+=t*we,E+=(t=e[14])*O,v+=t*z,U+=t*Q,T+=t*G,D+=t*H,I+=t*_,b+=t*W,k+=t*J,x+=t*q,C+=t*ne,B+=t*re,P+=t*ae,R+=t*ee,K+=t*Ae,N+=t*be,M+=t*we,v+=(t=e[15])*O,a+=38*(T+=t*Q),o+=38*(D+=t*G),c+=38*(I+=t*H),u+=38*(b+=t*_),h+=38*(k+=t*W),l+=38*(x+=t*J),f+=38*(C+=t*q),p+=38*(B+=t*ne),y+=38*(P+=t*re),w+=38*(R+=t*ae),g+=38*(K+=t*ee),m+=38*(N+=t*Ae),S+=38*(M+=t*be),E+=38*(L+=t*we),s=(t=(s+=38*(U+=t*z))+(i=1)+65535)-65536*(i=Math.floor(t/65536)),a=(t=a+i+65535)-65536*(i=Math.floor(t/65536)),o=(t=o+i+65535)-65536*(i=Math.floor(t/65536)),c=(t=c+i+65535)-65536*(i=Math.floor(t/65536)),u=(t=u+i+65535)-65536*(i=Math.floor(t/65536)),h=(t=h+i+65535)-65536*(i=Math.floor(t/65536)),l=(t=l+i+65535)-65536*(i=Math.floor(t/65536)),f=(t=f+i+65535)-65536*(i=Math.floor(t/65536)),p=(t=p+i+65535)-65536*(i=Math.floor(t/65536)),y=(t=y+i+65535)-65536*(i=Math.floor(t/65536)),w=(t=w+i+65535)-65536*(i=Math.floor(t/65536)),g=(t=g+i+65535)-65536*(i=Math.floor(t/65536)),m=(t=m+i+65535)-65536*(i=Math.floor(t/65536)),S=(t=S+i+65535)-65536*(i=Math.floor(t/65536)),E=(t=E+i+65535)-65536*(i=Math.floor(t/65536)),v=(t=v+i+65535)-65536*(i=Math.floor(t/65536)),s=(t=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(t/65536)),a=(t=a+i+65535)-65536*(i=Math.floor(t/65536)),o=(t=o+i+65535)-65536*(i=Math.floor(t/65536)),c=(t=c+i+65535)-65536*(i=Math.floor(t/65536)),u=(t=u+i+65535)-65536*(i=Math.floor(t/65536)),h=(t=h+i+65535)-65536*(i=Math.floor(t/65536)),l=(t=l+i+65535)-65536*(i=Math.floor(t/65536)),f=(t=f+i+65535)-65536*(i=Math.floor(t/65536)),p=(t=p+i+65535)-65536*(i=Math.floor(t/65536)),y=(t=y+i+65535)-65536*(i=Math.floor(t/65536)),w=(t=w+i+65535)-65536*(i=Math.floor(t/65536)),g=(t=g+i+65535)-65536*(i=Math.floor(t/65536)),m=(t=m+i+65535)-65536*(i=Math.floor(t/65536)),S=(t=S+i+65535)-65536*(i=Math.floor(t/65536)),E=(t=E+i+65535)-65536*(i=Math.floor(t/65536)),v=(t=v+i+65535)-65536*(i=Math.floor(t/65536)),s+=i-1+37*(i-1),n[0]=s,n[1]=a,n[2]=o,n[3]=c,n[4]=u,n[5]=h,n[6]=l,n[7]=f,n[8]=p,n[9]=y,n[10]=w,n[11]=g,n[12]=m,n[13]=S,n[14]=E,n[15]=v}function bt(n,e){se(n,e,e)}function x0(n,e){var r,t=Y();for(r=0;r<16;r++)t[r]=e[r];for(r=253;r>=0;r--)bt(t,t),r!==2&&r!==4&&se(t,t,e);for(r=0;r<16;r++)n[r]=t[r]}function I0(n,e,r){var t,i,s=new Uint8Array(32),a=new Float64Array(80),o=Y(),c=Y(),u=Y(),h=Y(),l=Y(),f=Y();for(i=0;i<31;i++)s[i]=e[i];for(s[31]=127&e[31]|64,s[0]&=248,S0(a,r),i=0;i<16;i++)c[i]=a[i],h[i]=o[i]=u[i]=0;for(o[0]=h[0]=1,i=254;i>=0;--i)qr(o,c,t=s[i>>>3]>>>(7&i)&1),qr(u,h,t),Dt(l,o,u),Kt(o,o,u),Dt(u,c,h),Kt(c,c,h),bt(h,l),bt(f,o),se(o,u,o),se(u,c,l),Dt(l,o,u),Kt(o,o,u),bt(c,o),Kt(u,h,f),se(o,u,gh),Dt(o,o,h),se(u,u,o),se(o,h,f),se(h,c,a),bt(c,l),qr(o,c,t),qr(u,h,t);for(i=0;i<16;i++)a[i+16]=o[i],a[i+32]=u[i],a[i+48]=c[i],a[i+64]=h[i];var p=a.subarray(32),y=a.subarray(16);return x0(p,p),se(y,y,p),Mn(n,y),0}function tc(n,e){return I0(n,e,b0)}var rc=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function nc(n,e,r,t){for(var i,s,a,o,c,u,h,l,f,p,y,w,g,m,S,E,v,U,T,D,I,b,k,x,C,B,P=new Int32Array(16),R=new Int32Array(16),K=n[0],N=n[1],M=n[2],L=n[3],O=n[4],z=n[5],Q=n[6],G=n[7],H=e[0],_=e[1],W=e[2],J=e[3],q=e[4],ne=e[5],re=e[6],ae=e[7],ee=0;t>=128;){for(T=0;T<16;T++)D=8*T+ee,P[T]=r[D+0]<<24|r[D+1]<<16|r[D+2]<<8|r[D+3],R[T]=r[D+4]<<24|r[D+5]<<16|r[D+6]<<8|r[D+7];for(T=0;T<80;T++)if(i=K,s=N,a=M,o=L,c=O,u=z,h=Q,f=H,p=_,y=W,w=J,g=q,m=ne,S=re,k=65535&(b=ae),x=b>>>16,C=65535&(I=G),B=I>>>16,k+=65535&(b=(q>>>14|O<<18)^(q>>>18|O<<14)^(O>>>9|q<<23)),x+=b>>>16,C+=65535&(I=(O>>>14|q<<18)^(O>>>18|q<<14)^(q>>>9|O<<23)),B+=I>>>16,k+=65535&(b=q&ne^~q&re),x+=b>>>16,C+=65535&(I=O&z^~O&Q),B+=I>>>16,k+=65535&(b=rc[2*T+1]),x+=b>>>16,C+=65535&(I=rc[2*T]),B+=I>>>16,I=P[T%16],x+=(b=R[T%16])>>>16,C+=65535&I,B+=I>>>16,C+=(x+=(k+=65535&b)>>>16)>>>16,k=65535&(b=U=65535&k|x<<16),x=b>>>16,C=65535&(I=v=65535&C|(B+=C>>>16)<<16),B=I>>>16,k+=65535&(b=(H>>>28|K<<4)^(K>>>2|H<<30)^(K>>>7|H<<25)),x+=b>>>16,C+=65535&(I=(K>>>28|H<<4)^(H>>>2|K<<30)^(H>>>7|K<<25)),B+=I>>>16,x+=(b=H&_^H&W^_&W)>>>16,C+=65535&(I=K&N^K&M^N&M),B+=I>>>16,l=65535&(C+=(x+=(k+=65535&b)>>>16)>>>16)|(B+=C>>>16)<<16,E=65535&k|x<<16,k=65535&(b=w),x=b>>>16,C=65535&(I=o),B=I>>>16,x+=(b=U)>>>16,C+=65535&(I=v),B+=I>>>16,N=i,M=s,L=a,O=o=65535&(C+=(x+=(k+=65535&b)>>>16)>>>16)|(B+=C>>>16)<<16,z=c,Q=u,G=h,K=l,_=f,W=p,J=y,q=w=65535&k|x<<16,ne=g,re=m,ae=S,H=E,T%16==15)for(D=0;D<16;D++)I=P[D],k=65535&(b=R[D]),x=b>>>16,C=65535&I,B=I>>>16,I=P[(D+9)%16],k+=65535&(b=R[(D+9)%16]),x+=b>>>16,C+=65535&I,B+=I>>>16,v=P[(D+1)%16],k+=65535&(b=((U=R[(D+1)%16])>>>1|v<<31)^(U>>>8|v<<24)^(U>>>7|v<<25)),x+=b>>>16,C+=65535&(I=(v>>>1|U<<31)^(v>>>8|U<<24)^v>>>7),B+=I>>>16,v=P[(D+14)%16],x+=(b=((U=R[(D+14)%16])>>>19|v<<13)^(v>>>29|U<<3)^(U>>>6|v<<26))>>>16,C+=65535&(I=(v>>>19|U<<13)^(U>>>29|v<<3)^v>>>6),B+=I>>>16,B+=(C+=(x+=(k+=65535&b)>>>16)>>>16)>>>16,P[D]=65535&C|B<<16,R[D]=65535&k|x<<16;k=65535&(b=H),x=b>>>16,C=65535&(I=K),B=I>>>16,I=n[0],x+=(b=e[0])>>>16,C+=65535&I,B+=I>>>16,B+=(C+=(x+=(k+=65535&b)>>>16)>>>16)>>>16,n[0]=K=65535&C|B<<16,e[0]=H=65535&k|x<<16,k=65535&(b=_),x=b>>>16,C=65535&(I=N),B=I>>>16,I=n[1],x+=(b=e[1])>>>16,C+=65535&I,B+=I>>>16,B+=(C+=(x+=(k+=65535&b)>>>16)>>>16)>>>16,n[1]=N=65535&C|B<<16,e[1]=_=65535&k|x<<16,k=65535&(b=W),x=b>>>16,C=65535&(I=M),B=I>>>16,I=n[2],x+=(b=e[2])>>>16,C+=65535&I,B+=I>>>16,B+=(C+=(x+=(k+=65535&b)>>>16)>>>16)>>>16,n[2]=M=65535&C|B<<16,e[2]=W=65535&k|x<<16,k=65535&(b=J),x=b>>>16,C=65535&(I=L),B=I>>>16,I=n[3],x+=(b=e[3])>>>16,C+=65535&I,B+=I>>>16,B+=(C+=(x+=(k+=65535&b)>>>16)>>>16)>>>16,n[3]=L=65535&C|B<<16,e[3]=J=65535&k|x<<16,k=65535&(b=q),x=b>>>16,C=65535&(I=O),B=I>>>16,I=n[4],x+=(b=e[4])>>>16,C+=65535&I,B+=I>>>16,B+=(C+=(x+=(k+=65535&b)>>>16)>>>16)>>>16,n[4]=O=65535&C|B<<16,e[4]=q=65535&k|x<<16,k=65535&(b=ne),x=b>>>16,C=65535&(I=z),B=I>>>16,I=n[5],x+=(b=e[5])>>>16,C+=65535&I,B+=I>>>16,B+=(C+=(x+=(k+=65535&b)>>>16)>>>16)>>>16,n[5]=z=65535&C|B<<16,e[5]=ne=65535&k|x<<16,k=65535&(b=re),x=b>>>16,C=65535&(I=Q),B=I>>>16,I=n[6],x+=(b=e[6])>>>16,C+=65535&I,B+=I>>>16,B+=(C+=(x+=(k+=65535&b)>>>16)>>>16)>>>16,n[6]=Q=65535&C|B<<16,e[6]=re=65535&k|x<<16,k=65535&(b=ae),x=b>>>16,C=65535&(I=G),B=I>>>16,I=n[7],x+=(b=e[7])>>>16,C+=65535&I,B+=I>>>16,B+=(C+=(x+=(k+=65535&b)>>>16)>>>16)>>>16,n[7]=G=65535&C|B<<16,e[7]=ae=65535&k|x<<16,ee+=128,t-=128}return t}function xn(n,e,r){var t,i=new Int32Array(8),s=new Int32Array(8),a=new Uint8Array(256),o=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,nc(i,s,e,r),r%=128,t=0;t<r;t++)a[t]=e[o-r+t];for(a[r]=128,a[(r=256-128*(r<112?1:0))-9]=0,Xo(a,r-8,o/536870912|0,o<<3),nc(i,s,a,r),t=0;t<8;t++)Xo(n,8*t,i[t],s[t]);return 0}function la(n,e){var r=Y(),t=Y(),i=Y(),s=Y(),a=Y(),o=Y(),c=Y(),u=Y(),h=Y();Kt(r,n[1],n[0]),Kt(h,e[1],e[0]),se(r,r,h),Dt(t,n[0],n[1]),Dt(h,e[0],e[1]),se(t,t,h),se(i,n[3],e[3]),se(i,i,wh),se(s,n[2],e[2]),Dt(s,s,s),Kt(a,t,r),Kt(o,s,i),Dt(c,s,i),Dt(u,t,r),se(n[0],a,o),se(n[1],u,c),se(n[2],c,o),se(n[3],a,u)}function ic(n,e,r){var t;for(t=0;t<4;t++)qr(n[t],e[t],r)}function ua(n,e){var r=Y(),t=Y(),i=Y();x0(i,e[2]),se(r,e[0],i),se(t,e[1],i),Mn(n,t),n[31]^=v0(r)<<7}function C0(n,e,r){var t,i;for(ur(n[0],ca),ur(n[1],Fi),ur(n[2],Fi),ur(n[3],ca),i=255;i>=0;--i)ic(n,e,t=r[i/8|0]>>(7&i)&1),la(e,n),la(n,n),ic(n,e,t)}function ha(n,e){var r=[Y(),Y(),Y(),Y()];ur(r[0],$o),ur(r[1],Zo),ur(r[2],Fi),se(r[3],$o,Zo),C0(n,r,e)}function sc(n,e,r){var t,i=new Uint8Array(64),s=[Y(),Y(),Y(),Y()];for(r||oa(e,32),xn(i,e,32),i[0]&=248,i[31]&=127,i[31]|=64,ha(s,i),ua(n,s),t=0;t<32;t++)e[t+32]=n[t];return 0}var Ps=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function k0(n,e){var r,t,i,s;for(t=63;t>=32;--t){for(r=0,i=t-32,s=t-12;i<s;++i)e[i]+=r-16*e[t]*Ps[i-(t-32)],r=Math.floor((e[i]+128)/256),e[i]-=256*r;e[i]+=r,e[t]=0}for(r=0,i=0;i<32;i++)e[i]+=r-(e[31]>>4)*Ps[i],r=e[i]>>8,e[i]&=255;for(i=0;i<32;i++)e[i]-=r*Ps[i];for(t=0;t<32;t++)e[t+1]+=e[t]>>8,n[t]=255&e[t]}function Ks(n){var e,r=new Float64Array(64);for(e=0;e<64;e++)r[e]=n[e];for(e=0;e<64;e++)n[e]=0;k0(n,r)}function bh(n,e){var r=Y(),t=Y(),i=Y(),s=Y(),a=Y(),o=Y(),c=Y();return ur(n[2],Fi),S0(n[1],e),bt(i,n[1]),se(s,i,Ah),Kt(i,i,n[2]),Dt(s,n[2],s),bt(a,s),bt(o,a),se(c,o,a),se(r,c,i),se(r,r,s),(function(u,h){var l,f=Y();for(l=0;l<16;l++)f[l]=h[l];for(l=250;l>=0;l--)bt(f,f),l!==1&&se(f,f,h);for(l=0;l<16;l++)u[l]=f[l]})(r,r),se(r,r,i),se(r,r,s),se(r,r,s),se(n[0],r,s),bt(t,n[0]),se(t,t,s),ec(t,i)&&se(n[0],n[0],mh),bt(t,n[0]),se(t,t,s),ec(t,i)?-1:(v0(n[0])===e[31]>>7&&Kt(n[0],ca,n[0]),se(n[3],n[0],n[1]),0)}var wr=64;function Mr(){for(var n=0;n<arguments.length;n++)if(!(arguments[n]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}_e.scalarMult=function(n,e){if(Mr(n,e),n.length!==32)throw Error("bad n size");if(e.length!==32)throw Error("bad p size");var r=new Uint8Array(32);return I0(r,n,e),r},_e.box={},_e.box.keyPair=function(){var n=new Uint8Array(32),e=new Uint8Array(32);return(function(r,t){oa(t,32),tc(r,t)})(n,e),{publicKey:n,secretKey:e}},_e.box.keyPair.fromSecretKey=function(n){if(Mr(n),n.length!==32)throw Error("bad secret key size");var e=new Uint8Array(32);return tc(e,n),{publicKey:e,secretKey:new Uint8Array(n)}},_e.sign=function(n,e){if(Mr(n,e),e.length!==64)throw Error("bad secret key size");var r=new Uint8Array(wr+n.length);return(function(t,i,s,a){var o,c,u=new Uint8Array(64),h=new Uint8Array(64),l=new Uint8Array(64),f=new Float64Array(64),p=[Y(),Y(),Y(),Y()];for(xn(u,a,32),u[0]&=248,u[31]&=127,u[31]|=64,o=0;o<s;o++)t[64+o]=i[o];for(o=0;o<32;o++)t[32+o]=u[32+o];for(xn(l,t.subarray(32),s+32),Ks(l),ha(p,l),ua(t,p),o=32;o<64;o++)t[o]=a[o];for(xn(h,t,s+64),Ks(h),o=0;o<64;o++)f[o]=0;for(o=0;o<32;o++)f[o]=l[o];for(o=0;o<32;o++)for(c=0;c<32;c++)f[o+c]+=h[o]*u[c];k0(t.subarray(32),f)})(r,n,n.length,e),r},_e.sign.detached=function(n,e){for(var r=_e.sign(n,e),t=new Uint8Array(wr),i=0;i<t.length;i++)t[i]=r[i];return t},_e.sign.detached.verify=function(n,e,r){if(Mr(n,e,r),e.length!==wr)throw Error("bad signature size");if(r.length!==32)throw Error("bad public key size");var t,i=new Uint8Array(wr+n.length),s=new Uint8Array(wr+n.length);for(t=0;t<wr;t++)i[t]=e[t];for(t=0;t<n.length;t++)i[t+wr]=n[t];return(function(a,o,c,u){var h,l=new Uint8Array(32),f=new Uint8Array(64),p=[Y(),Y(),Y(),Y()],y=[Y(),Y(),Y(),Y()];if(c<64||bh(y,u))return-1;for(h=0;h<c;h++)a[h]=o[h];for(h=0;h<32;h++)a[h+32]=u[h];if(xn(f,a,c),Ks(f),C0(p,y,f),ha(y,o.subarray(32)),la(p,y),ua(l,p),c-=64,E0(o,0,l,0)){for(h=0;h<c;h++)a[h]=0;return-1}for(h=0;h<c;h++)a[h]=o[h+64];return c})(s,i,i.length,r)>=0},_e.sign.keyPair=function(){var n=new Uint8Array(32),e=new Uint8Array(64);return sc(n,e),{publicKey:n,secretKey:e}},_e.sign.keyPair.fromSecretKey=function(n){if(Mr(n),n.length!==64)throw Error("bad secret key size");for(var e=new Uint8Array(32),r=0;r<e.length;r++)e[r]=n[32+r];return{publicKey:e,secretKey:new Uint8Array(n)}},_e.sign.keyPair.fromSeed=function(n){if(Mr(n),n.length!==32)throw Error("bad seed size");for(var e=new Uint8Array(32),r=new Uint8Array(64),t=0;t<32;t++)r[t]=n[t];return sc(e,r,!0),{publicKey:e,secretKey:r}},_e.setPRNG=function(n){oa=n},(function(){Us&&Us.getRandomValues&&_e.setPRNG((function(n,e){var r,t=new Uint8Array(e);for(r=0;r<e;r+=65536)Us.getRandomValues(t.subarray(r,r+Math.min(e-r,65536)));for(r=0;r<e;r++)n[r]=t[r];(function(i){for(var s=0;s<i.length;s++)i[s]=0})(t)}))})();var an=Object.freeze({__proto__:null,default:_e});function Ts(n,e,r,t,i,s){const a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],u=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],f=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],p=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];let y,w,g,m,S,E,v,U,T,D,I=0,b=e.length;const k=n.length===32?3:9;U=k===3?r?[0,32,2]:[30,-2,-2]:r?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],r&&(e=(function(B){const P=8-B.length%8;let R;if(!(P<8)){if(P===8)return B;throw Error("des: invalid padding")}R=0;const K=new Uint8Array(B.length+P);for(let N=0;N<B.length;N++)K[N]=B[N];for(let N=0;N<P;N++)K[B.length+N]=R;return K})(e),b=e.length);let x=new Uint8Array(b),C=0;for(;I<b;){for(E=e[I++]<<24|e[I++]<<16|e[I++]<<8|e[I++],v=e[I++]<<24|e[I++]<<16|e[I++]<<8|e[I++],g=252645135&(E>>>4^v),v^=g,E^=g<<4,g=65535&(E>>>16^v),v^=g,E^=g<<16,g=858993459&(v>>>2^E),E^=g,v^=g<<2,g=16711935&(v>>>8^E),E^=g,v^=g<<8,g=1431655765&(E>>>1^v),v^=g,E^=g<<1,E=E<<1|E>>>31,v=v<<1|v>>>31,w=0;w<k;w+=3){for(T=U[w+1],D=U[w+2],y=U[w];y!==T;y+=D)m=v^n[y],S=(v>>>4|v<<28)^n[y+1],g=E,E=v,v=g^(o[m>>>24&63]|u[m>>>16&63]|l[m>>>8&63]|p[63&m]|a[S>>>24&63]|c[S>>>16&63]|h[S>>>8&63]|f[63&S]);g=E,E=v,v=g}E=E>>>1|E<<31,v=v>>>1|v<<31,g=1431655765&(E>>>1^v),v^=g,E^=g<<1,g=16711935&(v>>>8^E),E^=g,v^=g<<8,g=858993459&(v>>>2^E),E^=g,v^=g<<2,g=65535&(E>>>16^v),v^=g,E^=g<<16,g=252645135&(E>>>4^v),v^=g,E^=g<<4,x[C++]=E>>>24,x[C++]=E>>>16&255,x[C++]=E>>>8&255,x[C++]=255&E,x[C++]=v>>>24,x[C++]=v>>>16&255,x[C++]=v>>>8&255,x[C++]=255&v}return r||(x=(function(B){let P,R=null;if(P=0,!R){for(R=1;B[B.length-R]===P;)R++;R--}return B.subarray(0,B.length-R)})(x)),x}function Rs(n){const e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],t=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],l=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],y=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],w=n.length>8?3:1,g=Array(32*w),m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];let S,E,v,U=0,T=0;for(let D=0;D<w;D++){let I=n[U++]<<24|n[U++]<<16|n[U++]<<8|n[U++],b=n[U++]<<24|n[U++]<<16|n[U++]<<8|n[U++];v=252645135&(I>>>4^b),b^=v,I^=v<<4,v=65535&(b>>>-16^I),I^=v,b^=v<<-16,v=858993459&(I>>>2^b),b^=v,I^=v<<2,v=65535&(b>>>-16^I),I^=v,b^=v<<-16,v=1431655765&(I>>>1^b),b^=v,I^=v<<1,v=16711935&(b>>>8^I),I^=v,b^=v<<8,v=1431655765&(I>>>1^b),b^=v,I^=v<<1,v=I<<8|b>>>20&240,I=b<<24|b<<8&16711680|b>>>8&65280|b>>>24&240,b=v;for(let k=0;k<16;k++)m[k]?(I=I<<2|I>>>26,b=b<<2|b>>>26):(I=I<<1|I>>>27,b=b<<1|b>>>27),I&=-15,b&=-15,S=e[I>>>28]|r[I>>>24&15]|t[I>>>20&15]|i[I>>>16&15]|s[I>>>12&15]|a[I>>>8&15]|o[I>>>4&15],E=c[b>>>28]|u[b>>>24&15]|h[b>>>20&15]|l[b>>>16&15]|f[b>>>12&15]|p[b>>>8&15]|y[b>>>4&15],v=65535&(E>>>16^S),g[T++]=S^v,g[T++]=E^v<<16}return g}function In(n){this.key=[];for(let e=0;e<3;e++)this.key.push(new Uint8Array(n.subarray(8*e,8*e+8)));this.encrypt=function(e){return Ts(Rs(this.key[2]),Ts(Rs(this.key[1]),Ts(Rs(this.key[0]),e,!0),!1),!0)}}function Eh(){this.BlockSize=8,this.KeySize=16,this.setKey=function(a){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),a.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(a),!0},this.reset=function(){for(let a=0;a<16;a++)this.masking[a]=0,this.rotate[a]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(a){const o=Array(a.length);for(let c=0;c<a.length;c+=8){let u,h=a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],l=a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7];u=l,l=h^r(l,this.masking[0],this.rotate[0]),h=u,u=l,l=h^t(l,this.masking[1],this.rotate[1]),h=u,u=l,l=h^i(l,this.masking[2],this.rotate[2]),h=u,u=l,l=h^r(l,this.masking[3],this.rotate[3]),h=u,u=l,l=h^t(l,this.masking[4],this.rotate[4]),h=u,u=l,l=h^i(l,this.masking[5],this.rotate[5]),h=u,u=l,l=h^r(l,this.masking[6],this.rotate[6]),h=u,u=l,l=h^t(l,this.masking[7],this.rotate[7]),h=u,u=l,l=h^i(l,this.masking[8],this.rotate[8]),h=u,u=l,l=h^r(l,this.masking[9],this.rotate[9]),h=u,u=l,l=h^t(l,this.masking[10],this.rotate[10]),h=u,u=l,l=h^i(l,this.masking[11],this.rotate[11]),h=u,u=l,l=h^r(l,this.masking[12],this.rotate[12]),h=u,u=l,l=h^t(l,this.masking[13],this.rotate[13]),h=u,u=l,l=h^i(l,this.masking[14],this.rotate[14]),h=u,u=l,l=h^r(l,this.masking[15],this.rotate[15]),h=u,o[c]=l>>>24&255,o[c+1]=l>>>16&255,o[c+2]=l>>>8&255,o[c+3]=255&l,o[c+4]=h>>>24&255,o[c+5]=h>>>16&255,o[c+6]=h>>>8&255,o[c+7]=255&h}return o},this.decrypt=function(a){const o=Array(a.length);for(let c=0;c<a.length;c+=8){let u,h=a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],l=a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7];u=l,l=h^r(l,this.masking[15],this.rotate[15]),h=u,u=l,l=h^i(l,this.masking[14],this.rotate[14]),h=u,u=l,l=h^t(l,this.masking[13],this.rotate[13]),h=u,u=l,l=h^r(l,this.masking[12],this.rotate[12]),h=u,u=l,l=h^i(l,this.masking[11],this.rotate[11]),h=u,u=l,l=h^t(l,this.masking[10],this.rotate[10]),h=u,u=l,l=h^r(l,this.masking[9],this.rotate[9]),h=u,u=l,l=h^i(l,this.masking[8],this.rotate[8]),h=u,u=l,l=h^t(l,this.masking[7],this.rotate[7]),h=u,u=l,l=h^r(l,this.masking[6],this.rotate[6]),h=u,u=l,l=h^i(l,this.masking[5],this.rotate[5]),h=u,u=l,l=h^t(l,this.masking[4],this.rotate[4]),h=u,u=l,l=h^r(l,this.masking[3],this.rotate[3]),h=u,u=l,l=h^i(l,this.masking[2],this.rotate[2]),h=u,u=l,l=h^t(l,this.masking[1],this.rotate[1]),h=u,u=l,l=h^r(l,this.masking[0],this.rotate[0]),h=u,o[c]=l>>>24&255,o[c+1]=l>>>16&255,o[c+2]=l>>>8&255,o[c+3]=255&l,o[c+4]=h>>>24&255,o[c+5]=h>>16&255,o[c+6]=h>>8&255,o[c+7]=255&h}return o};const n=[,,,,];n[0]=[,,,,],n[0][0]=[4,0,13,15,12,14,8],n[0][1]=[5,2,16,18,17,19,10],n[0][2]=[6,3,23,22,21,20,9],n[0][3]=[7,1,26,25,27,24,11],n[1]=[,,,,],n[1][0]=[0,6,21,23,20,22,16],n[1][1]=[1,4,0,2,1,3,18],n[1][2]=[2,5,7,6,5,4,17],n[1][3]=[3,7,10,9,11,8,19],n[2]=[,,,,],n[2][0]=[4,0,13,15,12,14,8],n[2][1]=[5,2,16,18,17,19,10],n[2][2]=[6,3,23,22,21,20,9],n[2][3]=[7,1,26,25,27,24,11],n[3]=[,,,,],n[3][0]=[0,6,21,23,20,22,16],n[3][1]=[1,4,0,2,1,3,18],n[3][2]=[2,5,7,6,5,4,17],n[3][3]=[3,7,10,9,11,8,19];const e=[,,,,];function r(a,o,c){const u=o+a,h=u<<c|u>>>32-c;return(s[0][h>>>24]^s[1][h>>>16&255])-s[2][h>>>8&255]+s[3][255&h]}function t(a,o,c){const u=o^a,h=u<<c|u>>>32-c;return s[0][h>>>24]-s[1][h>>>16&255]+s[2][h>>>8&255]^s[3][255&h]}function i(a,o,c){const u=o-a,h=u<<c|u>>>32-c;return(s[0][h>>>24]+s[1][h>>>16&255]^s[2][h>>>8&255])-s[3][255&h]}e[0]=[,,,,],e[0][0]=[24,25,23,22,18],e[0][1]=[26,27,21,20,22],e[0][2]=[28,29,19,18,25],e[0][3]=[30,31,17,16,28],e[1]=[,,,,],e[1][0]=[3,2,12,13,8],e[1][1]=[1,0,14,15,13],e[1][2]=[7,6,8,9,3],e[1][3]=[5,4,10,11,7],e[2]=[,,,,],e[2][0]=[19,18,28,29,25],e[2][1]=[17,16,30,31,28],e[2][2]=[23,22,24,25,18],e[2][3]=[21,20,26,27,22],e[3]=[,,,,],e[3][0]=[8,9,7,6,3],e[3][1]=[10,11,5,4,7],e[3][2]=[12,13,3,2,8],e[3][3]=[14,15,1,0,13],this.keySchedule=function(a){const o=[,,,,,,,,],c=Array(32);let u;for(let p=0;p<4;p++)u=4*p,o[p]=a[u]<<24|a[u+1]<<16|a[u+2]<<8|a[u+3];const h=[6,7,4,5];let l,f=0;for(let p=0;p<2;p++)for(let y=0;y<4;y++){for(u=0;u<4;u++){const w=n[y][u];l=o[w[1]],l^=s[4][o[w[2]>>>2]>>>24-8*(3&w[2])&255],l^=s[5][o[w[3]>>>2]>>>24-8*(3&w[3])&255],l^=s[6][o[w[4]>>>2]>>>24-8*(3&w[4])&255],l^=s[7][o[w[5]>>>2]>>>24-8*(3&w[5])&255],l^=s[h[u]][o[w[6]>>>2]>>>24-8*(3&w[6])&255],o[w[0]]=l}for(u=0;u<4;u++){const w=e[y][u];l=s[4][o[w[0]>>>2]>>>24-8*(3&w[0])&255],l^=s[5][o[w[1]>>>2]>>>24-8*(3&w[1])&255],l^=s[6][o[w[2]>>>2]>>>24-8*(3&w[2])&255],l^=s[7][o[w[3]>>>2]>>>24-8*(3&w[3])&255],l^=s[4+u][o[w[4]>>>2]>>>24-8*(3&w[4])&255],c[f]=l,f++}}for(let p=0;p<16;p++)this.masking[p]=c[p],this.rotate[p]=31&c[16+p]};const s=[,,,,,,,,];s[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],s[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],s[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],s[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],s[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],s[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],s[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],s[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function Cn(n){this.cast5=new Eh,this.cast5.setKey(n),this.encrypt=function(e){return this.cast5.encrypt(e)}}In.keySize=In.prototype.keySize=24,In.blockSize=In.prototype.blockSize=8,Cn.blockSize=Cn.prototype.blockSize=8,Cn.keySize=Cn.prototype.keySize=16;const ot=4294967295;function xt(n,e){return(n<<e|n>>>32-e)&ot}function Gt(n,e){return n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24}function ar(n,e,r){n.splice(e,4,255&r,r>>>8&255,r>>>16&255,r>>>24&255)}function Z(n,e){return n>>>8*e&255}function kn(n){this.tf=(function(){let e=null,r=null,t=-1,i=[],s=[[],[],[],[]];function a(h){return s[0][Z(h,0)]^s[1][Z(h,1)]^s[2][Z(h,2)]^s[3][Z(h,3)]}function o(h){return s[0][Z(h,3)]^s[1][Z(h,0)]^s[2][Z(h,1)]^s[3][Z(h,2)]}function c(h,l){let f=a(l[0]),p=o(l[1]);l[2]=xt(l[2]^f+p+i[4*h+8]&ot,31),l[3]=xt(l[3],1)^f+2*p+i[4*h+9]&ot,f=a(l[2]),p=o(l[3]),l[0]=xt(l[0]^f+p+i[4*h+10]&ot,31),l[1]=xt(l[1],1)^f+2*p+i[4*h+11]&ot}function u(h,l){let f=a(l[0]),p=o(l[1]);l[2]=xt(l[2],1)^f+p+i[4*h+10]&ot,l[3]=xt(l[3]^f+2*p+i[4*h+11]&ot,31),f=a(l[2]),p=o(l[3]),l[0]=xt(l[0],1)^f+p+i[4*h+8]&ot,l[1]=xt(l[1]^f+2*p+i[4*h+9]&ot,31)}return{name:"twofish",blocksize:16,open:function(h){let l,f,p,y,w;e=h;const g=[],m=[],S=[];let E;const v=[];let U,T,D;const I=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],b=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],k=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],x=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],C=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],B=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],P=[[],[]],R=[[],[],[],[]];function K(z){return z^z>>2^[0,90,180,238][3&z]}function N(z){return z^z>>1^z>>2^[0,238,180,90][3&z]}function M(z,Q){let G,H,_;for(G=0;G<8;G++)H=Q>>>24,Q=Q<<8&ot|z>>>24,z=z<<8&ot,_=H<<1,128&H&&(_^=333),Q^=H^_<<16,_^=H>>>1,1&H&&(_^=166),Q^=_<<24|_<<8;return Q}function L(z,Q){const G=Q>>4,H=15&Q,_=I[z][G^H],W=b[z][C[H]^B[G]];return x[z][C[W]^B[_]]<<4|k[z][_^W]}function O(z,Q){let G=Z(z,0),H=Z(z,1),_=Z(z,2),W=Z(z,3);switch(E){case 4:G=P[1][G]^Z(Q[3],0),H=P[0][H]^Z(Q[3],1),_=P[0][_]^Z(Q[3],2),W=P[1][W]^Z(Q[3],3);case 3:G=P[1][G]^Z(Q[2],0),H=P[1][H]^Z(Q[2],1),_=P[0][_]^Z(Q[2],2),W=P[0][W]^Z(Q[2],3);case 2:G=P[0][P[0][G]^Z(Q[1],0)]^Z(Q[0],0),H=P[0][P[1][H]^Z(Q[1],1)]^Z(Q[0],1),_=P[1][P[0][_]^Z(Q[1],2)]^Z(Q[0],2),W=P[1][P[1][W]^Z(Q[1],3)]^Z(Q[0],3)}return R[0][G]^R[1][H]^R[2][_]^R[3][W]}for(e=e.slice(0,32),l=e.length;l!==16&&l!==24&&l!==32;)e[l++]=0;for(l=0;l<e.length;l+=4)S[l>>2]=Gt(e,l);for(l=0;l<256;l++)P[0][l]=L(0,l),P[1][l]=L(1,l);for(l=0;l<256;l++)U=P[1][l],T=K(U),D=N(U),R[0][l]=U+(T<<8)+(D<<16)+(D<<24),R[2][l]=T+(D<<8)+(U<<16)+(D<<24),U=P[0][l],T=K(U),D=N(U),R[1][l]=D+(D<<8)+(T<<16)+(U<<24),R[3][l]=T+(U<<8)+(D<<16)+(T<<24);for(E=S.length/2,l=0;l<E;l++)f=S[l+l],g[l]=f,p=S[l+l+1],m[l]=p,v[E-l-1]=M(f,p);for(l=0;l<40;l+=2)f=16843009*l,p=f+16843009,f=O(f,g),p=xt(O(p,m),8),i[l]=f+p&ot,i[l+1]=xt(f+2*p,9);for(l=0;l<256;l++)switch(f=p=y=w=l,E){case 4:f=P[1][f]^Z(v[3],0),p=P[0][p]^Z(v[3],1),y=P[0][y]^Z(v[3],2),w=P[1][w]^Z(v[3],3);case 3:f=P[1][f]^Z(v[2],0),p=P[1][p]^Z(v[2],1),y=P[0][y]^Z(v[2],2),w=P[0][w]^Z(v[2],3);case 2:s[0][l]=R[0][P[0][P[0][f]^Z(v[1],0)]^Z(v[0],0)],s[1][l]=R[1][P[0][P[1][p]^Z(v[1],1)]^Z(v[0],1)],s[2][l]=R[2][P[1][P[0][y]^Z(v[1],2)]^Z(v[0],2)],s[3][l]=R[3][P[1][P[1][w]^Z(v[1],3)]^Z(v[0],3)]}},close:function(){i=[],s=[[],[],[],[]]},encrypt:function(h,l){r=h,t=l;const f=[Gt(r,t)^i[0],Gt(r,t+4)^i[1],Gt(r,t+8)^i[2],Gt(r,t+12)^i[3]];for(let p=0;p<8;p++)c(p,f);return ar(r,t,f[2]^i[4]),ar(r,t+4,f[3]^i[5]),ar(r,t+8,f[0]^i[6]),ar(r,t+12,f[1]^i[7]),t+=16,r},decrypt:function(h,l){r=h,t=l;const f=[Gt(r,t)^i[4],Gt(r,t+4)^i[5],Gt(r,t+8)^i[6],Gt(r,t+12)^i[7]];for(let p=7;p>=0;p--)u(p,f);ar(r,t,f[2]^i[0]),ar(r,t+4,f[3]^i[1]),ar(r,t+8,f[0]^i[2]),ar(r,t+12,f[1]^i[3]),t+=16},finalize:function(){return r}}})(),this.tf.open(Array.from(n),0),this.encrypt=function(e){return this.tf.encrypt(Array.from(e),0)}}function wt(){}function Bn(n){this.bf=new wt,this.bf.init(n),this.encrypt=function(e){return this.bf.encryptBlock(e)}}kn.keySize=kn.prototype.keySize=32,kn.blockSize=kn.prototype.blockSize=16,wt.prototype.BLOCKSIZE=8,wt.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],wt.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],wt.prototype.NN=16,wt.prototype._clean=function(n){return n<0&&(n=(2147483647&n)+2147483648),n},wt.prototype._F=function(n){let e;const r=255&n,t=255&(n>>>=8),i=255&(n>>>=8),s=255&(n>>>=8);return e=this.sboxes[0][s]+this.sboxes[1][i],e^=this.sboxes[2][t],e+=this.sboxes[3][r],e},wt.prototype._encryptBlock=function(n){let e,r=n[0],t=n[1];for(e=0;e<this.NN;++e){r^=this.parray[e],t=this._F(r)^t;const i=r;r=t,t=i}r^=this.parray[this.NN+0],t^=this.parray[this.NN+1],n[0]=this._clean(t),n[1]=this._clean(r)},wt.prototype.encryptBlock=function(n){let e;const r=[0,0],t=this.BLOCKSIZE/2;for(e=0;e<this.BLOCKSIZE/2;++e)r[0]=r[0]<<8|255&n[e+0],r[1]=r[1]<<8|255&n[e+t];this._encryptBlock(r);const i=[];for(e=0;e<this.BLOCKSIZE/2;++e)i[e+0]=r[0]>>>24-8*e&255,i[e+t]=r[1]>>>24-8*e&255;return i},wt.prototype._decryptBlock=function(n){let e,r=n[0],t=n[1];for(e=this.NN+1;e>1;--e){r^=this.parray[e],t=this._F(r)^t;const i=r;r=t,t=i}r^=this.parray[1],t^=this.parray[0],n[0]=this._clean(t),n[1]=this._clean(r)},wt.prototype.init=function(n){let e,r=0;for(this.parray=[],e=0;e<this.NN+2;++e){let i=0;for(let s=0;s<4;++s)i=i<<8|255&n[r],++r>=n.length&&(r=0);this.parray[e]=this.PARRAY[e]^i}for(this.sboxes=[],e=0;e<4;++e)for(this.sboxes[e]=[],r=0;r<256;++r)this.sboxes[e][r]=this.SBOXES[e][r];const t=[0,0];for(e=0;e<this.NN+2;e+=2)this._encryptBlock(t),this.parray[e+0]=t[0],this.parray[e+1]=t[1];for(e=0;e<4;++e)for(r=0;r<256;r+=2)this._encryptBlock(t),this.sboxes[e][r+0]=t[0],this.sboxes[e][r+1]=t[1]},Bn.keySize=Bn.prototype.keySize=16,Bn.blockSize=Bn.prototype.blockSize=8;const vh=new Map(Object.entries({tripledes:In,cast5:Cn,twofish:kn,blowfish:Bn}));var Sh=Object.freeze({__proto__:null,legacyCiphers:vh});function Gr(n,e,r,t){n[e]+=r[t],n[e+1]+=r[t+1]+(n[e]<r[t])}function ac(n,e){n[0]+=e,n[1]+=n[0]<e}function or(n,e,r,t,i,s,a,o){Gr(n,r,n,t),Gr(n,r,e,a);let c=n[s]^n[r],u=n[s+1]^n[r+1];n[s]=u,n[s+1]=c,Gr(n,i,n,s),c=n[t]^n[i],u=n[t+1]^n[i+1],n[t]=c>>>24^u<<8,n[t+1]=u>>>24^c<<8,Gr(n,r,n,t),Gr(n,r,e,o),c=n[s]^n[r],u=n[s+1]^n[r+1],n[s]=c>>>16^u<<16,n[s+1]=u>>>16^c<<16,Gr(n,i,n,s),c=n[t]^n[i],u=n[t+1]^n[i+1],n[t]=u>>>31^c<<1,n[t+1]=c>>>31^u<<1}const B0=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Le=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map((n=>2*n)));function oc(n,e){const r=new Uint32Array(32),t=new Uint32Array(n.b.buffer,n.b.byteOffset,32);for(let s=0;s<16;s++)r[s]=n.h[s],r[s+16]=B0[s];r[24]^=n.t0[0],r[25]^=n.t0[1];const i=e?4294967295:0;r[28]^=i,r[29]^=i;for(let s=0;s<12;s++){const a=s<<4;or(r,t,0,8,16,24,Le[a+0],Le[a+1]),or(r,t,2,10,18,26,Le[a+2],Le[a+3]),or(r,t,4,12,20,28,Le[a+4],Le[a+5]),or(r,t,6,14,22,30,Le[a+6],Le[a+7]),or(r,t,0,10,20,30,Le[a+8],Le[a+9]),or(r,t,2,12,22,24,Le[a+10],Le[a+11]),or(r,t,4,14,16,26,Le[a+12],Le[a+13]),or(r,t,6,8,18,28,Le[a+14],Le[a+15])}for(let s=0;s<16;s++)n.h[s]^=r[s]^r[s+16]}class xh{constructor(e,r,t,i){const s=new Uint8Array(64);this.S={b:new Uint8Array(wn),h:new Uint32Array(fa/4),t0:new Uint32Array(2),c:0,outlen:e},s[0]=e,r&&(s[1]=r.length),s[2]=1,s[3]=1,t&&s.set(t,32),i&&s.set(i,48);const a=new Uint32Array(s.buffer,s.byteOffset,s.length/Uint32Array.BYTES_PER_ELEMENT);for(let o=0;o<16;o++)this.S.h[o]=B0[o]^a[o];if(r){const o=new Uint8Array(wn);o.set(r),this.update(o)}}update(e){if(!(e instanceof Uint8Array))throw Error("Input must be Uint8Array or Buffer");let r=0;for(;r<e.length;){this.S.c===wn&&(ac(this.S.t0,this.S.c),oc(this.S,!1),this.S.c=0);let t=wn-this.S.c;this.S.b.set(e.subarray(r,r+t),this.S.c);const i=Math.min(t,e.length-r);this.S.c+=i,r+=i}return this}digest(e){ac(this.S.t0,this.S.c),this.S.b.fill(0,this.S.c),this.S.c=wn,oc(this.S,!0);const r=e||new Uint8Array(this.S.outlen);for(let t=0;t<this.S.outlen;t++)r[t]=this.S.h[t>>2]>>8*(3&t);return this.S.h=null,r.buffer}}function wi(n,e,r,t){if(n>fa)throw Error(`outlen must be at most ${fa} (given: ${n})`);return new xh(n,e,r,t)}const fa=64,wn=128,Ht=1024,Ih=new Uint8Array(new Uint16Array([43981]).buffer)[0]===205;function Ve(n,e,r){return n[r+0]=e,n[r+1]=e>>8,n[r+2]=e>>16,n[r+3]=e>>24,n}function mr(n,e,r){if(e>Number.MAX_SAFE_INTEGER)throw Error("LE64: large numbers unsupported");let t=e;for(let i=r;i<r+7;i++)n[i]=t,t=(t-n[i])/256;return n}function Ns(n,e,r){const t=new Uint8Array(64),i=new Uint8Array(4+e.length);if(Ve(i,n,0),i.set(e,4),n<=64)return wi(n).update(i).digest(r),r;const s=Math.ceil(n/32)-2;for(let o=0;o<s;o++)wi(64).update(o===0?i:t).digest(t),r.set(t.subarray(0,32),32*o);const a=new Uint8Array(wi(n-32*s).update(t).digest());return r.set(a,32*s),r}function cc(n,e,r,t){return n.fn.XOR(e.byteOffset,r.byteOffset,t.byteOffset),e}function Ch(n,e,r,t){return n.fn.G(e.byteOffset,r.byteOffset,t.byteOffset,n.refs.gZ.byteOffset),t}function kh(n,e,r,t){return n.fn.G2(e.byteOffset,r.byteOffset,t.byteOffset,n.refs.gZ.byteOffset),t}function*Bh(n,e,r,t,i,s,a,o){n.refs.prngTmp.fill(0);const c=n.refs.prngTmp.subarray(0,48);mr(c,e,0),mr(c,r,8),mr(c,t,16),mr(c,i,24),mr(c,s,32),mr(c,2,40);for(let u=1;u<=a;u++){mr(n.refs.prngTmp,u,c.length);const h=kh(n,n.refs.ZERO1024,n.refs.prngTmp,n.refs.prngR);for(let l=u===1?8*o:0;l<h.length;l+=8)yield h.subarray(l,l+8)}return[]}function Uh(n,{memory:e,instance:r}){if(!Ih)throw Error("BigEndian system not supported");const t=(function({type:b,version:k,tagLength:x,password:C,salt:B,ad:P,secret:R,parallelism:K,memorySize:N,passes:M}){const L=(O,z,Q,G)=>{if(z<Q||z>G)throw Error(`${O} size should be between ${Q} and ${G} bytes`)};if(b!==2||k!==19)throw Error("Unsupported type or version");return L("password",C,8,4294967295),L("salt",B,8,4294967295),L("tag",x,4,4294967295),L("memory",N,8*K,4294967295),P&&L("associated data",P,0,4294967295),R&&L("secret",R,0,32),{type:b,version:k,tagLength:x,password:C,salt:B,ad:P,secret:R,lanes:K,memorySize:N,passes:M}})({type:2,version:19,...n}),{G:i,G2:s,xor:a,getLZ:o}=r.exports,c={},u={};u.G=i,u.G2=s,u.XOR=a;const h=4*t.lanes*Math.floor(t.memorySize/(4*t.lanes)),l=h*Ht+10240;if(e.buffer.byteLength<l){const b=Math.ceil((l-e.buffer.byteLength)/65536);e.grow(b)}let f=0;c.gZ=new Uint8Array(e.buffer,f,Ht),f+=c.gZ.length,c.prngR=new Uint8Array(e.buffer,f,Ht),f+=c.prngR.length,c.prngTmp=new Uint8Array(e.buffer,f,Ht),f+=c.prngTmp.length,c.ZERO1024=new Uint8Array(e.buffer,f,1024),f+=c.ZERO1024.length;const p=new Uint32Array(e.buffer,f,2);f+=p.length*Uint32Array.BYTES_PER_ELEMENT;const y={fn:u,refs:c},w=new Uint8Array(e.buffer,f,Ht);f+=w.length;const g=new Uint8Array(e.buffer,f,t.memorySize*Ht),m=new Uint8Array(e.buffer,0,f),S=(function(b){const k=wi(64),x=new Uint8Array(4),C=new Uint8Array(24);Ve(C,b.lanes,0),Ve(C,b.tagLength,4),Ve(C,b.memorySize,8),Ve(C,b.passes,12),Ve(C,b.version,16),Ve(C,b.type,20);const B=[C];b.password?(B.push(Ve(new Uint8Array(4),b.password.length,0)),B.push(b.password)):B.push(x),b.salt?(B.push(Ve(new Uint8Array(4),b.salt.length,0)),B.push(b.salt)):B.push(x),b.secret?(B.push(Ve(new Uint8Array(4),b.secret.length,0)),B.push(b.secret)):B.push(x),b.ad?(B.push(Ve(new Uint8Array(4),b.ad.length,0)),B.push(b.ad)):B.push(x),k.update((function(R){if(R.length===1)return R[0];let K=0;for(let L=0;L<R.length;L++){if(!(R[L]instanceof Uint8Array))throw Error("concatArrays: Data must be in the form of a Uint8Array");K+=R[L].length}const N=new Uint8Array(K);let M=0;return R.forEach((L=>{N.set(L,M),M+=L.length})),N})(B));const P=k.digest();return new Uint8Array(P)})(t),E=h/t.lanes,v=Array(t.lanes).fill(null).map((()=>Array(E))),U=(b,k)=>(v[b][k]=g.subarray(b*E*1024+1024*k,b*E*1024+1024*k+Ht),v[b][k]);for(let b=0;b<t.lanes;b++){const k=new Uint8Array(S.length+8);k.set(S),Ve(k,0,S.length),Ve(k,b,S.length+4),Ns(Ht,k,U(b,0)),Ve(k,1,S.length),Ns(Ht,k,U(b,1))}const T=E/4;for(let b=0;b<t.passes;b++)for(let k=0;k<4;k++){const x=b===0&&k<=1;for(let C=0;C<t.lanes;C++){let B=k===0&&b===0?2:0;const P=x?Bh(y,b,C,k,h,t.passes,T,B):null;for(;B<T;B++){const R=k*T+B,K=R>0?v[C][R-1]:v[C][E-1],N=x?P.next().value:K;o(p.byteOffset,N.byteOffset,C,t.lanes,b,k,B,4,T);const M=p[0],L=p[1];b===0&&U(C,R),Ch(y,K,v[M][L],b>0?w:v[C][R]),b>0&&cc(y,v[C][R],w,v[C][R])}}}const D=v[0][E-1];for(let b=1;b<t.lanes;b++)cc(y,D,D,v[b][E-1]);const I=Ns(t.tagLength,D,new Uint8Array(t.tagLength));return m.fill(0),e.grow(0),I}let oi;async function Dh(n,e){const r=new WebAssembly.Memory({initial:1040,maximum:65536}),t=await(async function(i,s,a){const o={env:{memory:i}};if(oi===void 0)try{const c=await s(o);return oi=!0,c}catch{oi=!1}return(oi?s:a)(o)})(r,n,e);return i=>Uh(i,{instance:t.instance,memory:r})}function lc(n,e,r,t){var i=null,s=Qe.atob(r),a=s.length;i=new Uint8Array(new ArrayBuffer(a));for(var o=0;o<a;o++)i[o]=s.charCodeAt(o);return(function(c,u,h){var l=WebAssembly.instantiate,f=WebAssembly.compile;return u?l(c,u):f(c)})(i,t)}var uc,hc,fc,dc,pc,yc,gc,Ac,Ph=Object.freeze({__proto__:null,default:async()=>Dh((n=>lc(0,0,"AGFzbQEAAAABKwdgBH9/f38AYAABf2AAAGADf39/AGAJf39/f39/f39/AX9gAX8AYAF/AX8CEwEDZW52Bm1lbW9yeQIBkAiAgAQDCgkCAwAABAEFBgEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwACAkcyAAMFZ2V0TFoABBlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAgJc3RhY2tTYXZlAAUMc3RhY2tSZXN0b3JlAAYKc3RhY2tBbGxvYwAHCQcBAEEBCwEACs0gCQMAAQtYAQJ/A0AgACAEQQR0IgNqIAIgA2r9AAQAIAEgA2r9AAQA/VH9CwQAIAAgA0EQciIDaiACIANq/QAEACABIANq/QAEAP1R/QsEACAEQQJqIgRBwABHDQALC7ceAgt7A38DQCADIBFBBHQiD2ogASAPav0ABAAgACAPav0ABAD9USIF/QsEACACIA9qIAX9CwQAIAMgD0EQciIPaiABIA9q/QAEACAAIA9q/QAEAP1RIgX9CwQAIAIgD2ogBf0LBAAgEUECaiIRQcAARw0ACwNAIAMgEEEHdGoiAEEQaiAA/QAEcCAA/QAEMCIFIAD9AAQQIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEUCIG/c4BIAkgCf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAX9USIFQSj9ywEgBUEY/c0B/VAiCCAE/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAEIAT9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAogCf1RIgVBMP3LASAFQRD9zQH9UCIFIAb9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCP1RIgRBAf3LASAEQT/9zQH9UCIMIAD9AARgIAD9AAQgIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIABBQGsiAf0ABAAiB/3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiByAE/VEiBEEo/csBIARBGP3NAf1QIgsgBv3OASALIAv9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAI/VEiBEEw/csBIARBEP3NAf1QIgQgB/3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAL/VEiB0EB/csBIAdBP/3NAf1QIg0gDf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eHyIH/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/VEiC0Eg/csBIAtBIP3NAf1QIgsgCP3OASALIAv9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAH/VEiB0Eo/csBIAdBGP3NAf1QIgcgCv3OASAHIAf9DQABAgMICQoLAAECAwgJCgsgCiAK/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiDv0LBAAgACAGIA0gDCAM/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgr9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgYgBSAEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USIFQSD9ywEgBUEg/c0B/VAiBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAr9USIEQSj9ywEgBEEY/c0B/VAiCiAG/c4BIAogCv0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAQgBf1RIgVBMP3LASAFQRD9zQH9UCIFIA4gC/1RIgRBMP3LASAEQRD9zQH9UCIEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRgIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRwIAEgBCAI/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAUgCf3OASAFIAX9DQABAgMICQoLAAECAwgJCgsgCSAJ/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCf0LBFAgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEICAAIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEMCAQQQFqIhBBCEcNAAtBACEQA0AgAyAQQQR0aiIAQYABaiAA/QAEgAcgAP0ABIADIgUgAP0ABIABIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEgAUiBv3OASAJIAn9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAF/VEiBUEo/csBIAVBGP3NAf1QIgggBP3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgBCAE/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCiAKIAn9USIFQTD9ywEgBUEQ/c0B/VAiBSAG/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAj9USIEQQH9ywEgBEE//c0B/VAiDCAA/QAEgAYgAP0ABIACIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIAD9AASABCIH/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIHIAT9USIEQSj9ywEgBEEY/c0B/VAiCyAG/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAj9USIEQTD9ywEgBEEQ/c0B/VAiBCAH/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAv9USIHQQH9ywEgB0E//c0B/VAiDSAN/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgf9zgEgByAH/Q0AAQIDCAkKCwABAgMICQoLIAogCv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgogBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USILQSD9ywEgC0Eg/c0B/VAiCyAI/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAf9USIHQSj9ywEgB0EY/c0B/VAiByAK/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIO/QsEACAAIAYgDSAMIAz9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh8iCv3OASAKIAr9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAFIAQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/1RIgVBIP3LASAFQSD9zQH9UCIFIAn9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAkgCf0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCv1RIgRBKP3LASAEQRj9zQH9UCIKIAb9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9CwQAIAAgBCAF/VEiBUEw/csBIAVBEP3NAf1QIgUgDiAL/VEiBEEw/csBIARBEP3NAf1QIgQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIAGIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwSAByAAIAQgCP3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBP0LBIAEIAAgBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJ/QsEgAUgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEgAIgACAEIAUgBf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIADIBBBAWoiEEEIRw0AC0EAIRADQCACIBBBBHQiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACACIABBEHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBIHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBMHIiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACAQQQRqIhBBwABHDQALCxYAIAAgASACIAMQAiAAIAIgAiADEAILewIBfwF+IAIhCSABNQIAIQogBCAFcgRAIAEoAgQgA3AhCQsgACAJNgIAIAAgB0EBayAFIAQbIAhsIAZBAWtBAEF/IAYbIAIgCUYbaiIBIAVBAWogCGxBACAEG2ogAa0gCiAKfkIgiH5CIIinQX9zaiAHIAhscDYCBCAACwQAIwALBgAgACQACxAAIwAgAGtBcHEiACQAIAALBQBBgAgL",n)),(n=>lc(0,0,"AGFzbQEAAAABPwhgBH9/f38AYAABf2AAAGADf39/AGARf39/f39/f39/f39/f39/f38AYAl/f39/f39/f38Bf2ABfwBgAX8BfwITAQNlbnYGbWVtb3J5AgGQCICABAMLCgIDBAAABQEGBwEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwADAkcyAAQFZ2V0TFoABRlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAkJc3RhY2tTYXZlAAYMc3RhY2tSZXN0b3JlAAcKc3RhY2tBbGxvYwAICQcBAEEBCwEACssaCgMAAQtQAQJ/A0AgACAEQQN0IgNqIAIgA2opAwAgASADaikDAIU3AwAgACADQQhyIgNqIAIgA2opAwAgASADaikDAIU3AwAgBEECaiIEQYABRw0ACwveDwICfgF/IAAgAUEDdGoiEyATKQMAIhEgACAFQQN0aiIBKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA1BA3RqIgUgESAFKQMAhUIgiSIRNwMAIAAgCUEDdGoiCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIoiSIRNwMAIBMgESATKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAFIBEgBSkDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgASARIAEpAwCFQgGJNwMAIAAgAkEDdGoiDSANKQMAIhEgACAGQQN0aiICKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA5BA3RqIgYgESAGKQMAhUIgiSIRNwMAIAAgCkEDdGoiCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIoiSIRNwMAIA0gESANKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAKIBEgCikDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAiARIAIpAwCFQgGJNwMAIAAgA0EDdGoiDiAOKQMAIhEgACAHQQN0aiIDKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA9BA3RqIgcgESAHKQMAhUIgiSIRNwMAIAAgC0EDdGoiCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAMgESADKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAHIBEgBykDAIVCMIkiETcDACALIBEgCykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQgGJNwMAIAAgBEEDdGoiDyAPKQMAIhEgACAIQQN0aiIEKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIBBBA3RqIgggESAIKQMAhUIgiSIRNwMAIAAgDEEDdGoiACARIAApAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA8gESAPKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAIIBEgCCkDAIVCMIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIBMgEykDACIRIAIpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAggESAIKQMAhUIgiSIRNwMAIAsgESALKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACACIBEgAikDAIVCKIkiETcDACATIBEgEykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgCCARIAgpAwCFQjCJIhE3AwAgCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIBiTcDACANIA0pAwAiESADKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAFIBEgBSkDAIVCIIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQiiJIhE3AwAgDSARIA0pAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAUgESAFKQMAhUIwiSIRNwMAIAAgESAAKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACADIBEgAykDAIVCAYk3AwAgDiAOKQMAIhEgBCkDACISfCARQgGGQv7///8fgyASQv////8Pg358IhE3AwAgBiARIAYpAwCFQiCJIhE3AwAgCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIA8gDykDACIRIAEpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAcgESAHKQMAhUIgiSIRNwMAIAogESAKKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACABIBEgASkDAIVCKIkiETcDACAPIBEgDykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgByARIAcpAwCFQjCJIhE3AwAgCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIBiTcDAAvdCAEPfwNAIAIgBUEDdCIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAIgBkEIciIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAVBAmoiBUGAAUcNAAsDQCADIARBA3QiAGogACACaikDADcDACADIARBAXIiAEEDdCIBaiABIAJqKQMANwMAIAMgBEECciIBQQN0IgVqIAIgBWopAwA3AwAgAyAEQQNyIgVBA3QiBmogAiAGaikDADcDACADIARBBHIiBkEDdCIHaiACIAdqKQMANwMAIAMgBEEFciIHQQN0IghqIAIgCGopAwA3AwAgAyAEQQZyIghBA3QiCWogAiAJaikDADcDACADIARBB3IiCUEDdCIKaiACIApqKQMANwMAIAMgBEEIciIKQQN0IgtqIAIgC2opAwA3AwAgAyAEQQlyIgtBA3QiDGogAiAMaikDADcDACADIARBCnIiDEEDdCINaiACIA1qKQMANwMAIAMgBEELciINQQN0Ig5qIAIgDmopAwA3AwAgAyAEQQxyIg5BA3QiD2ogAiAPaikDADcDACADIARBDXIiD0EDdCIQaiACIBBqKQMANwMAIAMgBEEOciIQQQN0IhFqIAIgEWopAwA3AwAgAyAEQQ9yIhFBA3QiEmogAiASaikDADcDACADIARB//8DcSAAQf//A3EgAUH//wNxIAVB//8DcSAGQf//A3EgB0H//wNxIAhB//8DcSAJQf//A3EgCkH//wNxIAtB//8DcSAMQf//A3EgDUH//wNxIA5B//8DcSAPQf//A3EgEEH//wNxIBFB//8DcRACIARB8ABJIQAgBEEQaiEEIAANAAtBACEBIANBAEEBQRBBEUEgQSFBMEExQcAAQcEAQdAAQdEAQeAAQeEAQfAAQfEAEAIgA0ECQQNBEkETQSJBI0EyQTNBwgBBwwBB0gBB0wBB4gBB4wBB8gBB8wAQAiADQQRBBUEUQRVBJEElQTRBNUHEAEHFAEHUAEHVAEHkAEHlAEH0AEH1ABACIANBBkEHQRZBF0EmQSdBNkE3QcYAQccAQdYAQdcAQeYAQecAQfYAQfcAEAIgA0EIQQlBGEEZQShBKUE4QTlByABByQBB2ABB2QBB6ABB6QBB+ABB+QAQAiADQQpBC0EaQRtBKkErQTpBO0HKAEHLAEHaAEHbAEHqAEHrAEH6AEH7ABACIANBDEENQRxBHUEsQS1BPEE9QcwAQc0AQdwAQd0AQewAQe0AQfwAQf0AEAIgA0EOQQ9BHkEfQS5BL0E+QT9BzgBBzwBB3gBB3wBB7gBB7wBB/gBB/wAQAgNAIAIgAUEDdCIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAiAAQQhyIgRqIgUgAyAEaikDACAFKQMAhTcDACACIABBEHIiBGoiBSADIARqKQMAIAUpAwCFNwMAIAIgAEEYciIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAUEEaiIBQYABRw0ACwsWACAAIAEgAiADEAMgACACIAIgAxADC3sCAX8BfiACIQkgATUCACEKIAQgBXIEQCABKAIEIANwIQkLIAAgCTYCACAAIAdBAWsgBSAEGyAIbCAGQQFrQQBBfyAGGyACIAlGG2oiASAFQQFqIAhsQQAgBBtqIAGtIAogCn5CIIh+QiCIp0F/c2ogByAIbHA2AgQgAAsEACMACwYAIAAkAAsQACMAIABrQXBxIgAkACAACwUAQYAICw==",n)))});function Kh(){if(hc)return uc;hc=1;var n=[0,1,3,7,15,31,63,127,255],e=function(r){this.stream=r,this.bitOffset=0,this.curByte=0,this.hasByte=!1};return e.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},e.prototype.read=function(r){for(var t=0;r>0;){this._ensureByte();var i=8-this.bitOffset;if(r>=i)t<<=i,t|=n[i]&this.curByte,this.hasByte=!1,this.bitOffset=0,r-=i;else{t<<=r;var s=i-r;t|=(this.curByte&n[r]<<s)>>s,this.bitOffset+=r,r=0}}return t},e.prototype.seek=function(r){var t=r%8,i=(r-t)/8;this.bitOffset=t,this.stream.seek(i),this.hasByte=!1},e.prototype.pi=function(){var r,t=new Uint8Array(6);for(r=0;r<t.length;r++)t[r]=this.read(8);return(function(i){return Array.prototype.map.call(i,(s=>("00"+s.toString(16)).slice(-2))).join("")})(t)},uc=e}var Th=(function(){if(Ac)return gc;Ac=1;var n,e=Kh(),r=(function(){if(dc)return fc;dc=1;var l=function(){};return l.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},l.prototype.read=function(f,p,y){for(var w=0;w<y;){var g=this.readByte();if(g<0)return w===0?-1:w;f[p++]=g,w++}return w},l.prototype.seek=function(f){throw Error("abstract method seek() not implemented")},l.prototype.writeByte=function(f){throw Error("abstract method readByte() not implemented")},l.prototype.write=function(f,p,y){var w;for(w=0;w<y;w++)this.writeByte(f[p++]);return y},l.prototype.flush=function(){},fc=l})(),t=yc?pc:(yc=1,n=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),pc=function(){var l=4294967295;this.getCRC=function(){return~l>>>0},this.updateCRC=function(f){l=l<<8^n[255&(l>>>24^f)]},this.updateCRCRun=function(f,p){for(;p-- >0;)l=l<<8^n[255&(l>>>24^f)]}}),i=function(l,f){var p,y=l[f];for(p=f;p>0;p--)l[p]=l[p-1];return l[0]=y,y},s={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},a={};a[s.LAST_BLOCK]="Bad file checksum",a[s.NOT_BZIP_DATA]="Not bzip data",a[s.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",a[s.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",a[s.DATA_ERROR]="Data error",a[s.OUT_OF_MEMORY]="Out of memory",a[s.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var o=function(l,f){var p=a[l]||"unknown error";f&&(p+=": "+f);var y=new TypeError(p);throw y.errorCode=l,y},c=function(l,f){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(l,f)};c.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new t,!0):(this.writeCount=-1,!1)},c.prototype._start_bunzip=function(l,f){var p=new Uint8Array(4);l.read(p,0,4)===4&&String.fromCharCode(p[0],p[1],p[2])==="BZh"||o(s.NOT_BZIP_DATA,"bad magic");var y=p[3]-48;(y<1||y>9)&&o(s.NOT_BZIP_DATA,"level out of range"),this.reader=new e(l),this.dbufSize=1e5*y,this.nextoutput=0,this.outputStream=f,this.streamCRC=0},c.prototype._get_next_block=function(){var l,f,p,y=this.reader,w=y.pi();if(w==="177245385090")return!1;w!=="314159265359"&&o(s.NOT_BZIP_DATA),this.targetBlockCRC=y.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,y.read(1)&&o(s.OBSOLETE_INPUT);var g=y.read(24);g>this.dbufSize&&o(s.DATA_ERROR,"initial position out of bounds");var m=y.read(16),S=new Uint8Array(256),E=0;for(l=0;l<16;l++)if(m&1<<15-l){var v=16*l;for(p=y.read(16),f=0;f<16;f++)p&1<<15-f&&(S[E++]=v+f)}var U=y.read(3);(U<2||U>6)&&o(s.DATA_ERROR);var T=y.read(15);T===0&&o(s.DATA_ERROR);var D=new Uint8Array(256);for(l=0;l<U;l++)D[l]=l;var I=new Uint8Array(T);for(l=0;l<T;l++){for(f=0;y.read(1);f++)f>=U&&o(s.DATA_ERROR);I[l]=i(D,f)}var b,k=E+2,x=[];for(f=0;f<U;f++){var C,B,P=new Uint8Array(k),R=new Uint16Array(21);for(m=y.read(5),l=0;l<k;l++){for(;(m<1||m>20)&&o(s.DATA_ERROR),y.read(1);)y.read(1)?m--:m++;P[l]=m}for(C=B=P[0],l=1;l<k;l++)P[l]>B?B=P[l]:P[l]<C&&(C=P[l]);b={},x.push(b),b.permute=new Uint16Array(258),b.limit=new Uint32Array(22),b.base=new Uint32Array(21),b.minLen=C,b.maxLen=B;var K=0;for(l=C;l<=B;l++)for(R[l]=b.limit[l]=0,m=0;m<k;m++)P[m]===l&&(b.permute[K++]=m);for(l=0;l<k;l++)R[P[l]]++;for(K=m=0,l=C;l<B;l++)K+=R[l],b.limit[l]=K-1,K<<=1,m+=R[l],b.base[l+1]=K-m;b.limit[B+1]=Number.MAX_VALUE,b.limit[B]=K+R[B]-1,b.base[C]=0}var N=new Uint32Array(256);for(l=0;l<256;l++)D[l]=l;var M,L=0,O=0,z=0,Q=this.dbuf=new Uint32Array(this.dbufSize);for(k=0;;){for(k--||(k=49,z>=T&&o(s.DATA_ERROR),b=x[I[z++]]),l=b.minLen,f=y.read(l);l>b.maxLen&&o(s.DATA_ERROR),!(f<=b.limit[l]);l++)f=f<<1|y.read(1);((f-=b.base[l])<0||f>=258)&&o(s.DATA_ERROR);var G=b.permute[f];if(G!==0&&G!==1){if(L)for(L=0,O+m>this.dbufSize&&o(s.DATA_ERROR),N[M=S[D[0]]]+=m;m--;)Q[O++]=M;if(G>E)break;O>=this.dbufSize&&o(s.DATA_ERROR),N[M=S[M=i(D,l=G-1)]]++,Q[O++]=M}else L||(L=1,m=0),m+=G===0?L:2*L,L<<=1}for((g<0||g>=O)&&o(s.DATA_ERROR),f=0,l=0;l<256;l++)p=f+N[l],N[l]=f,f=p;for(l=0;l<O;l++)Q[N[M=255&Q[l]]]|=l<<8,N[M]++;var H=0,_=0,W=0;return O&&(_=255&(H=Q[g]),H>>=8,W=-1),this.writePos=H,this.writeCurrent=_,this.writeCount=O,this.writeRun=W,!0},c.prototype._read_bunzip=function(l,f){var p,y,w;if(this.writeCount<0)return 0;var g=this.dbuf,m=this.writePos,S=this.writeCurrent,E=this.writeCount;this.outputsize;for(var v=this.writeRun;E;){for(E--,y=S,S=255&(m=g[m]),m>>=8,v++==3?(p=S,w=y,S=-1):(p=1,w=S),this.blockCRC.updateCRCRun(w,p);p--;)this.outputStream.writeByte(w),this.nextoutput++;S!=y&&(v=0)}return this.writeCount=E,this.blockCRC.getCRC()!==this.targetBlockCRC&&o(s.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var u=function(l){if("readByte"in l)return l;var f=new r;return f.pos=0,f.readByte=function(){return l[this.pos++]},f.seek=function(p){this.pos=p},f.eof=function(){return this.pos>=l.length},f},h=function(l){var f=new r,p=!0;if(l)if(typeof l=="number")f.buffer=new Uint8Array(l),p=!1;else{if("writeByte"in l)return l;f.buffer=l,p=!1}else f.buffer=new Uint8Array(16384);return f.pos=0,f.writeByte=function(y){if(p&&this.pos>=this.buffer.length){var w=new Uint8Array(2*this.buffer.length);w.set(this.buffer),this.buffer=w}this.buffer[this.pos++]=y},f.getBuffer=function(){if(this.pos!==this.buffer.length){if(!p)throw new TypeError("outputsize does not match decoded input");var y=new Uint8Array(this.pos);y.set(this.buffer.subarray(0,this.pos)),this.buffer=y}return this.buffer},f._coerced=!0,f};return gc={Bunzip:c,Stream:r,Err:s,decode:function(l,f,p){for(var y=u(l),w=h(f),g=new c(y,w);!("eof"in y)||!y.eof();)if(g._init_block())g._read_bunzip();else{var m=g.reader.read(32)>>>0;if(m!==g.streamCRC&&o(s.DATA_ERROR,"Bad stream CRC (got "+g.streamCRC.toString(16)+" expected "+m.toString(16)+")"),!p||!("eof"in y)||y.eof())break;g._start_bunzip(y,w)}if("getBuffer"in w)return w.getBuffer()},decodeBlock:function(l,f,p){var y=u(l),w=h(p),g=new c(y,w);if(g.reader.seek(f),g._get_next_block()&&(g.blockCRC=new t,g.writeCopies=0,g._read_bunzip()),"getBuffer"in w)return w.getBuffer()},table:function(l,f,p){var y=new r;y.delegate=u(l),y.pos=0,y.readByte=function(){return this.pos++,this.delegate.readByte()},y.delegate.eof&&(y.eof=y.delegate.eof.bind(y.delegate));var w=new r;w.pos=0,w.writeByte=function(){this.pos++};for(var g=new c(y,w),m=g.dbufSize;!("eof"in y)||!y.eof();){var S=8*y.pos+g.reader.bitOffset;if(g.reader.hasByte&&(S-=8),g._init_block()){var E=w.pos;g._read_bunzip(),f(S,w.pos-E)}else{if(g.reader.read(32),!p||!("eof"in y)||y.eof())break;g._start_bunzip(y,w),console.assert(g.dbufSize===m,"shouldn't change block size within multistream file")}}}}})(),Rh=Z0({__proto__:null},[Th]);async function Nh(n,e){try{if(!n||typeof n!="string")throw new Error("明文必须是非空字符串");if(!e||typeof e!="string")throw new Error("密码必须是非空字符串");const r=await R3({text:n});return await N3({message:r,passwords:[e],format:"armored",config:{preferredSymmetricAlgorithm:d.symmetric.aes256,preferredHashAlgorithm:d.hash.sha256,preferredCompressionAlgorithm:d.compression.zip,s2kIterationCountByte:144,aeadProtect:!1}})}catch(r){throw new Error(`加密失败: ${r.message}`)}}async function Un(n,e){try{if(!n)throw new Error("加密数据不能为空");if(!e||typeof e!="string")throw new Error("密码必须是非空字符串");let r,t=!1;const i=[],s=async(a,o,c)=>{try{a==="armored"?r=await Eo({armoredMessage:o}):a==="binary"&&(r=await Eo({binaryMessage:o}));const{data:u}=await O3({message:r,passwords:[e]});return t=!0,u}catch(u){return i.push(`${c}: ${u.message}`),null}};if(typeof n=="string"){const a=await s("armored",n,"字符串-ASCII装甲");if(a)return a;const c=new TextEncoder().encode(n),u=await s("binary",c,"字符串-转二进制");if(u)return u}else if(n instanceof ArrayBuffer){const a=new Uint8Array(n),o=await s("binary",a,"ArrayBuffer-二进制");if(o)return o;try{const u=new TextDecoder("utf-8",{fatal:!1}).decode(n);if(u.includes("-----BEGIN PGP MESSAGE-----")){const h=await s("armored",u,"ArrayBuffer-转ASCII装甲");if(h)return h}}catch{}}else throw new Error("不支持的加密数据格式");throw t?new Error("解密过程中发生未知错误"):i.some(c=>c.includes("Incorrect password")||c.includes("Session key decryption failed")||c.includes("Invalid session key"))?new Error("密码错误，无法解密"):i.some(c=>c.includes("not a valid")||c.includes("Invalid")||c.includes("ASCII armor")||c.includes("No data"))?(console.warn("解密尝试失败详情:",i),new Error("GPG文件格式可能不兼容，请确认文件是通过标准的GPG工具或本工具生成的")):new Error(`解密失败: ${i[0]||"未知错误"}`)}catch(r){throw r.message.includes("密码错误")||r.message.includes("格式")||r.message.includes("不支持的加密数据格式")?r:new Error(`解密失败: ${r.message}`)}}function wc(n){if(!n||typeof n!="string")return{strength:"weak",message:"密码不能为空"};const e=n.length,r=/[A-Z]/.test(n),t=/[a-z]/.test(n),i=/\d/.test(n),s=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(n);let a=0;return e>=8&&(a+=1),e>=12&&(a+=1),r&&(a+=1),t&&(a+=1),i&&(a+=1),s&&(a+=1),a<3?{strength:"weak",message:"密码强度弱：建议使用至少8位字符，包含大小写字母、数字和特殊字符"}:a<5?{strength:"medium",message:"密码强度中等：建议增加密码长度和复杂度"}:{strength:"strong",message:"密码强度强：密码安全性高"}}function mc(n,e){return!n||typeof n!="string"?{isValid:!1,message:"密码不能为空"}:!e||typeof e!="string"?{isValid:!1,message:"确认密码不能为空"}:n!==e?{isValid:!1,message:"两次输入的密码不匹配"}:{isValid:!0,message:"密码匹配成功"}}function Oh(n){try{if(!n)return{type:"unknown",isBinary:!1};if(typeof n=="string")return n.trim().startsWith("-----BEGIN PGP MESSAGE-----")?{type:"ascii-armor",isBinary:!1}:{type:"unknown-text",isBinary:!1};let e;if(n instanceof ArrayBuffer)e=new Uint8Array(n);else if(n instanceof Uint8Array)e=n;else return{type:"unknown",isBinary:!1};const t=new TextEncoder().encode("-----BEGIN PGP MESSAGE-----");if(e.length>=t.length){let i=!0;for(let s=0;s<t.length;s++)if(e[s]!==t[s]){i=!1;break}if(i)return{type:"ascii-armor",isBinary:!1}}return e.length>=2&&(e[0]&128)===128?{type:"binary-packet",isBinary:!0}:{type:"binary",isBinary:!0}}catch{return{type:"unknown",isBinary:!1}}}class Lh{constructor(){this.isVisible=!1,this.currentPassword="",this.resolveCallback=null,this.rejectCallback=null,this.isRetry=!1}show(e=!1){return new Promise((r,t)=>{this.isRetry=e,this.resolveCallback=r,this.rejectCallback=t,this.createDialog(),this.isVisible=!0})}createDialog(){this.removeDialog();const e=ie("div",["password-dialog-overlay"]),r=ie("div",["password-dialog"]),t=ie("h3",["password-dialog-title"]);t.textContent=this.isRetry?V("passwordDialog.retryTitle"):V("passwordDialog.title");const i=ie("p",["password-dialog-message"]);i.textContent=this.isRetry?V("passwordDialog.retryMessage"):V("passwordDialog.message");const s=ie("div",["password-input-group"]),a=ie("label",["password-label"]);a.setAttribute("for","dialogPasswordInput"),a.textContent=V("encryption.passwordLabel");const o=ie("div",["password-input-wrapper"]),c=ie("input",["password-input"]);c.id="dialogPasswordInput",c.type="password",c.placeholder=V("encryption.passwordPlaceholder"),c.autocomplete="new-password";const u=ie("button",["password-toggle-btn"]);u.type="button",u.innerHTML="👁️",u.setAttribute("aria-label","Toggle password visibility"),o.appendChild(c),o.appendChild(u),s.appendChild(a),s.appendChild(o);const h=ie("div",["password-dialog-buttons"]),l=ie("button",["btn","btn-primary"]);l.textContent=V("passwordDialog.confirm"),l.id="dialogConfirmBtn";const f=ie("button",["btn","btn-secondary"]);f.textContent=V("passwordDialog.cancel"),f.id="dialogCancelBtn",h.appendChild(l),h.appendChild(f),r.appendChild(t),r.appendChild(i),r.appendChild(s),r.appendChild(h),e.appendChild(r),document.body.appendChild(e),this.setupEventListeners(c,l,f,u),setTimeout(()=>c.focus(),100)}setupEventListeners(e,r,t,i){te(e,"input",()=>{this.currentPassword=e.value}),te(i,"click",()=>{const a=e.type==="password"?"text":"password";e.type=a,i.innerHTML=a==="password"?"👁️":"👁️‍🗨️"}),te(e,"keydown",a=>{a.key==="Enter"&&this.handleConfirm()}),te(r,"click",()=>{this.handleConfirm()}),te(t,"click",()=>{this.handleCancel()});const s=F(".password-dialog-overlay");s&&te(s,"click",a=>{a.target===s&&this.handleCancel()})}handleConfirm(){if(!this.currentPassword){const e=F("#dialogPasswordInput");e&&(e.classList.add("error"),setTimeout(()=>e.classList.remove("error"),2e3));return}this.removeDialog(),this.isVisible=!1,this.resolveCallback&&this.resolveCallback(this.currentPassword)}handleCancel(){this.removeDialog(),this.isVisible=!1,this.rejectCallback&&this.rejectCallback(new Error("User cancelled password input"))}removeDialog(){const e=F(".password-dialog-overlay");e&&document.body.removeChild(e)}isDialogVisible(){return this.isVisible}}const U0=new Lh;class Qh{constructor(){this.currentShares=[],this.currentThreshold=0,this.copiedShares=new Set,this.isEncryptionEnabled=!1,this.encryptionPassword="",this.encryptedShares=[]}initEncryptionListeners(){const e=F(j.ENABLE_ENCRYPTION),r=F(j.ENCRYPTION_FIELDS),t=F(j.ENCRYPTION_PASSWORD),i=F(j.CONFIRM_PASSWORD),s=F(j.PASSWORD_STRENGTH),a=F(j.PASSWORD_MATCH);!e||!r||(te(e,"change",()=>{this.isEncryptionEnabled=e.checked,Ye(r,this.isEncryptionEnabled),this.isEncryptionEnabled||(t&&(t.value=""),i&&(i.value=""),s&&(s.textContent=""),a&&(a.textContent=""),this.encryptionPassword="")}),t&&s&&te(t,"input",()=>{const o=t.value;if(o){const c=wc(o);s.textContent=c.message,s.className=`password-strength ${c.strength}`}else s.textContent="";this.checkPasswordMatch()}),i&&a&&te(i,"input",()=>{this.checkPasswordMatch()}))}checkPasswordMatch(){const e=F(j.ENCRYPTION_PASSWORD),r=F(j.CONFIRM_PASSWORD),t=F(j.PASSWORD_MATCH);if(!e||!r||!t)return;const i=e.value,s=r.value;if(s){const a=mc(i,s);t.textContent=a.message,t.className=`password-match ${a.isValid?"valid":"invalid"}`}else t.textContent=""}validateEncryptionSettings(){if(!this.isEncryptionEnabled)return{isValid:!0};const e=F(j.ENCRYPTION_PASSWORD),r=F(j.CONFIRM_PASSWORD);if(!e||!r)return{isValid:!1,error:"加密字段缺失，请刷新页面重试"};const t=e.value,i=r.value;return wc(t).strength==="weak"?{isValid:!1,error:"密码过于简单，请使用至少8个字符，包含字母、数字和特殊字符"}:mc(t,i).isValid?(this.encryptionPassword=t,{isValid:!0}):{isValid:!1,error:"两次输入的密码不匹配"}}clearEncryptionPassword(){this.encryptionPassword=""}clearUploadEncryptionPassword(){this.uploadEncryptionPassword=""}async generateShares(e,r,t){try{const i=O0(e);if(!i.isValid)return this.showError(i.errors[0]),!1;const s=this.validateEncryptionSettings();if(!s.isValid)return this.showError(s.error),!1;const a=e.join(" "),o=new TextEncoder().encode(a),c=await $0(o,r,t);return this.currentShares=c.map((u,h)=>{const l={index:h+1,threshold:t,total:r,data:btoa(String.fromCharCode(...u))};return btoa(JSON.stringify(l))}),this.currentThreshold=t,this.encryptedShares=[],this.copiedShares.clear(),this.displayShares(),this.showSuccess(M0.SHARES_GENERATED),!0}catch(i){return this.showError(ss.GENERATE_FAILED(i.message)),!1}}displayShares(){const e=F(j.SHARES_RESULT),r=F(j.SHARES_LIST),t=F(j.THRESHOLD_DISPLAY);!e||!r||!t||(t.textContent=this.currentThreshold,Dn(r),this.currentShares.forEach((i,s)=>{const a=this.createShareItem(i,s+1);r.appendChild(a)}),Ye(e,!0))}createShareItem(e,r){const t=ie("div",["share-item"]),i=ie("div",["share-header"]),s=ie("div",["share-title"]);s.textContent=V("share",r);const a=ie("div",["share-buttons"]),o=ie("button",["copy-btn"]);this.copiedShares.has(r)?(o.textContent=V("success.copySuccess"),me(o,We.COPIED,!0)):o.textContent=V("copy"),te(o,"click",()=>this.copyShare(o,e,r));const c=ie("button",["download-btn"]);c.textContent=V("download"),te(c,"click",()=>this.downloadShare(e,r)),a.appendChild(o),a.appendChild(c),i.appendChild(s),i.appendChild(a);const u=ie("div",["share-content"]);return u.textContent=e,t.appendChild(i),t.appendChild(u),t}async copyShare(e,r,t){await F0(r)?(this.copiedShares.add(t),e.textContent=V("success.copySuccess"),me(e,We.COPIED,!0)):this.showError(V("errors.copyFailed"))}async downloadShare(e,r){try{const t=this.validateEncryptionSettings();if(this.isEncryptionEnabled&&!t.isValid){this.showError(t.error);return}this.isEncryptionEnabled&&t.isValid?await this.downloadEncryptedShare(e,r):this.downloadStandardShare(e,r)}catch(t){this.showError(V("errors.downloadFailed")+": "+t.message)}}async downloadEncryptedShare(e,r){try{this.showInfo(V("encryption.encryptingShare",r));const t=await Nh(e,this.encryptionPassword);this.clearEncryptionPassword();const i=`${V("shareFilePrefix")}${r}.txt.gpg`;Qa(t,i)?this.showSuccess(V("success.encryptedShareDownloaded",r)):this.showError(V("errors.downloadFailed"))}catch(t){throw this.clearEncryptionPassword(),new Error(V("encryption.encryptionFailed")+": "+t.message)}}downloadStandardShare(e,r){const i=`${V("shareFilePrefix")}${r}.txt`,s=G0.SHARE_CONTENT(r,e),a=this.formatShareFileContent(s);Qa(a,i)?this.showSuccess(V("success.shareDownloaded",r)):this.showError(V("errors.downloadFailed"))}formatShareFileContent(e){let r=`${V("fileTemplate.appName")} ${V("share",e.index)}
${"=".repeat(50)}

`;return r+=`${V("fileTemplate.shareContent")}:
${e.content}

${"=".repeat(50)}
${V("fileTemplate.generatedTime")}: ${e.timestamp}

${V("fileTemplate.securityTips")}:
- ${V("fileTemplate.tip1")}
- ${V("fileTemplate.tip2")}
- ${V("fileTemplate.tip3")}`,r}validateShareInput(){const e=F(j.RECOVER_INPUT),r=F(j.INPUT_STATUS),t=F(j.RECOVER_BTN);if(!e||!r||!t)return;const i=e.value.trim();if(!i){this.updateStatus("waiting",V("waitingForInput")),t.disabled=!0;return}const s=i.split(`
`).map(o=>o.trim()).filter(o=>o.length>0);if(s.length===0){this.updateStatus("waiting",V("waitingForInput")),t.disabled=!0;return}const a=Os(s);a.isValid?(this.updateStatus("valid",V("info.validShares",a.validCount,a.threshold)),t.disabled=!1):(a.validCount===0?this.updateStatus("invalid",V("errors.invalidShareFormat")):a.errors&&a.errors.some(o=>o.includes("检测到重复的分片索引"))?this.updateStatus("invalid",V("errors.duplicateShares")):this.updateStatus("insufficient",V("errors.insufficientShares",a.threshold,a.validCount)),t.disabled=!0)}async recoverMnemonic(){const e=F(j.RECOVER_INPUT),r=F(j.RECOVER_RESULT),t=F(j.RECOVER_BTN);if(!e||!r||!t)return!1;const i=e.value.trim();if(!i)return this.showError(ss.EMPTY_WORDS),!1;t.disabled=!0,t.textContent=V("info.recovering");try{const s=i.split(`
`).map(f=>f.trim()).filter(f=>f.length>0);let a=!1;const o=[];for(const f of s)try{const p=JSON.parse(atob(f));p.threshold&&p.index&&p.data&&o.push(p)}catch{a=!0}if(o.length===0&&a){let f="",p=!1;try{f=await this.getPasswordFromDialog(p)}catch{throw new Error(V("encryption.passwordRequired"))}this.showInfo(V("encryption.decryptingShares"));for(const y of s)try{const w=await Un(y,f),g=JSON.parse(atob(w));g.threshold&&g.index&&g.data&&o.push(g)}catch(w){if(w.message.includes("密码错误")){p=!0;try{f=await this.getPasswordFromDialog(p);const g=await Un(y,f),m=JSON.parse(atob(g));m.threshold&&m.index&&m.data&&o.push(m)}catch(g){if(g.message.includes("密码错误"))throw new Error(V("encryption.invalidPassword"))}}}if(o.length===0)throw new Error(V("encryption.decryptionFailed")+V("errors.noValidShares"))}if(o.length===0)throw new Error(V("errors.noValidShares"));const c=o[0].threshold;if(o.length<c)throw new Error(V("errors.insufficientShares",c,o.length));const u=o.slice(0,c).map(f=>{const p=atob(f.data),y=new Uint8Array(p.length);for(let w=0;w<p.length;w++)y[w]=p.charCodeAt(w);return y}),h=await as(u),l=new TextDecoder().decode(h);return this.displayRecoverResult(l,o.length,c),!0}catch(s){return this.displayRecoverError(s.message),!1}finally{t.disabled=!1,t.textContent=V("recoverBtn"),this.clearUploadEncryptionPassword()}}async recoverMnemonicWithShares(e,r){const t=F(j.RECOVER_RESULT),i=F(j.RECOVER_BTN);if(!t||!i)return!1;if(!e||e.length===0)return this.showError(ss.EMPTY_WORDS),!1;i.disabled=!0,i.textContent=V("info.recovering");try{let s=!1;const a=[];for(const l of e){if(l.encrypted){s=!0,a.push(l);continue}try{if(typeof l=="string"){if(l.startsWith("-----BEGIN PGP MESSAGE-----")){s=!0,a.push({encrypted:!0,content:l});continue}const f=JSON.parse(atob(l));f.threshold&&f.index&&f.data&&a.push(f)}else l.threshold&&l.index&&l.data&&a.push(l)}catch{s=!0,a.push({encrypted:!0,content:l})}}if(s){let l="",f=!1;try{l=await this.getPasswordFromDialog(f)}catch{throw new Error(V("encryption.passwordRequired"))}this.showInfo(V("encryption.decryptingShares"));const p=a.filter(U=>U.encrypted),y=[];let w=!1;for(const U of p)try{const T=await Un(U.content,l),D=JSON.parse(atob(T));D.threshold&&D.index&&D.data&&(y.push(D),w=!0)}catch(T){if(T.message.includes("密码错误")){f=!0;try{l=await this.getPasswordFromDialog(f);const D=await Un(U.content,l),I=JSON.parse(atob(D));I.threshold&&I.index&&I.data&&(y.push(I),w=!0)}catch(D){if(D.message.includes("密码错误"))throw new Error(V("encryption.invalidPassword"))}}}const g=a.filter(U=>!U.encrypted).concat(y);if(g.length===0)throw new Error(V("encryption.decryptionFailed")+V("errors.noValidShares"));const m=g[0].threshold;if(g.length<m)throw new Error(V("errors.insufficientShares",m,g.length));const S=g.slice(0,m).map(U=>{const T=atob(U.data),D=new Uint8Array(T.length);for(let I=0;I<T.length;I++)D[I]=T.charCodeAt(I);return D}),E=await as(S),v=new TextDecoder().decode(E);return this.displayRecoverResult(v,g.length,m),!0}if(a.length===0)throw new Error(V("errors.noValidShares"));const o=a[0].threshold;if(a.length<o)throw new Error(V("errors.insufficientShares",o,a.length));const c=a.slice(0,o).map(l=>{const f=atob(l.data),p=new Uint8Array(f.length);for(let y=0;y<f.length;y++)p[y]=f.charCodeAt(y);return p}),u=await as(c),h=new TextDecoder().decode(u);return this.displayRecoverResult(h,a.length,o),!0}catch(s){return this.displayRecoverError(s.message),!1}finally{i.disabled=!1,i.textContent=V("recoverBtn"),this.clearUploadEncryptionPassword()}}displayRecoverResult(e,r,t){const i=F(".tab-btn.active");let s;if(i&&i.id==="pasteTabBtn"?s=F(j.PASTE_RECOVER_RESULT):i&&i.id==="uploadTabBtn"?s=F(j.UPLOAD_RECOVER_RESULT):s=F(j.RECOVER_RESULT),!s)return;const a=e.split(" ").map(c=>`<span class="word">${c}</span>`).join(" "),o=`
      <div class="alert alert-success">
        <strong>${V("success.recoverySuccess")}</strong><br>
        <strong>${V("mnemonic")}：</strong><br>
        <span class="recovered-mnemonic">${a}</span><br>
        <strong>${V("sharesUsed")}：</strong>${r} ${V("shares")}（${V("need")} ${t} ${V("shares")}）<br>
        <strong>${V("recoveryTime")}：</strong>${Q0()}
      </div>
    `;Kn(s,o)}displayRecoverError(e){const r=F(".tab-btn.active");let t;if(r&&r.id==="pasteTabBtn"?t=F(j.PASTE_RECOVER_RESULT):r&&r.id==="uploadTabBtn"?t=F(j.UPLOAD_RECOVER_RESULT):t=F(j.RECOVER_RESULT),!t)return;t.innerHTML="";const i=document.createElement("div");i.className="alert alert-error";const s=document.createElement("strong");s.textContent=V("errors.recoveryFailed"),i.appendChild(s);const a=document.createElement("span");a.textContent=e,i.appendChild(a),i.appendChild(document.createElement("br"));const o=document.createElement("small");o.textContent=V("errors.checkShareFormat"),i.appendChild(o),t.appendChild(i)}updateStatus(e,r){const t=F(j.INPUT_STATUS);t&&(t.className="input-status",me(t,`input-${e}`,!0),t.innerHTML=`<span class="status-text">${r}</span>`)}showSuccess(e){this.showAlert("success",e)}showError(e){this.showAlert("error",e)}showInfo(e){this.showAlert("info",e)}showAlert(e,r){this.hideAllAlerts();let t;switch(e){case"success":t=F(j.SUCCESS_ALERT);break;case"error":t=F(j.GENERAL_ERROR_ALERT);break;case"info":t=document.createElement("div"),t.className="alert alert-info",t.style.display="none";const i=F(".main-content");i&&i.appendChild(t);break;default:t=F(j.GENERAL_ERROR_ALERT);break}t&&(Kn(t,r),Ye(t,!0),setTimeout(()=>{Ye(t,!1),e==="info"&&t.parentNode&&t.parentNode.removeChild(t)},3e3))}hideAllAlerts(){[j.INPUT_ERROR_ALERT,j.DUPLICATE_ALERT,j.GENERAL_ERROR_ALERT,j.SUCCESS_ALERT].forEach(r=>{const t=F(r);t&&Ye(t,!1)})}async getPasswordFromDialog(e=!1){return await U0.show(e)}destroy(){this.currentShares=[],this.currentThreshold=0,this.copiedShares.clear()}}class Fh{constructor(){this.activeTab="paste",this.uploadedFiles=[],this.parsedShares=[],this.isEncryptionEnabled=!1,this.encryptionPassword="",this.currentThreshold=0,this.validShareCount=0,this.pendingFiles=[],this.hasEncryptedFiles=!1,this.uploadPassword="",this.passwordVisible=!1,this.init()}init(){this.setupTabSwitching(),this.setupFileUpload(),this.setupDragAndDrop(),this.setupEncryptionPassword()}setupTabSwitching(){const e=F("#pasteTabBtn"),r=F("#uploadTabBtn"),t=F("#pasteTab"),i=F("#uploadTab");!e||!r||!t||!i||(te(e,"click",()=>this.switchTab("paste")),te(r,"click",()=>this.switchTab("upload")))}switchTab(e){if(this.activeTab===e)return;const r=F("#pasteTabBtn"),t=F("#uploadTabBtn"),i=F("#pasteTab"),s=F("#uploadTab");if(me(r,"active",e==="paste"),me(t,"active",e==="upload"),me(i,"active",e==="paste"),me(s,"active",e==="upload"),this.activeTab==="paste"){const a=F("#pasteRecoverResult");a&&Kn(a,"")}else if(this.activeTab==="upload"){const a=F("#uploadRecoverResult");a&&Kn(a,"")}this.activeTab=e,this.validateCurrentTab()}setupFileUpload(){const e=F("#selectFilesBtn"),r=F("#fileInput"),t=F("#clearFilesBtn");!e||!r||(te(e,"click",()=>{r.click()}),te(r,"change",i=>{this.handleFileSelect(i.target.files)}),t&&te(t,"click",()=>{this.clearAllFiles()}))}setupDragAndDrop(){const e=F("#uploadArea");e&&(["dragenter","dragover","dragleave","drop"].forEach(r=>{te(e,r,t=>{t.preventDefault(),t.stopPropagation()})}),["dragenter","dragover"].forEach(r=>{te(e,r,()=>{me(e,"drag-over",!0)})}),te(e,"dragleave",()=>{me(e,"drag-over",!1)}),te(e,"drop",r=>{me(e,"drag-over",!1),this.handleFileSelect(r.dataTransfer.files)}))}async handleFileSelect(e){if(!e||e.length===0)return;const r=this.validateFiles(e);r.length!==0&&(this.hasEncryptedFiles=r.some(t=>t.name.endsWith(".gpg")),await this.processFiles(r),this.hasEncryptedFiles&&this.togglePasswordSection(!0,!0))}async processFiles(e){for(const r of e)await this.processFile(r);this.updateFilesList(),this.validateCurrentShares()}validateFiles(e){const r=[];for(const i of e){const s=[".txt",".gpg"],a="."+i.name.split(".").pop().toLowerCase();if(!s.includes(a)){this.showError(V("errors.fileTypeNotSupported",i.name));continue}if(i.size>5242880){this.showError(V("errors.fileTooLarge",i.name));continue}if(this.uploadedFiles.some(o=>o.name===i.name)){this.showError(V("errors.duplicateFile",i.name));continue}r.push(i)}return r}async processFile(e){try{const r={name:e.name,size:e.size,type:e.type,content:"",status:"processing",shareData:null,isEncrypted:e.name.endsWith(".gpg"),decryptedContent:null,contentFormat:"text"};this.uploadedFiles.push(r);const t=await this.readFileContent(e);if(r.content=t,r.isEncrypted)r.contentFormat=t instanceof ArrayBuffer?"binary":"text",r.status="encrypted";else{if(typeof t!="string"){r.status="invalid";return}r.contentFormat="text";const i=this.parseShareContent(t);i&&!i.encrypted?(r.shareData=i,r.status="valid"):r.status="invalid"}}catch{const t=this.uploadedFiles.findIndex(i=>i.name===e.name);t!==-1&&(this.uploadedFiles[t].status="invalid")}}async getPasswordFromDialog(e=!1){return await U0.show(e)}async retryDecryption(e,r){let t=!1;for(const i of e){try{const s=await Un(i.content,r);i.decryptedContent=s;const a=this.parseShareContent(s);a&&!a.encrypted?(i.shareData=a,i.status="valid",t=!0):i.status="invalid"}catch(s){i.status="invalid",s.message.includes("密码错误")||(s.message.includes("格式无效")?console.warn(`文件 ${i.name} 格式无效:`,s.message):console.warn(`文件 ${i.name} 解密失败:`,s.message))}this.updateFilesList(),this.validateCurrentShares()}t||this.showError(V("encryption.invalidPassword")||"密码错误或文件格式无效")}validateCurrentShares(){const e=F("#uploadStatus"),r=F("#recoverBtn");if(!e||!r)return;const t=this.uploadedFiles.filter(a=>a.status==="valid"&&a.shareData).map(a=>a.shareData),i=this.uploadedFiles.filter(a=>a.status==="encrypted");if(t.length===0&&i.length===0){this.updateStatus("invalid",V("errors.noValidShares"),e),r.disabled=!0;return}if(t.length===0&&i.length>0){this.updateStatus("waiting",V("encryption.passwordRequired"),e),r.disabled=!1;return}const s=Os(t);s.isValid?(this.updateStatus("valid",V("sharesDecrypted",s.validCount,s.threshold),e),r.disabled=!1,this.currentThreshold=s.threshold,this.validShareCount=s.validCount):(s.validCount<s.threshold?this.updateStatus("insufficient",V("insufficientSharesAfterDecryption",s.threshold,s.validCount),e):this.updateStatus("invalid",V("errors.invalidShareFormat"),e),r.disabled=!0)}async readFileContent(e){return e.name.endsWith(".gpg")?this.readGpgFile(e):new Promise((r,t)=>{const i=new FileReader;i.onload=s=>r(s.target.result),i.onerror=()=>t(new Error("Failed to read file")),i.readAsText(e)})}async readGpgFile(e){try{const r=await this.readAsArrayBuffer(e),t=Oh(r);if(t.type==="binary-packet"||t.type==="binary")return r;if(t.type==="ascii-armor")try{return new TextDecoder("utf-8",{fatal:!1}).decode(r)}catch{return r}const i=await this.readAsText(e),s=i.trim();return s.startsWith("-----BEGIN PGP MESSAGE-----")?i:s.length<200||/[\x00-\x08\x0E-\x1F\x7F]/.test(s)?r:i}catch(r){return console.warn("二进制读取失败，回退到文本模式:",r),this.readAsText(e)}}readAsArrayBuffer(e){return new Promise((r,t)=>{const i=new FileReader;i.onload=s=>r(s.target.result),i.onerror=()=>t(new Error("Failed to read file as binary")),i.readAsArrayBuffer(e)})}readAsText(e){return new Promise((r,t)=>{const i=new FileReader;i.onload=s=>r(s.target.result),i.onerror=()=>t(new Error("Failed to read file as text")),i.readAsText(e,"utf-8")})}parseShareContent(e){try{try{const t=e.trim();if(t.startsWith("-----BEGIN PGP MESSAGE-----"))return{encrypted:!0,content:t};const i=JSON.parse(atob(t));if(i.threshold&&i.index!==void 0&&i.data)return i}catch{}const r=e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0);for(const t of r)try{if(t.startsWith("-----BEGIN PGP MESSAGE-----"))return{encrypted:!0,content:t};const i=JSON.parse(atob(t));if(i.threshold&&i.index!==void 0&&i.data)return i}catch{}return{encrypted:!0,content:e.trim()}}catch{return{encrypted:!0,content:e.trim()}}}updateFilesList(){const e=F("#uploadedFiles"),r=F("#filesList");if(!(!e||!r)){if(this.uploadedFiles.length===0){Ye(e,!1);return}Ye(e,!0),Dn(r),this.uploadedFiles.forEach((t,i)=>{const s=this.createFileItem(t,i);r.appendChild(s)})}}createFileItem(e,r){const t=ie("div",["file-item"]),i=ie("div",["file-info"]),s=ie("div",["file-icon"]);s.textContent=e.name.endsWith(".gpg")?"🔒":"📄";const a=ie("div",["file-details"]),o=ie("div",["file-name"]);o.textContent=e.name;const c=ie("div",["file-status",e.status]);c.textContent=this.getFileStatusText(e.status),a.appendChild(o),a.appendChild(c),i.appendChild(s),i.appendChild(a);const u=ie("button",["file-remove"]);return u.textContent="×",te(u,"click",()=>this.removeFile(r)),t.appendChild(i),t.appendChild(u),t}getFileStatusText(e){const r=V("fileStatus");if(typeof r=="object")return r[e]||r.unknown;switch(e){case"processing":return"Processing...";case"valid":return"Valid share";case"invalid":return"Invalid format";case"encrypted":return"Encrypted - awaiting decryption";default:return"Unknown status"}}removeFile(e){this.uploadedFiles.splice(e,1),this.updateFilesList(),this.validateCurrentTab()}clearAllFiles(){this.uploadedFiles=[],this.hasEncryptedFiles=!1,this.uploadPassword="",this.updateFilesList(),this.validateCurrentTab(),this.togglePasswordSection(!1)}validateCurrentTab(){this.activeTab==="paste"?this.validatePasteInput():this.validateFileUpload()}validatePasteInput(){const e=F("#recoverInput"),r=F("#inputStatus"),t=F("#recoverBtn");if(!e||!r||!t)return;const i=e.value.trim();if(!i){this.updateStatus("waiting",V("waitingForInput"),r),t.disabled=!0;return}const s=i.split(`
`).map(o=>o.trim()).filter(o=>o.length>0);if(s.length===0){this.updateStatus("waiting",V("waitingForInput"),r),t.disabled=!0;return}const a=Os(s);this.processValidationResult(a,r,t)}validateFileUpload(){const e=F("#uploadStatus"),r=F("#recoverBtn");if(!(!e||!r)){if(this.uploadedFiles.length===0){this.updateStatus("waiting",V("waitingForUpload"),e),r.disabled=!0;return}this.validateCurrentShares()}}processValidationResult(e,r,t){e.isValid?(this.updateStatus("valid",V("info.validShares",e.validCount,e.threshold),r),t.disabled=!1,this.currentThreshold=e.threshold,this.validShareCount=e.validCount):(e.validCount===0?this.updateStatus("invalid",V("errors.invalidShareFormat"),r):e.errors&&e.errors.some(i=>i.includes("检测到重复的分片索引"))?this.updateStatus("invalid",V("errors.duplicateShares"),r):this.updateStatus("insufficient",V("errors.insufficientShares",e.threshold,e.validCount),r),t.disabled=!0)}updateStatus(e,r,t){if(!t)return;t.className=t.className.replace(/\b(input|upload)-\w+\b/g,"");const i=t.id==="inputStatus"?`input-${e}`:`upload-${e}`;me(t,i,!0),t.innerHTML="";const s=document.createElement("span");s.className="status-text",s.textContent=r,t.appendChild(s)}getCurrentShares(){if(this.activeTab==="paste"){const e=F("#recoverInput");if(!e)return[];const r=e.value.trim();return r?r.split(`
`).map(t=>t.trim()).filter(t=>t.length>0):[]}else return this.uploadedFiles.filter(e=>e.status==="valid"&&e.shareData).map(e=>e.shareData)}getEncryptionPassword(){return""}showError(e){const r=ie("div",["alert","alert-error"]);r.style.position="fixed",r.style.top="20px",r.style.right="20px",r.style.zIndex="9999",r.style.maxWidth="400px",r.textContent=e,document.body.appendChild(r),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r)},3e3)}destroy(){this.uploadedFiles=[],this.parsedShares=[],this.isEncryptionEnabled=!1,this.encryptionPassword="",this.currentThreshold=0,this.validShareCount=0,this.pendingFiles=[],this.hasEncryptedFiles=!1}setupEncryptionPassword(){const e=F("#uploadEncryptionPassword"),r=F("#uploadPasswordToggleBtn"),t=F("#applyDecryptionBtn"),i=F("#skipDecryptionBtn");!e||!r||!t||!i||(te(e,"input",()=>{this.uploadPassword=e.value}),te(r,"click",()=>{this.togglePasswordVisibility()}),te(t,"click",()=>{this.applyDecryption()}),te(i,"click",()=>{this.skipDecryption()}),te(e,"keydown",s=>{s.key==="Enter"&&this.applyDecryption()}))}togglePasswordVisibility(){const e=F("#uploadEncryptionPassword"),r=F("#uploadPasswordToggleBtn");!e||!r||(this.passwordVisible=!this.passwordVisible,e.type=this.passwordVisible?"text":"password",r.querySelector(".password-toggle-icon").textContent=this.passwordVisible?"Hide":"Show")}togglePasswordSection(e,r=!1){const t=F("#encryptionPasswordSection"),i=F("#uploadArea");!t||!i||(e&&r?(Ye(t,!0),this.addEncryptedFilesIndicator(),setTimeout(()=>{const s=F("#uploadEncryptionPassword");s&&s.focus()},100)):(Ye(t,!1),this.removeEncryptedFilesIndicator()))}addEncryptedFilesIndicator(){const e=F("#uploadArea");if(!e||e.querySelector(".encrypted-files-indicator"))return;const r=ie("div",["encrypted-files-indicator"]),t=document.createElement("span");t.className="icon",t.textContent="🔒",r.appendChild(t);const i=document.createElement("span");i.textContent=V("encryption.encryptedFileDetected")||"检测到加密文件，需要输入密码进行解密",r.appendChild(i),e.parentNode.insertBefore(r,e)}removeEncryptedFilesIndicator(){const e=document.querySelector(".encrypted-files-indicator");e&&e.parentNode&&e.parentNode.removeChild(e)}async applyDecryption(){if(!this.uploadPassword){this.showError(V("encryption.passwordRequired")||"请输入解密密码");return}const e=this.uploadedFiles.filter(r=>r.status==="encrypted");if(e.length===0){this.showError(V("encryption.noEncryptedFiles")||"没有需要解密的文件");return}await this.retryDecryption(e,this.uploadPassword),this.togglePasswordSection(!1)}skipDecryption(){this.togglePasswordSection(!1),this.validateCurrentShares()}}class D0{constructor(){this.mnemonicInput=new V0(is.DEFAULT_WORD_COUNT),this.shareManager=new Qh,this.recoveryTabManager=new Fh,this.currentWordCount=is.DEFAULT_WORD_COUNT,this.init()}init(){this.setupEventListeners(),this.setupLanguageSwitcher(),this.updateThresholdOptions(),this.setInitialState(),this.shareManager.initEncryptionListeners(),Me.init()}setupEventListeners(){const e=F("#words12"),r=F("#words24");e&&te(e,"click",()=>this.setWordCount(12)),r&&te(r,"click",()=>this.setWordCount(24));const t=F(j.TOTAL_SHARES);t&&te(t,"change",()=>this.updateThresholdOptions());const i=F(j.GENERATE_BTN);i&&te(i,"click",()=>this.handleGenerateShares());const s=F(j.RECOVER_BTN);s&&te(s,"click",a=>{this.handleRecoverMnemonic()}),te(document,"keydown",a=>this.handleKeyboardShortcuts(a))}setupLanguageSwitcher(){document.querySelectorAll(".language-btn").forEach(r=>{const t=r.getAttribute("data-lang");te(r,"click",i=>{i.preventDefault(),(t===je.EN||t===je.ZH)&&this.switchLanguage(t)})}),Me.addListener(r=>{this.updateLanguageUI(r),this.updateDynamicContent()}),this.updateLanguageUI(Me.getCurrentLanguage())}switchLanguage(e){Me.setLanguage(e)}updateLanguageUI(e){document.querySelectorAll(".language-btn").forEach(t=>{t.getAttribute("data-lang")===e?t.classList.add("active"):t.classList.remove("active")})}updateDynamicContent(){this.updateThresholdOptions(),this.updateTotalSharesOptions(),this.updatePlaceholders(),this.updateWordInputPlaceholders()}updateTotalSharesOptions(){const e=F(j.TOTAL_SHARES);if(!e)return;const r=e.value,t=[{value:"3"},{value:"4"},{value:"5"},{value:"6"},{value:"7"}];e.innerHTML="",t.forEach(i=>{const s=document.createElement("option");s.value=i.value,s.textContent=Me.t("sharesOption",parseInt(i.value)),i.value===r&&(s.selected=!0),e.appendChild(s)})}updatePlaceholders(){const e=F(j.RECOVER_INPUT);if(e){const r=e.getAttribute("data-i18n-placeholder");r&&(e.placeholder=Me.t(r))}}updateWordInputPlaceholders(){for(let e=1;e<=this.currentWordCount;e++){const r=F(j.WORD_INPUT(e));r&&(r.placeholder="")}}setInitialState(){this.updateWordCountButtons(),this.mnemonicInput.renderInputs(),this.shareManager.hideAllAlerts()}setWordCount(e){is.WORD_COUNTS.includes(e)&&(this.currentWordCount=e,this.mnemonicInput.setWordCount(e),this.updateWordCountButtons(),this.shareManager.hideAllAlerts())}updateWordCountButtons(){const e=F("#words12"),r=F("#words24");e&&me(e,We.ACTIVE,this.currentWordCount===12),r&&me(r,We.ACTIVE,this.currentWordCount===24)}updateThresholdOptions(){const e=F(j.TOTAL_SHARES),r=F(j.THRESHOLD);if(!e||!r)return;const t=parseInt(e.value),i=parseInt(r.value);r.innerHTML="";for(let s=2;s<=t;s++){const a=document.createElement("option");a.value=s,a.textContent=Me.t("sharesOption",s),s===Math.min(i,t)&&(a.selected=!0),r.appendChild(a)}}async handleGenerateShares(){const e=this.mnemonicInput.validateAllInputs();if(!e.isValid){e.hasEmpty?this.shareManager.showError(Me.t("errors.fillAllWords")):e.hasInvalidWord&&(this.shareManager.showError(Me.t("errors.invalidWord",e.invalidWordIndex)),this.focusInvalidInput(e.invalidWordIndex));return}const r=parseInt(F(j.TOTAL_SHARES).value),t=parseInt(F(j.THRESHOLD).value);await this.shareManager.generateShares(e.words,r,t)&&this.scrollToResult()}async handleRecoverMnemonic(){try{const e=this.recoveryTabManager.getCurrentShares(),r=this.recoveryTabManager.getEncryptionPassword();if(e.length===0){this.shareManager.showError(Me.t("errors.noValidShares"));return}const t=F(j.RECOVER_BTN);t&&(t.disabled=!0,t.textContent=Me.t("info.recovering")),await this.shareManager.recoverMnemonicWithShares(e,r)&&this.scrollToResult()}catch(e){this.shareManager.showError(Me.t("errors.recoveryFailed")+e.message)}finally{const e=F(j.RECOVER_BTN);e&&(e.disabled=!1,e.textContent=Me.t("recoverBtn"))}}focusInvalidInput(e){const r=F(j.WORD_INPUT(e));r&&(me(r,We.INVALID_WORD,!0),r.focus())}scrollToResult(){const e=F(j.SHARES_RESULT)||F(j.RECOVER_RESULT);e&&e.scrollIntoView({behavior:"smooth",block:"center"})}handleKeyboardShortcuts(e){if((e.ctrlKey||e.metaKey)&&e.key==="Enter"){e.preventDefault(),F(".recover-section");const r=F(j.RECOVER_INPUT),t=r&&document.activeElement===r;t&&!F(j.RECOVER_BTN).disabled?this.handleRecoverMnemonic():t||this.handleGenerateShares()}e.key==="Escape"&&this.shareManager.hideAllAlerts()}getAppInfo(){return{name:ns.NAME,description:ns.DESCRIPTION,version:ns.VERSION,currentWordCount:this.currentWordCount}}destroy(){this.mnemonicInput.destroy(),this.shareManager.destroy(),this.recoveryTabManager&&this.recoveryTabManager.destroy()}}let Ke;function Mh(){try{Ke=new D0}catch{}}function Gh(){window.setWordCount=n=>{Ke&&Ke.setWordCount(n)},window.generateShares=()=>{Ke&&Ke.handleGenerateShares()},window.copyShare=(n,e)=>{Ke&&Ke.shareManager.copyShare(n,e)},window.downloadShare=(n,e)=>{Ke&&Ke.shareManager.downloadShare(n,e)},window.recoverMnemonic=()=>{Ke&&Ke.handleRecoverMnemonic()},window.validateShares=()=>{Ke&&Ke.recoveryTabManager&&Ke.recoveryTabManager.validateCurrentTab()}}document.addEventListener("DOMContentLoaded",()=>{Mh(),Gh()});window.addEventListener("beforeunload",()=>{Ke&&Ke.destroy()});typeof window<"u"&&(window.MnemonicSplitApp=D0,window.app=Ke);</script>
    <style rel="stylesheet" crossorigin>:root{--color-primary: #4f46e5;--color-primary-hover: #4338ca;--color-success: #10b981;--color-success-hover: #059669;--color-warning: #f59e0b;--color-error: #ef4444;--color-text: #1f2937;--color-text-secondary: #6b7280;--color-text-tertiary: #9ca3af;--color-border: #e5e7eb;--color-border-light: #f3f4f6;--color-surface: #ffffff;--color-surface-secondary: #f9fafb;--color-surface-tertiary: #f3f4f6;--space-xs: 4px;--space-sm: 8px;--space-md: 16px;--space-lg: 24px;--space-xl: 32px;--space-2xl: 48px;--space-3xl: 64px;--radius-sm: 6px;--radius-md: 8px;--radius-lg: 12px;--radius-xl: 16px;--font-size-xs: 12px;--font-size-sm: 14px;--font-size-base: 16px;--font-size-lg: 18px;--font-size-xl: 20px;--font-size-2xl: 24px;--font-size-3xl: 28px;--shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, .05);--shadow-md: 0 4px 6px -1px rgba(0, 0, 0, .1), 0 2px 4px -1px rgba(0, 0, 0, .06);--shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, .1), 0 4px 6px -2px rgba(0, 0, 0, .05);--transition-fast: .15s ease;--transition-base: .2s ease;--transition-slow: .3s ease}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;background:var(--color-surface-secondary);min-height:100vh;padding:var(--space-lg);-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:var(--color-text);line-height:1.5;font-size:var(--font-size-base)}.container{max-width:1024px;margin:0 auto;background:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--radius-xl);box-shadow:var(--shadow-lg);overflow:hidden;min-height:calc(100vh - 32px)}.header{background:var(--color-surface);border-bottom:1px solid var(--color-border);padding:var(--space-2xl) var(--space-xl);text-align:center;position:relative}.header h1{font-size:var(--font-size-3xl);margin-bottom:var(--space-sm);font-weight:600;line-height:1.2;color:var(--color-text)}.header p{font-size:var(--font-size-base);line-height:1.6;color:var(--color-text-secondary);max-width:600px;margin:0 auto}.language-switcher{position:absolute;top:var(--space-xl);right:var(--space-xl);display:flex;align-items:center;gap:var(--space-sm);background:var(--color-surface-secondary);border:1px solid var(--color-border);border-radius:var(--radius-lg);padding:var(--space-xs);box-shadow:var(--shadow-sm)}.language-switcher-label{font-size:var(--font-size-xs);color:var(--color-text-secondary);font-weight:500;margin-right:var(--space-xs)}.language-toggle{display:flex;background:var(--color-surface);border-radius:var(--radius-md);overflow:hidden;border:1px solid var(--color-border)}.language-btn{padding:var(--space-xs) var(--space-sm);border:none;background:transparent;color:var(--color-text-secondary);cursor:pointer;transition:all var(--transition-base);font-weight:500;font-size:var(--font-size-xs);min-width:40px;text-align:center;position:relative}.language-btn.active{background:var(--color-primary);color:#fff;box-shadow:var(--shadow-sm)}.language-btn:hover:not(.active){background:var(--color-surface-secondary);color:var(--color-text)}.main-content{padding:var(--space-2xl) var(--space-xl)}.section:last-child{margin-bottom:0}.section-title{font-size:var(--font-size-xl);color:var(--color-text);margin-bottom:var(--space-lg);display:flex;align-items:center;gap:var(--space-sm);font-weight:600}.controls{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:var(--space-lg);margin-bottom:var(--space-lg)}.control-group{display:flex;flex-direction:column;gap:var(--space-sm)}.control-group label{font-weight:500;color:var(--color-text-secondary);font-size:var(--font-size-sm)}.btn-group{display:flex;border-radius:var(--radius-md);overflow:hidden;border:1px solid var(--color-border);width:100%;background:var(--color-surface-secondary)}.btn-group button{padding:var(--space-md) var(--space-xl) var(--space-md) var(--space-md);border:none;background:transparent;color:var(--color-text-secondary);cursor:pointer;transition:all var(--transition-base);font-weight:500;flex:1;text-align:center;font-size:var(--font-size-sm);position:relative}.btn-group[id=wordCountButtons] button{font-size:var(--font-size-base);padding:var(--space-md) var(--space-xl) var(--space-md) var(--space-md);line-height:1.5;height:50px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;min-height:50px}.btn-group button.active{background:var(--color-surface);color:var(--color-primary);box-shadow:var(--shadow-sm);z-index:1}.btn-group button:hover:not(.active){background:var(--color-surface);color:var(--color-text)}select{padding:var(--space-md) var(--space-xl) var(--space-md) var(--space-md);border:1px solid var(--color-border);border-radius:var(--radius-md);font-size:var(--font-size-base);background:var(--color-surface);cursor:pointer;-webkit-appearance:none;-webkit-tap-highlight-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%236b7280' d='M6 9L1 4h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right var(--space-md) center;transition:all var(--transition-base);color:var(--color-text);font-weight:500;width:100%}select:focus{outline:none;border-color:var(--color-primary);box-shadow:0 0 0 3px #4f46e51a}select:hover{border-color:var(--color-border)}.words-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:var(--space-lg);margin-bottom:var(--space-xl)}.word-input,.input-wrapper{position:relative}.word-input input{width:100%;padding:var(--space-lg) var(--space-md) var(--space-md) var(--space-md);border:1px solid var(--color-border);border-radius:var(--radius-md);background:var(--color-surface);font-size:var(--font-size-base);transition:all var(--transition-base);-webkit-appearance:none;-webkit-tap-highlight-color:transparent;color:var(--color-text);font-weight:500}.word-input input:focus{outline:none;border-color:var(--color-primary)}.word-input input:not(:placeholder-shown){border-color:var(--color-border)}.word-input input.valid-word{border-color:var(--color-success);box-shadow:0 0 0 3px #10b9811a}.word-input input.invalid-word{border-color:var(--color-error);box-shadow:0 0 0 3px #ef44441a;animation:shake .3s ease-in-out}.word-input input.duplicate-word{border-color:var(--color-warning);box-shadow:0 0 0 3px #f59e0b1a}@keyframes shake{0%,to{transform:translate(0)}25%{transform:translate(-5px)}75%{transform:translate(5px)}}.word-input label{position:absolute;left:var(--space-md);top:var(--space-lg);transform:translateY(-50%);color:var(--color-text-tertiary);font-size:var(--font-size-base);pointer-events:none;transition:all var(--transition-base);background:var(--color-surface);padding:0 var(--space-xs);font-weight:500}.word-input input:focus+label,.word-input input:not(:placeholder-shown)+label{top:0;font-size:var(--font-size-xs);color:var(--color-primary);font-weight:600}.autocomplete-suggestions{position:absolute;top:100%;left:0;right:0;background:transparent;z-index:9999;display:none;padding:8px 0 0;margin-top:2px}.suggestions-container{display:flex;gap:6px;justify-content:flex-start;align-items:center;flex-wrap:nowrap}.suggestion-item{padding:6px 12px;cursor:pointer;transition:all .2s;font-size:.85rem;white-space:nowrap;flex-shrink:0;color:#fff;font-weight:500;border-radius:6px;background:#6fa8dc}.suggestion-item:hover{transform:translateY(-1px);box-shadow:0 2px 8px #0003}.action-btn{background:var(--color-primary);color:#fff;border:none;padding:var(--space-md) var(--space-xl);border-radius:var(--radius-md);font-size:var(--font-size-base);font-weight:500;cursor:pointer;transition:all var(--transition-base);-webkit-appearance:none;-webkit-tap-highlight-color:transparent;touch-action:manipulation}.action-btn:hover:not(:disabled){background:var(--color-primary-hover)}.action-btn:active:not(:disabled){transform:translateY(1px)}.action-btn:disabled{background:var(--color-text-tertiary);cursor:not-allowed;opacity:.6}.result-section{margin-top:var(--space-xl)}.share-item{background:var(--color-surface);border-radius:var(--radius-md);padding:var(--space-lg);margin-bottom:var(--space-md);border:1px solid var(--color-border);position:relative;transition:all var(--transition-base)}.share-item:hover{border-color:var(--color-primary)}.share-item:last-child{margin-bottom:0}.share-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-md);gap:var(--space-md)}.share-title{font-weight:600;color:var(--color-text);font-size:var(--font-size-base)}.copy-btn,.download-btn{border:1px solid;padding:var(--space-sm) var(--space-md);border-radius:var(--radius-md);font-size:var(--font-size-sm);cursor:pointer;transition:all var(--transition-base);font-weight:500;display:inline-flex;align-items:center;justify-content:center;min-width:60px;background:var(--color-surface)}.copy-btn{color:var(--color-success);border-color:var(--color-success)}.copy-btn:hover{background:var(--color-success);color:#fff}.copy-btn.copied{color:var(--color-text-secondary);border-color:var(--color-text-secondary)}.copy-btn.copied:hover{background:var(--color-text-secondary);color:#fff}.download-btn{color:var(--color-primary);border-color:var(--color-primary)}.download-btn:hover{background:var(--color-primary);color:#fff}.share-buttons{display:flex;gap:var(--space-sm);align-items:center}.share-content{font-family:SF Mono,Monaco,Inconsolata,Roboto Mono,Courier New,monospace;font-size:var(--font-size-sm);color:var(--color-text-secondary);word-break:break-all;line-height:1.5;background:var(--color-surface-secondary);padding:var(--space-md);border-radius:var(--radius-md);border:1px solid var(--color-border)}.recover-section{border-top:2px solid var(--color-border);padding-top:var(--space-xl);margin-top:var(--space-xl)}.recover-section .action-btn{margin-top:var(--space-lg)}.recovery-tabs{display:flex;margin-bottom:var(--space-lg);border-bottom:1px solid var(--color-border)}.tab-btn{padding:var(--space-md) var(--space-xl);border:none;background:transparent;color:var(--color-text-secondary);cursor:pointer;transition:all var(--transition-base);font-weight:500;font-size:var(--font-size-base);position:relative;flex:1;text-align:center;border-bottom:2px solid transparent}.tab-btn.active{color:var(--color-primary);border-bottom-color:var(--color-primary)}.tab-btn:hover:not(.active){color:var(--color-text)}.tab-pane{display:none}.tab-pane.active{display:block;animation:fadeIn var(--transition-base) ease-in-out}@keyframes fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.upload-area{border:2px dashed var(--color-border);border-radius:var(--radius-md);padding:var(--space-3xl);text-align:center;background:var(--color-surface-secondary);transition:all var(--transition-base);cursor:pointer;margin-bottom:var(--space-lg)}.upload-area:hover{border-color:var(--color-primary);background:#4f46e50d}.upload-area.drag-over{border-color:var(--color-primary);background:#4f46e51a;transform:scale(1.02)}.upload-content{display:flex;flex-direction:column;align-items:center;gap:var(--space-md)}.upload-icon{font-size:3rem;margin-bottom:var(--space-md)}.upload-text p{margin:0;color:var(--color-text);font-weight:500}.upload-hint{font-size:var(--font-size-sm);color:var(--color-text-secondary)!important;font-weight:400!important}.upload-btn{background:var(--color-primary);color:#fff;border:none;padding:var(--space-md) var(--space-xl);border-radius:var(--radius-md);font-size:var(--font-size-base);font-weight:500;cursor:pointer;transition:all var(--transition-base)}.upload-btn:hover{background:var(--color-primary-hover)}.upload-btn:active{transform:translateY(1px)}.uploaded-files{margin-bottom:var(--space-lg)}.files-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-md)}.files-header h4{margin:0;font-size:var(--font-size-lg);color:var(--color-text);font-weight:600}.clear-files-btn{background:var(--color-error);color:#fff;border:none;padding:var(--space-sm) var(--space-md);border-radius:var(--radius-md);font-size:var(--font-size-sm);font-weight:500;cursor:pointer;transition:all var(--transition-base)}.clear-files-btn:hover{background:#dc2626}.files-list{display:flex;flex-direction:column;gap:var(--space-sm)}.file-item{display:flex;align-items:center;justify-content:space-between;padding:var(--space-md);background:var(--color-surface);border-radius:var(--radius-md);border:1px solid var(--color-border);transition:all var(--transition-base)}.file-item:hover{border-color:var(--color-primary)}.file-info{display:flex;align-items:center;gap:var(--space-md);flex:1}.file-icon{font-size:1.5rem}.file-details{flex:1}.file-name{font-weight:500;color:var(--color-text);margin-bottom:2px}.file-status{font-size:var(--font-size-xs);color:var(--color-text-secondary)}.file-status.valid{color:var(--color-success)}.file-status.invalid{color:var(--color-error)}.file-status.processing{color:var(--color-warning)}.file-remove{background:transparent;border:none;color:var(--color-error);cursor:pointer;padding:var(--space-sm);border-radius:var(--radius-sm);transition:all var(--transition-base);font-size:var(--font-size-lg);line-height:1}.file-remove:hover{background:#ef44441a}.upload-status{margin-bottom:var(--space-lg);padding:var(--space-md);border-radius:var(--radius-lg);font-size:var(--font-size-sm);font-weight:500;border:1px solid;background:transparent;color:var(--color-text-tertiary);border:none;padding:var(--space-sm) 0;font-style:italic;font-weight:400}.upload-status.valid{background:#10b9811a;color:var(--color-success);border-color:var(--color-success)}.upload-status.invalid{background:#ef44441a;color:var(--color-error);border-color:var(--color-error)}.upload-status.insufficient{background:#f59e0b1a;color:var(--color-warning);border-color:var(--color-warning)}.recovery-encryption-section{margin-bottom:var(--space-lg)}.encryption-password-section{margin-bottom:var(--space-lg);animation:fadeIn var(--transition-base) ease-in-out}.encryption-password-header{margin-bottom:var(--space-lg)}.encryption-password-header h4{font-size:var(--font-size-lg);color:var(--color-text);margin-bottom:var(--space-sm);font-weight:600}.encryption-password-desc{font-size:var(--font-size-sm);color:var(--color-text-secondary);line-height:1.5;margin:0}.encryption-password-input-group{margin-bottom:var(--space-xl)}.password-input-wrapper{position:relative;display:flex;align-items:center}.password-toggle-btn{position:absolute;right:var(--space-md);background:transparent;border:none;cursor:pointer;padding:var(--space-sm);border-radius:var(--radius-sm);transition:all var(--transition-base);display:flex;align-items:center;justify-content:center;font-size:var(--font-size-sm);font-weight:500;color:var(--color-text-secondary);-webkit-user-select:none;user-select:none}.password-toggle-btn:hover{background:var(--color-surface-tertiary)}.password-toggle-btn:active{transform:scale(.95)}.encryption-password-actions{display:flex;gap:var(--space-md);justify-content:flex-end}.encryption-password-actions .btn{padding:var(--space-md) var(--space-xl);border-radius:var(--radius-lg);font-size:var(--font-size-base);font-weight:500;cursor:pointer;transition:all var(--transition-base);border:none;min-width:120px}.encryption-password-actions .btn-primary{background:var(--color-primary);color:#fff}.encryption-password-actions .btn-primary:hover{background:var(--color-primary-hover)}.encryption-password-actions .btn-secondary{background:var(--color-surface-secondary);color:var(--color-text);border:1px solid var(--color-border)}.encryption-password-actions .btn-secondary:hover{background:var(--color-surface-tertiary)}.encrypted-files-indicator{display:flex;align-items:center;gap:var(--space-sm);padding:var(--space-md);background:#f59e0b1a;border:1px solid var(--color-warning);border-radius:var(--radius-md);margin-bottom:var(--space-lg);font-size:var(--font-size-sm);color:var(--color-warning);font-weight:500}.encrypted-files-indicator .icon{font-size:var(--font-size-base)}.recover-input{width:100%;min-height:180px;max-height:300px;padding:var(--space-lg);border:1px solid var(--color-border);border-radius:var(--radius-md);font-family:SF Mono,Monaco,Inconsolata,Roboto Mono,Courier New,monospace;font-size:var(--font-size-sm);line-height:1.6;resize:vertical;margin-bottom:var(--space-md);background:var(--color-surface);transition:all var(--transition-base);word-wrap:break-word;white-space:pre-wrap;overflow-wrap:break-word;color:var(--color-text);font-weight:500}#recoverBtn{margin-bottom:var(--space-xl)}.recover-input:focus{outline:none;border-color:var(--color-primary);background:var(--color-surface);box-shadow:0 0 0 3px #4f46e51a}.recover-input::placeholder{color:var(--color-text-tertiary);opacity:.8;white-space:pre-line;font-weight:400}.input-status{margin-bottom:var(--space-lg);padding:var(--space-md);border-radius:var(--radius-lg);font-size:var(--font-size-sm);font-weight:500;border:1px solid}.input-status.waiting{background:transparent;color:var(--color-text-tertiary);border:none;padding:var(--space-sm) 0;font-style:italic;font-weight:400}.input-status.valid{background:#10b9811a;color:var(--color-success);border-color:var(--color-success)}.input-status.invalid{background:#ef44441a;color:var(--color-error);border-color:var(--color-error)}.input-status.insufficient{background:#f59e0b1a;color:var(--color-warning);border-color:var(--color-warning)}.alert{padding:var(--space-lg);border-radius:var(--radius-md);margin-bottom:var(--space-lg);border:1px solid;font-weight:500;font-size:var(--font-size-sm)}.alert-success{background:#10b9811a;color:var(--color-success);border-color:var(--color-success)}.alert-error{background:#ef44441a;color:var(--color-error);border-color:var(--color-error)}.alert-info{background:#4f46e51a;color:var(--color-primary);border-color:var(--color-primary)}.alert-warning{background:#f59e0b1a;color:var(--color-warning);border-color:var(--color-warning)}.security-notice{background:#10b9811a;color:var(--color-success);border-color:var(--color-success);margin-bottom:var(--space-lg);border:1px solid;border-radius:var(--radius-lg);padding:var(--space-lg);font-weight:500;font-size:var(--font-size-sm)}.encryption-section{margin-bottom:var(--space-lg)}.section-subtitle{font-size:var(--font-size-lg);color:var(--color-text);margin-bottom:var(--space-md);font-weight:600}.encryption-controls{display:flex;flex-direction:column;gap:var(--space-lg)}.checkbox-container{display:flex;align-items:center;cursor:pointer;font-weight:500;color:var(--color-text);-webkit-user-select:none;user-select:none;position:relative;padding-left:var(--space-xl)}.checkbox-container input{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.checkmark{position:absolute;left:0;top:0;height:var(--space-lg);width:var(--space-lg);background-color:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--radius-sm);transition:all var(--transition-base)}.checkbox-container:hover input~.checkmark{background-color:var(--color-surface-secondary);border-color:var(--color-primary)}.checkbox-container input:checked~.checkmark{background-color:var(--color-primary);border-color:var(--color-primary)}.checkmark:after{content:"";position:absolute;display:none;left:6px;top:2px;width:5px;height:10px;border:solid white;border-width:0 2px 2px 0;transform:rotate(45deg)}.checkbox-container input:checked~.checkmark:after{display:block}.encryption-fields{display:flex;flex-direction:column;gap:var(--space-lg);margin-top:var(--space-lg)}.password-input{width:100%;padding:var(--space-md) var(--space-lg);border:1px solid var(--color-border);border-radius:var(--radius-md);font-size:var(--font-size-base);background:var(--color-surface);transition:all var(--transition-base);color:var(--color-text);font-weight:500}.password-input::placeholder{color:var(--color-text-tertiary);opacity:.7;font-weight:400}.password-input:focus{outline:none;border-color:var(--color-primary)}.password-match.valid,.password-strength.valid{color:var(--color-success);font-size:var(--font-size-sm);font-weight:600;display:flex;align-items:center;gap:var(--space-xs)}.password-match.valid:before,.password-strength.valid:before{content:"✓";display:inline-block;width:16px;height:16px;background:var(--color-success);color:#fff;border-radius:50%;font-size:10px;line-height:16px;text-align:center;font-weight:700}.password-match.invalid,.password-strength.invalid{color:var(--color-error);font-size:var(--font-size-sm);font-weight:600;display:flex;align-items:center;gap:var(--space-xs)}.password-match.invalid:before,.password-strength.invalid:before{content:"✕";display:inline-block;width:16px;height:16px;background:var(--color-error);color:#fff;border-radius:50%;font-size:10px;line-height:16px;text-align:center;font-weight:700}.password-match.weak,.password-strength.weak{color:var(--color-error);font-size:var(--font-size-sm);font-weight:500}.password-match.medium,.password-strength.medium{color:var(--color-warning);font-size:var(--font-size-sm);font-weight:500}.password-match.strong,.password-strength.strong{color:var(--color-success);font-size:var(--font-size-sm);font-weight:600}.recovered-mnemonic{font-family:SF Mono,Monaco,Inconsolata,Roboto Mono,Courier New,monospace;font-size:var(--font-size-base);font-weight:600;background:#f8f9fa;color:var(--color-text);padding:var(--space-md);border-radius:var(--radius-md);border:1px solid var(--color-border);display:inline-block;margin:var(--space-sm) 0;line-height:1.8}.recovered-mnemonic .word{font-weight:700;background:#4f46e514;padding:2px 6px;border-radius:4px;margin:0 2px}.recover-result-section{margin-top:var(--space-lg);animation:fadeIn var(--transition-normal) ease-in-out}.recover-result-section .alert{margin-bottom:0}.share-preview{font-family:Courier New,monospace;font-size:.8rem;color:#666;margin-top:5px;padding:5px;background:#f8f9fa;border-radius:4px;max-height:60px;overflow-y:auto}@media (max-width: 768px){body{padding:var(--space-md)}.container{border-radius:var(--radius-lg);min-height:calc(100vh - 32px)}.header{padding:var(--space-xl) var(--space-lg);padding-top:var(--space-2xl)}.language-switcher{position:static;margin-bottom:var(--space-lg);justify-content:center}.header h1{font-size:var(--font-size-2xl)}.main-content{padding:var(--space-xl) var(--space-lg)}.section{margin-bottom:var(--space-xl)}.section-title{font-size:var(--font-size-lg);margin-bottom:var(--space-lg)}.words-grid,.controls{grid-template-columns:1fr;gap:var(--space-lg)}.control-group{width:100%}.action-btn{padding:var(--space-md) var(--space-lg);font-size:var(--font-size-base)}.share-item{padding:var(--space-lg);margin-bottom:var(--space-md)}.result-section{padding:var(--space-lg);margin-top:var(--space-xl)}.recover-section{padding-top:var(--space-xl);margin-top:var(--space-xl)}.autocomplete-suggestions{z-index:99999!important;position:fixed!important;inset:auto 10px 20px!important;width:calc(100% - 20px)!important;background:#000000f2!important;padding:12px!important;box-shadow:0 4px 20px #0006!important;border-radius:12px!important;backdrop-filter:blur(10px)!important;-webkit-backdrop-filter:blur(10px)!important}.suggestions-container{display:flex!important;flex-wrap:wrap!important;gap:8px!important;justify-content:center!important;max-height:150px!important;overflow-y:auto!important;-webkit-overflow-scrolling:touch!important}.suggestion-item{font-size:14px!important;padding:8px 14px!important;background:#6fa8dc!important;color:#fff!important;border-radius:20px!important;cursor:pointer!important;transition:all .2s!important;font-weight:500!important;border:1px solid rgba(255,255,255,.2)!important;user-select:none!important;-webkit-user-select:none!important}.suggestion-item:active,.suggestion-item:hover{background:#4a86c8!important;transform:scale(.95)!important}.word-input input{font-size:16px}body{min-height:100vh;position:relative}.container{max-height:100vh;overflow-y:auto;-webkit-overflow-scrolling:touch}.copy-btn,.download-btn{padding:var(--space-sm) var(--space-md)!important;font-size:var(--font-size-sm)!important}.share-buttons{flex-direction:column!important;gap:var(--space-sm)!important}*{touch-action:manipulation}.recovery-tabs{flex-direction:column;border-radius:var(--radius-lg);border-bottom:none;border:1px solid var(--color-border)}.tab-btn{border-bottom:1px solid var(--color-border);border-radius:0;flex:none}.tab-btn:last-child{border-bottom:none}.tab-btn.active{border-bottom:1px solid var(--color-border);background:var(--color-surface)}.tab-content{border-radius:var(--radius-lg);border:1px solid var(--color-border);padding:var(--space-lg)}.upload-area{padding:var(--space-2xl)}.upload-icon{font-size:2.5rem}.files-header{flex-direction:column;align-items:flex-start;gap:var(--space-sm)}.clear-files-btn{align-self:flex-end}.file-item{flex-direction:column;align-items:flex-start;gap:var(--space-sm)}.file-info{width:100%}.file-remove{align-self:flex-end}}.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:10000;opacity:0;visibility:hidden;transition:all var(--transition-base)}.modal.active{opacity:1;visibility:visible}.modal-content{background:var(--color-surface);border-radius:var(--radius-xl);padding:var(--space-2xl);max-width:500px;width:90%;box-shadow:var(--shadow-lg);transform:scale(.9);transition:transform var(--transition-base)}.modal.active .modal-content{transform:scale(1)}.modal-title{font-size:var(--font-size-xl);color:var(--color-text);margin-bottom:var(--space-lg);font-weight:600;text-align:center}.modal-message{font-size:var(--font-size-base);color:var(--color-text-secondary);margin-bottom:var(--space-xl);text-align:center;line-height:1.5}.modal-buttons{display:flex;gap:var(--space-md);justify-content:center}.btn{padding:var(--space-md) var(--space-xl);border-radius:var(--radius-lg);font-size:var(--font-size-base);font-weight:500;cursor:pointer;transition:all var(--transition-base);border:none;min-width:120px}.btn-primary{background:var(--color-primary);color:#fff}.btn-primary:hover{background:var(--color-primary-hover)}.btn-secondary{background:var(--color-surface-secondary);color:var(--color-text);border:1px solid var(--color-border)}.btn-secondary:hover{background:var(--color-surface-tertiary)}.file-status.encrypted{color:var(--color-warning)}.password-dialog-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:10000;opacity:0;visibility:hidden;transition:all var(--transition-base)}.password-dialog-overlay.active{opacity:1;visibility:visible}.password-dialog{background:var(--color-surface);border-radius:var(--radius-xl);padding:var(--space-2xl);max-width:450px;width:90%;box-shadow:var(--shadow-lg);transform:scale(.9);transition:transform var(--transition-base)}.password-dialog-overlay.active .password-dialog{transform:scale(1)}.password-dialog-title{font-size:var(--font-size-xl);color:var(--color-text);margin-bottom:var(--space-md);font-weight:600;text-align:center}.password-dialog-message{font-size:var(--font-size-base);color:var(--color-text-secondary);margin-bottom:var(--space-xl);text-align:center;line-height:1.5}.password-input-group{margin-bottom:var(--space-xl)}.password-label{display:block;font-weight:500;color:var(--color-text-secondary);font-size:var(--font-size-sm);margin-bottom:var(--space-sm)}.password-dialog-buttons{display:flex;gap:var(--space-md);justify-content:center}.encryption-options{display:flex;gap:var(--space-md);justify-content:center;margin-bottom:var(--space-xl)}.encryption-option{padding:var(--space-md) var(--space-xl);border-radius:var(--radius-lg);font-size:var(--font-size-base);font-weight:500;cursor:pointer;transition:all var(--transition-base);border:none;min-width:140px}.encryption-option:hover{transform:translateY(-2px);box-shadow:var(--shadow-md)}.password-dialog .password-input{width:100%;padding:var(--space-md) var(--space-xl) var(--space-md) var(--space-md);border:1px solid var(--color-border);border-radius:var(--radius-lg);font-size:var(--font-size-base);background:var(--color-surface);transition:all var(--transition-base);color:var(--color-text);font-weight:500;margin-bottom:var(--space-sm)}.password-dialog .password-input:focus{outline:none;border-color:var(--color-primary);box-shadow:0 0 0 3px #4f46e51a}.password-dialog .password-input.error{border-color:var(--color-error);box-shadow:0 0 0 3px #ef44441a;animation:shake .3s ease-in-out}@media (max-width: 768px){.password-dialog{max-width:90%;padding:var(--space-xl)}.password-dialog-title{font-size:var(--font-size-lg)}.password-dialog-message{font-size:var(--font-size-sm)}.password-dialog-buttons{flex-direction:column}.password-dialog-buttons .btn{width:100%}.encryption-password-section{padding:var(--space-lg)}.encryption-password-actions{flex-direction:column}.encryption-password-actions .btn{width:100%}.encrypted-files-indicator{flex-direction:column;align-items:flex-start;gap:var(--space-xs)}}</style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <!-- Language Switcher -->
        <div class="language-switcher">
          <span class="language-switcher-label" data-i18n="language">Language</span>
          <div class="language-toggle">
            <button class="language-btn active" data-lang="en">EN</button>
            <button class="language-btn" data-lang="zh">中文</button>
          </div>
        </div>

        <h1>MnemonicShards</h1>
        <p data-i18n="appDescription">Securely split your mnemonic phrase into multiple shards. Any specified number of shards can recover the original mnemonic.</p>
      </div>

      <div class="main-content">
        <!-- 安全提示 -->
        <div class="alert security-notice" data-i18n="securityNotice">
          <strong>Security Mode:</strong> Using professional-grade Shamir Secret Sharing algorithm, runs completely offline, data never leaves your device. Recommended to use in disconnected
          environment for maximum security.
        </div>

        <!-- 配置区域 -->
        <div class="section">
          <div class="section-title" data-i18n="configTitle">Configuration Options</div>

          <div class="controls">
            <div class="control-group">
              <label data-i18n="wordCountLabel">Mnemonic Word Count</label>
              <div class="btn-group" id="wordCountButtons">
                <button id="words12" class="active" onclick="setWordCount(12)" data-i18n="words12">12 words</button>
                <button id="words24" onclick="setWordCount(24)" data-i18n="words24">24 words</button>
              </div>
            </div>

            <div class="control-group">
              <label data-i18n="totalSharesLabel">Total Shares</label>
              <select id="totalShares">
                <option value="3">3 shares</option>
                <option value="4">4 shares</option>
                <option value="5" selected>5 shares</option>
                <option value="6">6 shares</option>
                <option value="7">7 shares</option>
              </select>
            </div>

            <div class="control-group">
              <label data-i18n="thresholdLabel">Shares Required for Recovery</label>
              <select id="threshold">
                <option value="2">2 shares</option>
                <option value="3" selected>3 shares</option>
                <option value="4">4 shares</option>
                <option value="5">5 shares</option>
              </select>
            </div>
          </div>
        </div>

        <!-- 助记词输入区域 -->
        <div class="section">
          <div class="section-title" data-i18n="inputTitle">Enter Mnemonic Phrase</div>

          <div id="inputErrorAlert" style="display: none" class="alert alert-error">
            <!-- BIP39 单词验证错误提示将在这里显示 -->
          </div>

          <div id="duplicateAlert" style="display: none" class="alert alert-warning">
            <!-- 重复单词提示将在这里显示 -->
          </div>

          <div id="generalErrorAlert" style="display: none" class="alert alert-error">
            <!-- 一般错误提示将在这里显示 -->
          </div>

          <div id="successAlert" style="display: none" class="alert alert-success">
            <!-- 成功提示将在这里显示 -->
          </div>

          <div class="words-grid" id="wordsGrid">
            <!-- 动态生成输入框 -->
          </div>

          <button class="action-btn" onclick="generateShares()" id="generateBtn" data-i18n="generateBtn">Generate Shares</button>
        </div>

        <!-- 分片结果区域 -->
        <div id="sharesResult" style="display: none">
          <div class="section-title" data-i18n="sharesTitle">Generated Shares</div>

          <!-- 加密选项区域 -->
          <div class="encryption-section" id="encryptionSection">
            <div class="section-subtitle" data-i18n="encryption.title">Encryption Options</div>
            <div class="alert alert-info" data-i18n="encryption.encryptionDescription">
              Add an extra layer of security by encrypting each shard with OpenPGP format, compatible with GPG tools
            </div>

            <div class="encryption-controls">
              <div class="control-group">
                <label class="checkbox-container">
                  <input type="checkbox" id="enableEncryption" />
                  <span class="checkmark"></span>
                  <span data-i18n="encryption.enableEncryption">Enable Encryption</span>
                </label>
              </div>

              <div id="encryptionFields" class="encryption-fields" style="display: none">
                <div class="control-group">
                  <label for="encryptionPassword" data-i18n="encryption.passwordLabel">Password</label>
                  <input type="password" id="encryptionPassword" class="password-input" data-i18n-placeholder="encryption.passwordPlaceholder" placeholder="Enter encryption password" />
                  <div class="password-strength" id="passwordStrength"></div>
                </div>

                <div class="control-group">
                  <label for="confirmPassword" data-i18n="encryption.confirmPasswordLabel">Confirm Password</label>
                  <input
                    type="password"
                    id="confirmPassword"
                    class="password-input"
                    data-i18n-placeholder="encryption.confirmPasswordPlaceholder"
                    placeholder="Confirm encryption password"
                  />
                  <div class="password-match" id="passwordMatch"></div>
                </div>

                <div class="alert alert-warning" data-i18n="encryption.passwordTip">
                  <strong>Important:</strong> Make sure to remember your password, as it will be required to recover the mnemonic
                </div>
              </div>
            </div>
          </div>

          <div class="alert alert-info" data-i18n="securityTip">
            <strong>Security Tip:</strong> Store these shards in different secure locations. Any <span id="thresholdDisplay"></span> shares can recover the complete mnemonic.
          </div>
          <div id="sharesList"></div>
        </div>

        <!-- 恢复区域 -->
        <div class="section recover-section">
          <div class="section-title" data-i18n="recoverTitle">Recover Mnemonic Phrase</div>

          <!-- Tab切换按钮 -->
          <div class="recovery-tabs">
            <button class="tab-btn active" id="pasteTabBtn" data-tab="paste" data-i18n="pasteInputTab">Paste Input</button>
            <button class="tab-btn" id="uploadTabBtn" data-tab="upload" data-i18n="fileUploadTab">File Upload</button>
          </div>

          <!-- Tab内容区域 -->
          <div class="tab-content">
            <!-- 粘贴输入Tab -->
            <div class="tab-pane active" id="pasteTab">
              <div class="alert alert-info" data-i18n="recoverInstructions">
                <strong>Instructions:</strong><br />
                1. Paste each shard into the text box below, one shard per line<br />
                2. Shard format should be complete Base64 encoded string<br />
                3. Minimum number of shards must be reached for recovery<br />
                4. Extra shards will be automatically ignored
              </div>

              <div class="input-status" id="inputStatus">
                <span class="status-text" data-i18n="waitingForInput">Waiting for shard input...</span>
              </div>

              <textarea
                class="recover-input"
                id="recoverInput"
                rows="8"
                wrap="soft"
                data-i18n-placeholder="recoverPlaceholder"
                placeholder="Paste shard contents here, one shard per line...

💡 Tip: Paste multiple shards at once, system will handle line breaks automatically

Example format:
eyJ0aHJlc2hvbGQiOjMsInNoYXJlSW5kZXgiOjEsImRhdGEiOiJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiJ9
eyJ0aHJlc2hvbGQiOjMsInNoYXJlSW5kZXgiOjIsImRhdGEiOiJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiJ9
eyJ0aHJlc2hvbGQiOjMsInNoYXJlSW5kZXgiOjMsImRhdGEiOiJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiJ9"
                oninput="validateShares()"
                onpaste="setTimeout(validateShares, 100)"
                spellcheck="false"
                autocomplete="off"
                autocorrect="off"
                autocapitalize="off"
              ></textarea>

              <!-- 粘贴输入恢复结果区域 -->
              <div id="pasteRecoverResult" class="recover-result-section"></div>
            </div>

            <!-- 文件上传Tab -->
            <div class="tab-pane" id="uploadTab">
              <div class="alert alert-info" data-i18n="uploadInstructions">
                <strong>Instructions:</strong><br />
                1. Drag and drop shard files here or click to select files<br />
                2. Supported formats: .txt (standard shares) and .gpg (encrypted shares)<br />
                3. You can select multiple files at once<br />
                4. Files will be processed immediately after upload
              </div>

              <!-- 拖拽上传区域 -->
              <div class="upload-area" id="uploadArea">
                <div class="upload-content">
                  <div class="upload-icon">📁</div>
                  <div class="upload-text">
                    <p data-i18n="dragDropHint">Drag and drop files here or click to select</p>
                    <p class="upload-hint" data-i18n="supportedFormats">Supported formats: .txt, .gpg</p>
                  </div>
                  <button class="upload-btn" id="selectFilesBtn" data-i18n="selectFiles">Select Files</button>
                  <input type="file" id="fileInput" multiple accept=".txt,.gpg" style="display: none" />
                </div>
              </div>

              <!-- 加密文件密码输入区域 -->
              <div class="encryption-password-section" id="encryptionPasswordSection" style="display: none">
                <div class="encryption-password-header">
                  <h4 data-i18n="encryptionPasswordTitle">Decryption Password</h4>
                  <p class="encryption-password-desc" data-i18n="encryptionPasswordDesc">
                    Enter the password to decrypt your encrypted files (.gpg). All encrypted files will use the same password.
                  </p>
                </div>

                <div class="encryption-password-input-group">
                  <label for="uploadEncryptionPassword" data-i18n="encryption.passwordLabel">Password</label>
                  <div class="password-input-wrapper">
                    <input
                      type="password"
                      id="uploadEncryptionPassword"
                      class="password-input"
                      data-i18n-placeholder="encryption.passwordPlaceholder"
                      placeholder="Enter decryption password"
                      autocomplete="new-password"
                    />
                    <button type="button" class="password-toggle-btn" id="uploadPasswordToggleBtn" title="Toggle password visibility">
                      <span class="password-toggle-icon">Show</span>
                    </button>
                  </div>
                </div>

                <div class="encryption-password-actions">
                  <button class="btn btn-secondary" id="skipDecryptionBtn" data-i18n="skipDecryption">Skip Decryption</button>
                  <button class="btn btn-primary" id="applyDecryptionBtn" data-i18n="applyDecryption">Apply Decryption</button>
                </div>
              </div>

              <!-- 已上传文件列表 -->
              <div class="uploaded-files" id="uploadedFiles" style="display: none">
                <div class="files-header">
                  <h4 data-i18n="uploadedFiles">Uploaded Files</h4>
                  <button class="clear-files-btn" id="clearFilesBtn" data-i18n="clearAllFiles">Clear All</button>
                </div>
                <div class="files-list" id="filesList"></div>
              </div>

              <!-- 上传状态 -->
              <div class="upload-status" id="uploadStatus">
                <span class="status-text" data-i18n="waitingForUpload">Waiting for file upload...</span>
              </div>

              <!-- 文件上传恢复结果区域 -->
              <div id="uploadRecoverResult" class="recover-result-section"></div>
            </div>
          </div>

          <button class="action-btn" id="recoverBtn" disabled data-i18n="recoverBtn">Recover Mnemonic</button>

          <div id="recoverResult"></div>
        </div>
      </div>
    </div>

  </body>
</html>
